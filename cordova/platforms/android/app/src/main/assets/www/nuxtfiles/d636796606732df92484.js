/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{976:function(t,e,n){"use strict";(function(t){var e=n(978),r=n(336),o=n(390),c=n(346),h=n(977),f=n(348),b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},l=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(e.b)(n,t),n}(Error),d=new o.b("@firebase/firestore");function v(){return d.logLevel}function y(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(d.logLevel<=o.a.DEBUG){var i=n.map(I);d.debug.apply(d,Object(e.d)(["Firestore (8.0.1): "+t],i))}}function m(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(d.logLevel<=o.a.ERROR){var i=n.map(I);d.error.apply(d,Object(e.d)(["Firestore (8.0.1): "+t],i))}}function w(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(d.logLevel<=o.a.WARN){var i=n.map(I);d.warn.apply(d,Object(e.d)(["Firestore (8.0.1): "+t],i))}}function I(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function E(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.0.1) INTERNAL ASSERTION FAILED: "+t;throw m(e),new Error(e)}function O(t,e){t||E()}function T(t,e){return t}function _(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var A=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=_(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function N(t,e){return t<e?-1:t>e?1:0}function D(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function j(t){return t+"\0"}var S=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.i,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.u=function(t){return N(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();S.h=new S("");var x=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(S.fromBase64String(e))}catch(e){throw new l(b.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(S.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}();function q(){if("undefined"==typeof Uint8Array)throw new l(b.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function k(){if("undefined"==typeof atob)throw new l(b.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var P=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Object(e.b)(n,t),n.fromBase64String=function(t){k();try{return new n(S.fromBase64String(t))}catch(t){throw new l(b.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},n.fromUint8Array=function(t){return q(),new n(S.fromUint8Array(t))},n.prototype.toBase64=function(){return k(),t.prototype.toBase64.call(this)},n.prototype.toUint8Array=function(){return q(),t.prototype.toUint8Array.call(this)},n.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},n}(x),L=function(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.T=o},R=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.u=function(t){return N(this.projectId,t.projectId)||N(this.database,t.database)},t}();function C(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function V(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function U(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var M=function(){function t(t,e){this.m=t,this.A=e,this.R={}}return t.prototype.get=function(t){var e=this.m(t),n=this.R[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],u=o[0],s=o[1];if(this.A(u,t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.m(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.m(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){V(this.R,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],u=o[0],s=o[1];t(u,s)}}))},t.prototype.P=function(){return U(this.R)},t}(),F=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new l(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new l(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new l(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new l(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.g=function(t){return this.seconds===t.seconds?N(this.nanoseconds,t.nanoseconds):N(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),B=function(){function t(t){this.timestamp=t}return t.V=function(e){return new t(e)},t.min=function(){return new t(new F(0,0))},t.prototype.u=function(t){return this.timestamp.g(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.p=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.v=function(){return this.timestamp},t}(),G=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&E(),void 0===n?n=t.length-e:n>t.length-e&&E(),this.segments=t,this.offset=e,this.S=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.S},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.D(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.C(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.N=function(t){return t=void 0===t?1:t,this.C(this.segments,this.offset+t,this.length-t)},t.prototype.F=function(){return this.C(this.segments,this.offset,this.length-1)},t.prototype.O=function(){return this.segments[this.offset]},t.prototype.k=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.P=function(){return 0===this.length},t.prototype.M=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.$=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},t.D=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),z=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Object(e.b)(n,t),n.prototype.C=function(t,e,r){return new n(t,e,r)},n.prototype.B=function(){return this.L().join("/")},n.prototype.toString=function(){return this.B()},n.q=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=[],i=0,o=t;i<o.length;i++){var u=o[i];if(u.indexOf("//")>=0)throw new l(b.INVALID_ARGUMENT,"Invalid segment ("+u+"). Paths must not contain // in them.");r.push.apply(r,u.split("/").filter((function(t){return t.length>0})))}return new n(r)},n.U=function(){return new n([])},n}(G),K=/^[_a-zA-Z][_a-zA-Z0-9]*$/,W=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Object(e.b)(n,t),n.prototype.C=function(t,e,r){return new n(t,e,r)},n.K=function(t){return K.test(t)},n.prototype.B=function(){return this.L().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),n.K(t)||(t="`"+t+"`"),t})).join(".")},n.prototype.toString=function(){return this.B()},n.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},n.j=function(){return new n(["__name__"])},n.G=function(t){for(var e=[],r="",i=0,o=function(){if(0===r.length)throw new l(b.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(r),r=""},u=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new l(b.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new l(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===s?(u=!u,i++):"."!==s||u?(r+=s,i++):(o(),i++)}if(o(),u)throw new l(b.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new n(e)},n.U=function(){return new n([])},n}(G),H=function(){function t(t){this.path=t}return t.H=function(e){return new t(z.q(e))},t.Y=function(e){return new t(z.q(e).N(5))},t.prototype.J=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===z.D(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.D=function(t,e){return z.D(t.path,e.path)},t.X=function(t){return t.length%2==0},t.Z=function(e){return new t(new z(e.slice()))},t}();function Q(t){return null==t}function Y(t){return 0===t&&1/t==-1/0}function X(t){return"number"==typeof t&&Number.isInteger(t)&&!Y(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var rt=function(t,e,n,r,i,o,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=u,this.tt=null};function J(t,e,n,r,i,o,u){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===u&&(u=null),new rt(t,e,n,r,i,o,u)}function $(t){var e=T(t);if(null===e.tt){var n=e.path.B();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.B()+t.op.toString()+Gt(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.B()+e.dir;var e})).join(","),Q(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Kn(e.startAt)),e.endAt&&(n+="|ub:",n+=Kn(e.endAt)),e.tt=n}return e.tt}function Z(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Xn(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!qt(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Hn(t.startAt,e.startAt)&&Hn(t.endAt,e.endAt)}function tt(t){return H.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}var et,nt,it=function(){function t(t,e,n,r,i,o,u){void 0===i&&(i=B.min()),void 0===o&&(o=B.min()),void 0===u&&(u=S.h),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u}return t.prototype.st=function(e){return new t(this.target,this.targetId,this.et,e,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.it=function(e,n){return new t(this.target,this.targetId,this.et,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.rt=function(e){return new t(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,e,this.resumeToken)},t}(),ot=function(t){this.count=t};function st(t){switch(t){case b.OK:return E();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0;default:return E()}}function ut(t){if(void 0===t)return m("GRPC error has no .code"),b.UNKNOWN;switch(t){case et.OK:return b.OK;case et.CANCELLED:return b.CANCELLED;case et.UNKNOWN:return b.UNKNOWN;case et.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case et.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case et.INTERNAL:return b.INTERNAL;case et.UNAVAILABLE:return b.UNAVAILABLE;case et.UNAUTHENTICATED:return b.UNAUTHENTICATED;case et.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case et.NOT_FOUND:return b.NOT_FOUND;case et.ALREADY_EXISTS:return b.ALREADY_EXISTS;case et.PERMISSION_DENIED:return b.PERMISSION_DENIED;case et.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case et.ABORTED:return b.ABORTED;case et.OUT_OF_RANGE:return b.OUT_OF_RANGE;case et.UNIMPLEMENTED:return b.UNIMPLEMENTED;case et.DATA_LOSS:return b.DATA_LOSS;default:return E()}}(nt=et||(et={}))[nt.OK=0]="OK",nt[nt.CANCELLED=1]="CANCELLED",nt[nt.UNKNOWN=2]="UNKNOWN",nt[nt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",nt[nt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",nt[nt.NOT_FOUND=5]="NOT_FOUND",nt[nt.ALREADY_EXISTS=6]="ALREADY_EXISTS",nt[nt.PERMISSION_DENIED=7]="PERMISSION_DENIED",nt[nt.UNAUTHENTICATED=16]="UNAUTHENTICATED",nt[nt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",nt[nt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",nt[nt.ABORTED=10]="ABORTED",nt[nt.OUT_OF_RANGE=11]="OUT_OF_RANGE",nt[nt.UNIMPLEMENTED=12]="UNIMPLEMENTED",nt[nt.INTERNAL=13]="INTERNAL",nt[nt.UNAVAILABLE=14]="UNAVAILABLE",nt[nt.DATA_LOSS=15]="DATA_LOSS";var dt=function(){function t(t,e){this.D=t,this.root=e||ct.EMPTY}return t.prototype.ot=function(e,n){return new t(this.D,this.root.ot(e,n,this.D).copy(null,null,ct.at,null,null))},t.prototype.remove=function(e){return new t(this.D,this.root.remove(e,this.D).copy(null,null,ct.at,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.D(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.D(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.P=function(){return this.root.P()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.ct=function(){return this.root.ct()},t.prototype.ut=function(){return this.root.ut()},t.prototype.ht=function(t){return this.root.ht(t)},t.prototype.forEach=function(t){this.ht((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.ht((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.lt=function(t){return this.root.lt(t)},t.prototype._t=function(){return new at(this.root,null,this.D,!1)},t.prototype.ft=function(t){return new at(this.root,t,this.D,!1)},t.prototype.dt=function(){return new at(this.root,null,this.D,!0)},t.prototype.wt=function(t){return new at(this.root,t,this.D,!0)},t}(),at=function(){function t(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}return t.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},t.prototype.At=function(){return this.Tt.length>0},t.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},t}(),ct=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.P=function(){return!1},t.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},t.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},t.prototype.min=function(){return this.left.P()?this:this.left.min()},t.prototype.ct=function(){return this.min().key},t.prototype.ut=function(){return this.right.P()?this.key:this.right.ut()},t.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},t.prototype.gt=function(){if(this.left.P())return t.EMPTY;var e=this;return e.left.yt()||e.left.left.yt()||(e=e.Vt()),(e=e.copy(null,null,null,e.left.gt(),null)).Pt()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.P()||i.left.yt()||i.left.left.yt()||(i=i.Vt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.yt()&&(i=i.bt()),i.right.P()||i.right.yt()||i.right.left.yt()||(i=i.vt()),0===n(e,i.key)){if(i.right.P())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.gt())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Pt()},t.prototype.yt=function(){return this.color},t.prototype.Pt=function(){var t=this;return t.right.yt()&&!t.left.yt()&&(t=t.St()),t.left.yt()&&t.left.left.yt()&&(t=t.bt()),t.left.yt()&&t.right.yt()&&(t=t.Dt()),t},t.prototype.Vt=function(){var t=this.Dt();return t.right.left.yt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},t.prototype.vt=function(){var t=this.Dt();return t.left.left.yt()&&(t=(t=t.bt()).Dt()),t},t.prototype.St=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.bt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},t.prototype.Nt=function(){if(this.yt()&&this.left.yt())throw E();if(this.right.yt())throw E();var t=this.left.Nt();if(t!==this.right.Nt())throw E();return t+(this.yt()?0:1)},t}();ct.EMPTY=null,ct.RED=!0,ct.at=!1,ct.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw E()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw E()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw E()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw E()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw E()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.ot=function(t,e,n){return new ct(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.P=function(){return!0},t.prototype.ht=function(t){return!1},t.prototype.lt=function(t){return!1},t.prototype.ct=function(){return null},t.prototype.ut=function(){return null},t.prototype.yt=function(){return!1},t.prototype.Ct=function(){return!0},t.prototype.Nt=function(){return 0},t}());var ht=function(){function t(t){this.D=t,this.data=new dt(this.D)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.ct()},t.prototype.last=function(){return this.data.ut()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ht((function(e,n){return t(e),!1}))},t.prototype.xt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(this.D(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},t.prototype.Ot=function(t){var e=this.data.ft(t);return e.At()?e.It().key:null},t.prototype._t=function(){return new ft(this.data._t())},t.prototype.ft=function(t){return new ft(this.data.ft(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.P=function(){return this.data.P()},t.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data._t(),r=e.data._t();n.At();){var i=n.It().key,o=r.It().key;if(0!==this.D(i,o))return!1}return!0},t.prototype.L=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.D);return n.data=e,n},t}(),ft=function(){function t(t){this.Mt=t}return t.prototype.It=function(){return this.Mt.It().key},t.prototype.At=function(){return this.Mt.At()},t}(),lt=new dt(H.D);function pt(){return lt}function vt(){return pt()}var yt=new dt(H.D);function gt(){return yt}var mt=new dt(H.D),bt=new ht(H.D);function wt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=bt,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var It=new ht(N);function Et(){return It}var Ot=function(){function t(t){this.D=t?function(e,n){return t(e,n)||H.D(e.key,n.key)}:function(t,e){return H.D(t.key,e.key)},this.$t=gt(),this.Lt=new dt(this.D)}return t.Bt=function(e){return new t(e.D)},t.prototype.has=function(t){return null!=this.$t.get(t)},t.prototype.get=function(t){return this.$t.get(t)},t.prototype.first=function(){return this.Lt.ct()},t.prototype.last=function(){return this.Lt.ut()},t.prototype.P=function(){return this.Lt.P()},t.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.Lt.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Lt.ht((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.ot(t.key,t),e.Lt.ot(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Lt.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Lt._t(),r=e.Lt._t();n.At();){var i=n.It().key,o=r.It().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.D=this.D,r.$t=e,r.Lt=n,r},t}(),Tt=function(){function t(){this.qt=new dt(H.D)}return t.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);n?0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):E():this.qt=this.qt.ot(e,t)},t.prototype.Ut=function(){var t=[];return this.qt.ht((function(e,n){t.push(n)})),t},t}(),_t=function(){function t(t,e,n,r,i,o,u,s){this.query=t,this.docs=e,this.Kt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=u,this.jt=s}return t.Gt=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Ot.Bt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Qt.P()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&xn(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Kt.isEqual(t.Kt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),At=function(){function t(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Yt=r,this.Jt=i}return t.Xt=function(e,n){var r=new Map;return r.set(e,Nt.Zt(e,n)),new t(B.min(),r,Et(),pt(),wt())},t}(),Nt=function(){function t(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}return t.Zt=function(e,n){return new t(S.h,n,wt(),wt(),wt())},t}(),Dt=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},jt=function(t,e){this.targetId=t,this.oe=e},St=function(t,e,n,r){void 0===n&&(n=S.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},xt=function(){function t(){this.ae=0,this.ce=Lt(),this.ue=S.h,this.he=!1,this.le=!0}return Object.defineProperty(t.prototype,"te",{get:function(){return this.he},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),t.prototype.de=function(t){t.o()>0&&(this.le=!0,this.ue=t)},t.prototype.we=function(){var t=wt(),e=wt(),n=wt();return this.ce.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:E()}})),new Nt(this.ue,this.he,t,e,n)},t.prototype.Ee=function(){this.le=!1,this.ce=Lt()},t.prototype.Te=function(t,e){this.le=!0,this.ce=this.ce.ot(t,e)},t.prototype.Ie=function(t){this.le=!0,this.ce=this.ce.remove(t)},t.prototype.me=function(){this.ae+=1},t.prototype.Ae=function(){this.ae-=1},t.prototype.Re=function(){this.le=!0,this.he=!0},t}(),kt=function(){function t(t){this.Pe=t,this.ge=new Map,this.ye=pt(),this.Ve=Pt(),this.pe=new ht(N)}return t.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof vn?this.ve(r,t.re):t.re instanceof yn&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var u=o[i];this.Se(u,t.key,t.re)}},t.prototype.De=function(t){var e=this;this.Ce(t,(function(n){var r=e.Ne(n);switch(t.state){case 0:e.xe(n)&&r.de(t.resumeToken);break;case 1:r.Ae(),r._e||r.Ee(),r.de(t.resumeToken);break;case 2:r.Ae(),r._e||e.removeTarget(n);break;case 3:e.xe(n)&&(r.Re(),r.de(t.resumeToken));break;case 4:e.xe(n)&&(e.Fe(n),r.de(t.resumeToken));break;default:E()}}))},t.prototype.Ce=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ge.forEach((function(t,r){n.xe(r)&&e(r)}))},t.prototype.Oe=function(t){var e=t.targetId,n=t.oe.count,r=this.ke(e);if(r){var i=r.target;if(tt(i))if(0===n){var o=new H(i.path);this.Se(e,o,new yn(o,B.min()))}else O(1===n);else this.Me(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e))}},t.prototype.$e=function(t){var e=this,n=new Map;this.ge.forEach((function(r,i){var o=e.ke(i);if(o){if(r.te&&tt(o.target)){var u=new H(o.target.path);null!==e.ye.get(u)||e.Le(i,u)||e.Se(i,u,new yn(u,t))}r.fe&&(n.set(i,r.we()),r.Ee())}}));var r=wt();this.Ve.forEach((function(t,n){var i=!0;n.Ft((function(t){var n=e.ke(t);return!n||2===n.et||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new At(t,n,this.pe,this.ye,r);return this.ye=pt(),this.Ve=Pt(),this.pe=new ht(N),i},t.prototype.ve=function(t,e){if(this.xe(t)){var n=this.Le(t,e.key)?2:0;this.Ne(t).Te(e.key,n),this.ye=this.ye.ot(e.key,e),this.Ve=this.Ve.ot(e.key,this.Be(e.key).add(t))}},t.prototype.Se=function(t,e,n){if(this.xe(t)){var r=this.Ne(t);this.Le(t,e)?r.Te(e,1):r.Ie(e),this.Ve=this.Ve.ot(e,this.Be(e).delete(t)),n&&(this.ye=this.ye.ot(e,n))}},t.prototype.removeTarget=function(t){this.ge.delete(t)},t.prototype.Me=function(t){var e=this.Ne(t).we();return this.Pe.qe(t).size+e.ee.size-e.se.size},t.prototype.me=function(t){this.Ne(t).me()},t.prototype.Ne=function(t){var e=this.ge.get(t);return e||(e=new xt,this.ge.set(t,e)),e},t.prototype.Be=function(t){var e=this.Ve.get(t);return e||(e=new ht(N),this.Ve=this.Ve.ot(t,e)),e},t.prototype.xe=function(t){var e=null!==this.ke(t);return e||y("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ke=function(t){var e=this.ge.get(t);return e&&e._e?null:this.Pe.Ue(t)},t.prototype.Fe=function(t){var e=this;this.ge.set(t,new xt),this.Pe.qe(t).forEach((function(n){e.Se(t,n,null)}))},t.prototype.Le=function(t,e){return this.Pe.qe(t).has(e)},t}();function Pt(){return new dt(H.D)}function Lt(){return new dt(H.D)}function Rt(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ct(t){var e=zt(t.mapValue.fields.__local_write_time__.timestampValue);return new F(e.seconds,e.nanos)}var Vt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ut(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Rt(t)?4:10:E()}function qt(t,e){var n=Ut(t);if(n!==Ut(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ct(t).isEqual(Ct(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=zt(t.timestampValue),r=zt(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Wt(t.bytesValue).isEqual(Wt(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Kt(t.geoPointValue.latitude)===Kt(e.geoPointValue.latitude)&&Kt(t.geoPointValue.longitude)===Kt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Kt(t.integerValue)===Kt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Kt(t.doubleValue),r=Kt(e.doubleValue);return n===r?Y(n)===Y(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return D(t.arrayValue.values||[],e.arrayValue.values||[],qt);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(C(n)!==C(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!qt(n[i],r[i])))return!1;return!0}(t,e);default:return E()}}function Mt(t,e){return void 0!==(t.values||[]).find((function(t){return qt(t,e)}))}function Ft(t,e){var n=Ut(t),r=Ut(e);if(n!==r)return N(n,r);switch(n){case 0:return 0;case 1:return N(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Kt(t.integerValue||t.doubleValue),r=Kt(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Bt(t.timestampValue,e.timestampValue);case 4:return Bt(Ct(t),Ct(e));case 5:return N(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Wt(t),r=Wt(e);return n.u(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=N(n[i],r[i]);if(0!==o)return o}return N(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=N(Kt(t.latitude),Kt(e.latitude));return 0!==n?n:N(Kt(t.longitude),Kt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ft(n[i],r[i]);if(o)return o}return N(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var u=0;u<r.length&&u<o.length;++u){var s=N(r[u],o[u]);if(0!==s)return s;var a=Ft(n[r[u]],i[o[u]]);if(0!==a)return a}return N(r.length,o.length)}(t.mapValue,e.mapValue);default:throw E()}}function Bt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return N(t,e);var n=zt(t),r=zt(e),i=N(n.seconds,r.seconds);return 0!==i?i:N(n.nanos,r.nanos)}function Gt(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=zt(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Wt(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,H.Y(r).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,o=0,i=e.values||[];o<i.length;o++)r?r=!1:n+=",",n+=t(i[o]);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,o=0,i=Object.keys(e.fields||{}).sort();o<i.length;o++){var c=i[o];r?r=!1:n+=",",n+=c+":"+t(e.fields[c])}return n+"}"}(e.mapValue):E();var n,r}(t)}function zt(t){if(O(!!t),"string"==typeof t){var e=0,n=Vt.exec(t);if(O(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Kt(t.seconds),nanos:Kt(t.nanos)}}function Kt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Wt(t){return"string"==typeof t?S.fromBase64String(t):S.fromUint8Array(t)}function Ht(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.B()}}function Qt(t){return!!t&&"integerValue"in t}function Yt(t){return!!t&&"arrayValue"in t}function Xt(t){return!!t&&"nullValue"in t}function Jt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $t(t){return!!t&&"mapValue"in t}var Zt={asc:"ASCENDING",desc:"DESCENDING"},te={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ee=function(t,e){this._=t,this.Ke=e};function ne(t){return{integerValue:""+t}}function re(t,e){if(t.Ke){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Y(e)?"-0":e}}function ie(t,e){return X(e)?ne(e):re(t,e)}function oe(t,e){return t.Ke?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function se(t,e){return t.Ke?e.toBase64():e.toUint8Array()}function ue(t,e){return oe(t,e.v())}function ae(t){return O(!!t),B.V(function(t){var e=zt(t);return new F(e.seconds,e.nanos)}(t))}function ce(t,e){return function(t){return new z(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).B()}function he(t){var e=z.q(t);return O(ke(e)),e}function fe(t,e){return ce(t._,e.path)}function le(t,e){var n=he(e);return O(n.get(1)===t._.projectId),O(!n.get(3)&&!t._.database||n.get(3)===t._.database),new H(ye(n))}function pe(t,e){return ce(t._,e)}function de(t){var e=he(t);return 4===e.length?z.U():ye(e)}function ve(t){return new z(["projects",t._.projectId,"databases",t._.database]).B()}function ye(t){return O(t.length>4&&"documents"===t.get(4)),t.N(5)}function ge(t,e,n){return{name:fe(t,e),fields:n.proto.mapValue.fields}}function me(t,e){var n;if(e instanceof nn)n={update:ge(t,e.key,e.value)};else if(e instanceof cn)n={delete:fe(t,e.key)};else if(e instanceof rn)n={update:ge(t,e.key,e.data),updateMask:xe(e.Qe)};else if(e instanceof sn)n={transform:{document:fe(t,e.key),fieldTransforms:e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Ve)return{fieldPath:e.field.B(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ue)return{fieldPath:e.field.B(),appendMissingElements:{values:n.elements}};if(n instanceof Me)return{fieldPath:e.field.B(),removeAllFromArray:{values:n.elements}};if(n instanceof Be)return{fieldPath:e.field.B(),increment:n.We};throw E()}(0,t)}))}};else{if(!(e instanceof hn))return E();n={verify:fe(t,e.key)}}return e.Ge.je||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:ue(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:E()}(t,e.Ge)),n}function be(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Qe.updateTime(ae(t.updateTime)):void 0!==t.exists?Qe.exists(t.exists):Qe.ze()}(e.currentDocument):Qe.ze();if(e.update){e.update.name;var r=le(t,e.update.name),i=new fn({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){var e=t.fieldPaths||[];return new Ke(e.map((function(t){return W.G(t)})))}(e.updateMask);return new rn(r,i,o,n)}return new nn(r,i,n)}if(e.delete){var u=le(t,e.delete);return new cn(u,n)}if(e.transform){var s=le(t,e.transform.document),a=e.transform.fieldTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)O("REQUEST_TIME"===e.setToServerValue),n=new Ve;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new Ue(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Me(i)}else"increment"in e?n=new Be(t,e.increment):E();var o=W.G(e.fieldPath);return new We(o,n)}(t,e)}));return O(!0===n.exists),new sn(s,a)}if(e.verify){var c=le(t,e.verify);return new hn(c,n)}return E()}function we(t,e){return{documents:[pe(t,e.path)]}}function Ie(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=pe(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=pe(t,r.F()),n.structuredQuery.from=[{collectionId:r.k()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Jt(t.value))return{unaryFilter:{field:Ne(t.field),op:"IS_NAN"}};if(Xt(t.value))return{unaryFilter:{field:Ne(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Jt(t.value))return{unaryFilter:{field:Ne(t.field),op:"IS_NOT_NAN"}};if(Xt(t.value))return{unaryFilter:{field:Ne(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ne(t.field),op:Ae(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Ne(t.field),direction:_e(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var u=function(t,e){return t.Ke||Q(e)?e:{value:e}}(t,e.limit);return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Oe(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Oe(e.endAt)),n}function Ee(t){var e=de(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){O(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var u=[];n.where&&(u=function t(e){return e?void 0!==e.unaryFilter?[Se(e)]:void 0!==e.fieldFilter?[je(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):E():[]}(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return function(t){return new Qn(De(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var a=null;n.limit&&(a=function(t){var e;return Q(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Te(n.startAt));var h=null;return n.endAt&&(h=Te(n.endAt)),Nn(bn(e,i,s,u,a,"F",c,h))}function Oe(t){return{before:t.before,values:t.position}}function Te(t){var e=!!t.before,n=t.values||[];return new tr(n,e)}function _e(t){return Zt[t]}function Ae(t){return te[t]}function Ne(t){return{fieldPath:t.B()}}function De(t){return W.G(t.fieldPath)}function je(t){return Cn.create(De(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return E()}}(t.fieldFilter.op),t.fieldFilter.value)}function Se(t){switch(t.unaryFilter.op){case"IS_NAN":var e=De(t.unaryFilter.field);return Cn.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=De(t.unaryFilter.field);return Cn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=De(t.unaryFilter.field);return Cn.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=De(t.unaryFilter.field);return Cn.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return E()}}function xe(t){var e=[];return t.fields.forEach((function(t){return e.push(t.B())})),{fieldPaths:e}}function ke(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Pe=function(){this.He=void 0};function Le(t,e,n){return t instanceof Ve?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ue?qe(t,e):t instanceof Me?Fe(t,e):function(t,e){var n=Ce(t,e),r=Ge(n)+Ge(t.We);return Qt(n)&&Qt(t.We)?ne(r):re(t.serializer,r)}(t,e)}function Re(t,e,n){return t instanceof Ue?qe(t,e):t instanceof Me?Fe(t,e):n}function Ce(t,e){return t instanceof Be?Qt(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Ve=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Object(e.b)(n,t),n}(Pe),Ue=function(t){function n(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(e.b)(n,t),n}(Pe);function qe(t,e){for(var n=ze(e),r=function(t){n.some((function(e){return qt(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Me=function(t){function n(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(e.b)(n,t),n}(Pe);function Fe(t,e){for(var n=ze(e),r=function(t){n=n.filter((function(e){return!qt(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Be=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.We=n,r}return Object(e.b)(n,t),n}(Pe);function Ge(t){return Kt(t.integerValue||t.doubleValue)}function ze(t){return Yt(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ke=function(){function t(t){this.fields=t,t.sort(W.D)}return t.prototype.Ye=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].M(t))return!0;return!1},t.prototype.isEqual=function(t){return D(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),We=function(t,e){this.field=t,this.transform=e},He=function(t,e){this.version=t,this.transformResults=e},Qe=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.ze=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Ye(t,e){return void 0!==t.updateTime?e instanceof vn&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof vn}var Xe=function(){};function Je(t,e,n){return t instanceof nn?function(t,e,n){return new vn(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof rn?function(t,e,n){if(!Ye(t.Ge,e))return new gn(t.key,n.version);var r=on(t,e);return new vn(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof sn?function(t,e,n){if(O(null!=n.transformResults),!Ye(t.Ge,e))return new gn(t.key,n.version);var r=un(t,e),i=function(t,e,n){var r=[];O(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],u=o.transform,s=null;e instanceof vn&&(s=e.field(o.field)),r.push(Re(u,s,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,u=an(t,r.data(),i);return new vn(t.key,o,u,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new yn(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function $e(t,e,n,r){return t instanceof nn?function(t,e){if(!Ye(t.Ge,e))return e;var n=en(e);return new vn(t.key,n,t.value,{Je:!0})}(t,e):t instanceof rn?function(t,e){if(!Ye(t.Ge,e))return e;var n=en(e),r=on(t,e);return new vn(t.key,n,r,{Je:!0})}(t,e):t instanceof sn?function(t,e,n,r){if(!Ye(t.Ge,e))return e;var i=un(t,e),o=function(t,e,n,r){for(var i=[],o=0,u=t;o<u.length;o++){var s=u[o],a=s.transform,c=null;n instanceof vn&&(c=n.field(s.field)),null===c&&r instanceof vn&&(c=r.field(s.field)),i.push(Le(a,c,e))}return i}(t.fieldTransforms,n,e,r),u=an(t,i.data(),o);return new vn(t.key,i.version,u,{Je:!0})}(t,e,r,n):function(t,e){return Ye(t.Ge,e)?new yn(t.key,B.min()):e}(t,e)}function Ze(t,e){return t instanceof sn?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],u=e instanceof vn?e.field(o.field):void 0,s=Ce(o.transform,u||null);null!=s&&(n=null==n?(new ln).set(o.field,s):n.set(o.field,s))}return n?n.Xe():null}(t,e):null}function tn(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||D(t.fieldTransforms,t.fieldTransforms,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ue&&e instanceof Ue||t instanceof Me&&e instanceof Me?D(t.elements,e.elements,qt):t instanceof Be&&e instanceof Be?qt(t.We,e.We):t instanceof Ve&&e instanceof Ve}(t.transform,e.transform)}(t,e)})))}function en(t){return t instanceof vn?t.version:B.min()}var nn=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Ge=r,i.type=0,i}return Object(e.b)(n,t),n}(Xe),rn=function(t){function n(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.Qe=r,o.Ge=i,o.type=1,o}return Object(e.b)(n,t),n}(Xe);function on(t,e){return function(t,e){var n=new ln(e);return t.Qe.fields.forEach((function(e){if(!e.P()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Xe()}(t,e instanceof vn?e.data():fn.empty())}var sn=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Ge=Qe.exists(!0),r}return Object(e.b)(n,t),n}(Xe);function un(t,e){return e}function an(t,e,n){for(var r=new ln(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var cn=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ge=n,r.type=3,r}return Object(e.b)(n,t),n}(Xe),hn=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ge=n,r.type=4,r}return Object(e.b)(n,t),n}(Xe),fn=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!$t(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.k()])||null},t.prototype.isEqual=function(t){return qt(this.proto,t.proto)},t}(),ln=function(){function t(t){void 0===t&&(t=fn.empty()),this.Ze=t,this.tn=new Map}return t.prototype.set=function(t,e){return this.en(t,e),this},t.prototype.delete=function(t){return this.en(t,null),this},t.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Ut(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.k(),e)},t.prototype.Xe=function(){var t=this.nn(W.U(),this.tn);return null!=t?new fn(t):this.Ze},t.prototype.nn=function(t,e){var n=this,r=!1,i=this.Ze.field(t),o=$t(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var u=n.nn(t.child(i),e);null!=u&&(o[i]=u,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function pn(t){var e=[];return V(t.fields||{},(function(t,n){var r=new W([t]);if($t(n)){var i=pn(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,u=i;o<u.length;o++){var s=u[o];e.push(r.child(s))}}else e.push(r)})),new Ke(e)}var dn=function(t,e){this.key=t,this.version=e},vn=function(t){function n(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).sn=r,o.Je=!!i.Je,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(e.b)(n,t),n.prototype.field=function(t){return this.sn.field(t)},n.prototype.data=function(){return this.sn},n.prototype.rn=function(){return this.sn.proto},n.prototype.isEqual=function(t){return t instanceof n&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},n.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),n}(dn),yn=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(e.b)(n,t),n.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),n.prototype.isEqual=function(t){return t instanceof n&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},n}(dn),gn=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Object(e.b)(n,t),n.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),n.prototype.isEqual=function(t){return t instanceof n&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},n}(dn),mn=function(t,e,n,r,i,o,u,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===u&&(u=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=u,this.endAt=s,this.cn=null,this.un=null,this.startAt,this.endAt};function bn(t,e,n,r,i,o,u,s){return new mn(t,e,n,r,i,o,u,s)}function wn(t){return new mn(t)}function In(t){return!Q(t.limit)&&"F"===t.an}function En(t){return!Q(t.limit)&&"L"===t.an}function On(t){return t.on.length>0?t.on[0].field:null}function Tn(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.hn())return r.field}return null}function _n(t){return null!==t.collectionGroup}function An(t){var e=T(t);if(null===e.cn){e.cn=[];var n=Tn(e),r=On(e);if(null!==n&&null===r)n.W()||e.cn.push(new Qn(n)),e.cn.push(new Qn(W.j(),"asc"));else{for(var i=!1,o=0,u=e.on;o<u.length;o++){var s=u[o];e.cn.push(s),s.field.W()&&(i=!0)}if(!i){var a=e.on.length>0?e.on[e.on.length-1].dir:"asc";e.cn.push(new Qn(W.j(),a))}}}return e.cn}function Nn(t){var e=T(t);if(!e.un)if("F"===e.an)e.un=J(e.path,e.collectionGroup,An(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=An(e);r<i.length;r++){var o=i[r],u="desc"===o.dir?"asc":"desc";n.push(new Qn(o.field,u))}var s=e.endAt?new tr(e.endAt.position,!e.endAt.before):null,a=e.startAt?new tr(e.startAt.position,!e.startAt.before):null;e.un=J(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.un}function Dn(t,e,n){return new mn(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function jn(t,e){return new mn(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function Sn(t,e){return new mn(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function xn(t,e){return Z(Nn(t),Nn(e))&&t.an===e.an}function kn(t){return $(Nn(t))+"|lt:"+t.an}function Pn(t){return"Query(target="+function(t){var e=t.path.B();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.B()+" "+e.op+" "+Gt(e.value);var e})).join(", ")+"]"),Q(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return(e=t).field.B()+" ("+e.dir+")";var e})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Kn(t.startAt)),t.endAt&&(e+=", endAt: "+Kn(t.endAt)),"Target("+e+")"}(Nn(t))+"; limitType="+t.an+")"}function Ln(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.J(t.collectionGroup)&&t.path.M(n):H.X(t.path)?t.path.isEqual(n):t.path.$(n)}(t,e)&&function(t,e){for(var n=0,r=t.on;n<r.length;n++){var i=r[n];if(!i.field.W()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Wn(t.startAt,An(t),e)||t.endAt&&Wn(t.endAt,An(t),e))}(t,e)}function Rn(t){return function(e,n){for(var r=!1,i=0,o=An(t);i<o.length;i++){var u=o[i],s=Yn(u,e,n);if(0!==s)return s;r=r||u.field.W()}return 0}}var Cn=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(e.b)(n,t),n.create=function(t,e,r){return t.W()?"in"===e||"not-in"===e?this.ln(t,e,r):new Vn(t,e,r):"array-contains"===e?new Fn(t,r):"in"===e?new Bn(t,r):"not-in"===e?new Gn(t,r):"array-contains-any"===e?new zn(t,r):new n(t,e,r)},n.ln=function(t,e,n){return"in"===e?new Un(t,n):new qn(t,n)},n.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this._n(Ft(e,this.value)):null!==e&&Ut(this.value)===Ut(e)&&this._n(Ft(e,this.value))},n.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return E()}},n.prototype.hn=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},n}((function(){})),Vn=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=H.Y(r.referenceValue),i}return Object(e.b)(n,t),n.prototype.matches=function(t){var e=H.D(t.key,this.key);return this._n(e)},n}(Cn),Un=function(t){function n(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Mn("in",n),r}return Object(e.b)(n,t),n.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},n}(Cn),qn=function(t){function n(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Mn("not-in",n),r}return Object(e.b)(n,t),n.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},n}(Cn);function Mn(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return H.Y(t.referenceValue)}))}var Fn=function(t){function n(e,n){return t.call(this,e,"array-contains",n)||this}return Object(e.b)(n,t),n.prototype.matches=function(t){var e=t.field(this.field);return Yt(e)&&Mt(e.arrayValue,this.value)},n}(Cn),Bn=function(t){function n(e,n){return t.call(this,e,"in",n)||this}return Object(e.b)(n,t),n.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Mt(this.value.arrayValue,e)},n}(Cn),Gn=function(t){function n(e,n){return t.call(this,e,"not-in",n)||this}return Object(e.b)(n,t),n.prototype.matches=function(t){if(Mt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Mt(this.value.arrayValue,e)},n}(Cn),zn=function(t){function n(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(e.b)(n,t),n.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Yt(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Mt(e.value.arrayValue,t)}))},n}(Cn),tr=function(t,e){this.position=t,this.before=e};function Kn(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Gt(t)})).join(",")}function Wn(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],u=t.position[i];if(r=o.field.W()?H.D(H.Y(u.referenceValue),n.key):Ft(u,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Hn(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!qt(t.position[n],e.position[n]))return!1;return!0}var Qn=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Yn(t,e,n){var r=t.field.W()?H.D(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?Ft(r,i):E()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return E()}}function Xn(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Jn=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},$n=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.En=r,this.Tn=i,this.In=0,this.mn=null,this.An=Date.now(),this.reset()}return t.prototype.reset=function(){this.In=0},t.prototype.Rn=function(){this.In=this.Tn},t.prototype.Pn=function(t){var e=this;this.cancel();var n=Math.floor(this.In+this.gn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);i>0&&y("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.In+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mn=this.fn.yn(this.dn,i,(function(){return e.An=Date.now(),t()})),this.In*=this.En,this.In<this.wn&&(this.In=this.wn),this.In>this.Tn&&(this.In=this.Tn)},t.prototype.Vn=function(){null!==this.mn&&(this.mn.pn(),this.mn=null)},t.prototype.cancel=function(){null!==this.mn&&(this.mn.cancel(),this.mn=null)},t.prototype.gn=function(){return(Math.random()-.5)*this.In},t}(),Zn=function(){function t(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t((function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)}),(function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Dn&&E(),this.Dn=!0,this.Sn?this.error?this.Cn(n,this.error):this.Nn(e,this.result):new t((function(t,i){r.bn=function(n){r.Nn(e,n).next(t,i)},r.vn=function(e){r.Cn(n,e).next(t,i)}}))},t.prototype.xn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.Fn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Nn=function(e,n){return e?this.Fn((function(){return e(n)})):t.resolve(n)},t.prototype.Cn=function(e,n){return e?this.Fn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.On=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.kn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.On(r)},t}(),hr=function(){function n(t,e,r){this.name=t,this.version=e,this.Mn=r,12.2===n.$n(Object(c.p)())&&m("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return n.delete=function(t){return y("SimpleDb","Removing database:",t),sr(window.indexedDB.deleteDatabase(t)).xn()},n.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(n.Bn())return!0;var t=Object(c.p)(),e=n.$n(t),r=0<e&&e<10,i=n.qn(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},n.Bn=function(){var e;return void 0!==t&&"YES"===(null===(e=t.env)||void 0===e?void 0:e.Un)},n.Kn=function(t,e){return t.store(e)},n.$n=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},n.qn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},n.prototype.Qn=function(t){return Object(e.a)(this,void 0,void 0,(function(){var n,r=this;return Object(e.c)(this,(function(e){switch(e.label){case 0:return this.db?[3,2]:(y("SimpleDb","Opening database:",this.name),n=this,[4,new Promise((function(e,n){var i=indexedDB.open(r.name,r.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){n(new nr(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var r=e.target.error;"VersionError"===r.name?n(new l(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new nr(t,r))},i.onupgradeneeded=function(t){y("SimpleDb",'Database "'+r.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;r.Mn.createOrUpgrade(e,i.transaction,t.oldVersion,r.version).next((function(){y("SimpleDb","Database upgrade to version "+r.version+" complete")}))}}))]);case 1:n.db=e.sent(),e.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return r.Wn(t)}),this.db)]}}))}))},n.prototype.jn=function(t){this.Wn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},n.prototype.runTransaction=function(t,n,i,r){return Object(e.a)(this,void 0,void 0,(function(){var o,u,s,a,c;return Object(e.c)(this,(function(h){switch(h.label){case 0:o="readonly"===n,u=0,s=function(){var n,s,c,h,f;return Object(e.c)(this,(function(e){switch(e.label){case 0:++u,e.label=1;case 1:return e.trys.push([1,4,,5]),[4,a.Qn(t)];case 2:return a.db=e.sent(),n=ir.open(a.db,t,o?"readonly":"readwrite",i),s=r(n).catch((function(t){return n.abort(t),Zn.reject(t)})).xn(),c={},s.catch((function(){})),[4,n.Gn];case 3:return[2,(c.value=(e.sent(),s),c)];case 4:return h=e.sent(),f="FirebaseError"!==h.name&&u<3,y("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),a.close(),f?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}}))},a=this,h.label=1;case 1:return[5,s()];case 2:if("object"==typeof(c=h.sent()))return[2,c.value];h.label=3;case 3:return[3,1];case 4:return[2]}}))}))},n.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},n}(),er=function(){function t(t){this.zn=t,this.Hn=!1,this.Yn=null}return Object.defineProperty(t.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Jn",{get:function(){return this.Yn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Hn=!0},t.prototype.Xn=function(t){this.Yn=t},t.prototype.delete=function(){return sr(this.zn.delete())},t}(),nr=function(t){function n(e,n){var r=this;return(r=t.call(this,b.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(e.b)(n,t),n}(l);function rr(t){return"IndexedDbTransactionError"===t.name}var ir=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Zn=new Jn,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){e.error?n.Zn.reject(new nr(t,e.error)):n.Zn.resolve()},this.transaction.onerror=function(e){var r=ar(e.target.error);n.Zn.reject(new nr(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new nr(n,e)}},Object.defineProperty(t.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(y("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new or(e)},t}(),or=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(y("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(y("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),sr(n)},t.prototype.add=function(t){return y("SimpleDb","ADD",this.store.name,t,t),sr(this.store.add(t))},t.prototype.get=function(t){var e=this;return sr(this.store.get(t)).next((function(n){return void 0===n&&(n=null),y("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return y("SimpleDb","DELETE",this.store.name,t),sr(this.store.delete(t))},t.prototype.count=function(){return y("SimpleDb","COUNT",this.store.name),sr(this.store.count())},t.prototype.ts=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.es(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.ns=function(t,e){y("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.ss=!1;var r=this.cursor(n);return this.es(r,(function(t,e,n){return n.delete()}))},t.prototype.rs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.es(r,e)},t.prototype.os=function(t){var e=this.cursor({});return new Zn((function(n,r){e.onerror=function(t){var e=ar(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.es=function(t,e){var n=[];return new Zn((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new er(i),u=e(i.primaryKey,i.value,o);if(u instanceof Zn){var s=u.catch((function(t){return o.done(),Zn.reject(t)}));n.push(s)}o.Sn?r():null===o.Jn?i.continue():i.continue(o.Jn)}else r()}})).next((function(){return Zn.On(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function sr(t){return new Zn((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=ar(t.target.error);n(e)}}))}var ur=!1;function ar(t){var e=hr.$n(Object(c.p)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new l("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ur||(ur=!0,setTimeout((function(){throw r}),0)),r}}return t}function cr(){return"undefined"!=typeof window?window:null}function br(){return"undefined"!=typeof document?document:null}var fr=function(){function t(t,e,n,r,i){this.cs=t,this.dn=e,this.us=n,this.op=r,this.hs=i,this.ls=new Jn,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch((function(t){}))}return t._s=function(e,n,r,i,o){var u=new t(e,n,Date.now()+r,i,o);return u.start(r),u},t.prototype.start=function(t){var e=this;this.fs=setTimeout((function(){return e.ds()}),t)},t.prototype.pn=function(){return this.ds()},t.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new l(b.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.ds=function(){var t=this;this.cs.ws((function(){return null!==t.fs?(t.clearTimeout(),t.op().then((function(e){return t.ls.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.fs&&(this.hs(this),clearTimeout(this.fs),this.fs=null)},t}(),lr=function(){function t(){var t=this;this.Es=Promise.resolve(),this.Ts=[],this.Is=!1,this.As=[],this.Rs=null,this.Ps=!1,this.gs=[],this.ys=new $n(this,"async_queue_retry"),this.Vs=function(){var e=br();e&&y("AsyncQueue","Visibility state changed to "+e.visibilityState),t.ys.Vn()};var e=br();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Vs)}return Object.defineProperty(t.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),t.prototype.ws=function(t){this.enqueue(t)},t.prototype.bs=function(t){this.vs(),this.Ss(t)},t.prototype.Ds=function(){if(!this.Is){this.Is=!0;var t=br();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vs)}},t.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise((function(t){})):this.Ss(t)},t.prototype.Cs=function(t){var e=this;this.ws((function(){return e.Ts.push(t),e.Ns()}))},t.prototype.Ns=function(){return Object(e.a)(this,void 0,void 0,(function(){var t,n=this;return Object(e.c)(this,(function(e){switch(e.label){case 0:if(0===this.Ts.length)return[3,5];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return e.sent(),this.Ts.shift(),this.ys.reset(),[3,4];case 3:if(!rr(t=e.sent()))throw t;return y("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Ts.length>0&&this.ys.Pn((function(){return n.Ns()})),e.label=5;case 5:return[2]}}))}))},t.prototype.Ss=function(t){var e=this,n=this.Es.then((function(){return e.Ps=!0,t().catch((function(t){throw e.Rs=t,e.Ps=!1,m("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.Ps=!1,t}))}));return this.Es=n,n},t.prototype.yn=function(t,e,n){var r=this;this.vs(),this.gs.indexOf(t)>-1&&(e=0);var i=fr._s(this,t,e,n,(function(t){return r.xs(t)}));return this.As.push(i),i},t.prototype.vs=function(){this.Rs&&E()},t.prototype.Fs=function(){},t.prototype.Os=function(){return Object(e.a)(this,void 0,void 0,(function(){var t;return Object(e.c)(this,(function(e){switch(e.label){case 0:return[4,t=this.Es];case 1:e.sent(),e.label=2;case 2:if(t!==this.Es)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.ks=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},t.prototype.Ms=function(t){var e=this;return this.Os().then((function(){e.As.sort((function(t,e){return t.us-e.us}));for(var n=0,r=e.As;n<r.length;n++){var i=r[n];if(i.pn(),"all"!==t&&i.dn===t)break}return e.Os()}))},t.prototype.$s=function(t){this.gs.push(t)},t.prototype.xs=function(t){var e=this.As.indexOf(t);this.As.splice(e,1)},t}();function pr(t,e){if(m("AsyncQueue",e+": "+t),rr(t))return new l(b.UNAVAILABLE,e+": "+t);throw t}var dr=function(){this.Ls=void 0,this.listeners=[]},vr=function(){this.Bs=new M((function(t){return kn(t)}),xn),this.onlineState="Unknown",this.qs=new Set};function yr(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i,o,u,s,a,c;return Object(e.c)(this,(function(e){switch(e.label){case 0:if(r=T(t),i=n.query,o=!1,(u=r.Bs.get(i))||(o=!0,u=new dr),!o)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),s=u,[4,r.Us(i)];case 2:return s.Ls=e.sent(),[3,4];case 3:return a=e.sent(),c=pr(a,"Initialization of query '"+Pn(n.query)+"' failed"),[2,void n.onError(c)];case 4:return r.Bs.set(i,u),u.listeners.push(n),n.Ks(r.onlineState),u.Ls&&n.Qs(u.Ls)&&Ir(r),[2]}}))}))}function gr(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i,o,u,s;return Object(e.c)(this,(function(e){return r=T(t),i=n.query,o=!1,(u=r.Bs.get(i))&&(s=u.listeners.indexOf(n))>=0&&(u.listeners.splice(s,1),o=0===u.listeners.length),o?[2,(r.Bs.delete(i),r.Ws(i))]:[2]}))}))}function mr(t,e){for(var n=T(t),r=!1,i=0,o=e;i<o.length;i++){var u=o[i],s=u.query,a=n.Bs.get(s);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].Qs(u)&&(r=!0);a.Ls=u}}r&&Ir(n)}function wr(t,e,n){var r=T(t),i=r.Bs.get(e);if(i)for(var o=0,u=i.listeners;o<u.length;o++)u[o].onError(n);r.Bs.delete(e)}function Ir(t){t.qs.forEach((function(t){t.next()}))}var Er=function(){function t(t,e,n){this.query=t,this.js=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new _t(t.query,t.docs,t.Kt,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.js.next(t),o=!0):this.Ys(t,this.onlineState)&&(this.Js(t),o=!0),this.zs=t,o},t.prototype.onError=function(t){this.js.error(t)},t.prototype.Ks=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Ys(this.zs,t)&&(this.Js(this.zs),e=!0),e},t.prototype.Ys=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Xs&&n||t.docs.P()&&"Offline"!==e)},t.prototype.Hs=function(t){if(t.docChanges.length>0)return!0;var e=this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.Js=function(t){t=_t.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Gs=!0,this.js.next(t)},t}(),Or=function(){function t(t){this.uid=t}return t.prototype.Zs=function(){return null!=this.uid},t.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Or.UNAUTHENTICATED=new Or(null),Or.ei=new Or("google-credentials-uid"),Or.ni=new Or("first-party-uid");var Tr=function(t,e){this.user=e,this.type="OAuth",this.si={},this.si.Authorization="Bearer "+t},_r=function(){function t(){this.ii=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.ri=function(){},t.prototype.oi=function(t){this.ii=t,t(Or.UNAUTHENTICATED)},t.prototype.ai=function(){this.ii=null},t}(),Ar=function(){function t(t){var e=this;this.ci=null,this.currentUser=Or.UNAUTHENTICATED,this.ui=!1,this.hi=0,this.ii=null,this.forceRefresh=!1,this.ci=function(){e.hi++,e.currentUser=e.li(),e.ui=!0,e.ii&&e.ii(e.currentUser)},this.hi=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ci):(this.ci(null),t.get().then((function(t){e.auth=t,e.ci&&e.auth.addAuthTokenListener(e.ci)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.hi,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.hi!==e?(y("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(O("string"==typeof n.accessToken),new Tr(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.ri=function(){this.forceRefresh=!0},t.prototype.oi=function(t){this.ii=t,this.ui&&t(this.currentUser)},t.prototype.ai=function(){this.auth&&this.auth.removeAuthTokenListener(this.ci),this.ci=null,this.ii=null},t.prototype.li=function(){var t=this.auth&&this.auth.getUid();return O(null===t||"string"==typeof t),new Or(t)},t}(),Nr=function(){function t(t,e){this._i=t,this.fi=e,this.type="FirstParty",this.user=Or.ni}return Object.defineProperty(t.prototype,"si",{get:function(){var t={"X-Goog-AuthUser":this.fi},e=this._i.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Dr=function(){function t(t,e){this._i=t,this.fi=e}return t.prototype.getToken=function(){return Promise.resolve(new Nr(this._i,this.fi))},t.prototype.oi=function(t){t(Or.ni)},t.prototype.ai=function(){},t.prototype.ri=function(){},t}(),jr=function(){function t(t,e,n,r){this.batchId=t,this.di=e,this.baseMutations=n,this.mutations=r}return t.prototype.wi=function(t,e,n){for(var r=n.Ei,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Je(o,e,r[i]))}return e},t.prototype.Ti=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=$e(i,e,e,this.di))}for(var o=e,u=0,s=this.mutations;u<s.length;u++){var a=s[u];a.key.isEqual(t)&&(e=$e(a,e,o,this.di))}return e},t.prototype.Ii=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.Ti(r.key,t.get(r.key));i&&(n=n.ot(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),wt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&D(this.mutations,t.mutations,(function(t,e){return tn(t,e)}))&&D(this.baseMutations,t.baseMutations,(function(t,e){return tn(t,e)}))},t}(),Sr=function(){function t(t,e,n,r){this.batch=t,this.mi=e,this.Ei=n,this.Ai=r}return t.from=function(e,n,r){O(e.mutations.length===r.length);for(var i=mt,o=e.mutations,u=0;u<o.length;u++)i=i.ot(o[u].key,r[u].version);return new t(e,n,r,i)},t}(),xr=function(){function t(){this.Ri=new M((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.Pi=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.gi},set:function(t){this.gi=t},enumerable:!1,configurable:!0}),t.prototype.yi=function(t,e){this.Vi(),this.readTime=e,this.Ri.set(t.key,t)},t.prototype.pi=function(t,e){this.Vi(),e&&(this.readTime=e),this.Ri.set(t,null)},t.prototype.bi=function(t,e){this.Vi();var n=this.Ri.get(e);return void 0!==n?Zn.resolve(n):this.vi(t,e)},t.prototype.getEntries=function(t,e){return this.Si(t,e)},t.prototype.apply=function(t){return this.Vi(),this.Pi=!0,this.Di(t)},t.prototype.Vi=function(){},t}(),kr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Pr=function(){function t(){this.Ci=[]}return t.prototype.Ni=function(t){this.Ci.push(t)},t.prototype.xi=function(){this.Ci.forEach((function(t){return t()}))},t}(),Lr=function(){function t(t,e,n){this.Fi=t,this.Oi=e,this.ki=n}return t.prototype.Mi=function(t,e){var n=this;return this.Oi.$i(t,e).next((function(r){return n.Li(t,e,r)}))},t.prototype.Li=function(t,e,n){return this.Fi.bi(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].Ti(e,t);return t}))},t.prototype.Bi=function(t,e,n){var r=vt();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].Ti(t,e);r=r.ot(t,e)})),r},t.prototype.qi=function(t,e){var n=this;return this.Fi.getEntries(t,e).next((function(e){return n.Ui(t,e)}))},t.prototype.Ui=function(t,e){var n=this;return this.Oi.Ki(t,e).next((function(r){var i=n.Bi(t,e,r),o=pt();return i.forEach((function(t,e){e||(e=new yn(t,B.min())),o=o.ot(t,e)})),o}))},t.prototype.Qi=function(t,e,n){return function(t){return H.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Wi(t,e.path):_n(e)?this.ji(t,e,n):this.Gi(t,e,n)},t.prototype.Wi=function(t,e){return this.Mi(t,new H(e)).next((function(t){var e=gt();return t instanceof vn&&(e=e.ot(t.key,t)),e}))},t.prototype.ji=function(t,e,n){var r=this,i=e.collectionGroup,o=gt();return this.ki.zi(t,i).next((function(u){return Zn.forEach(u,(function(u){var s=function(t,e){return new mn(e,null,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,t.endAt)}(e,u.child(i));return r.Gi(t,s,n).next((function(t){t.forEach((function(t,e){o=o.ot(t,e)}))}))})).next((function(){return o}))}))},t.prototype.Gi=function(t,e,n){var r,i,o=this;return this.Fi.Qi(t,e,n).next((function(n){return r=n,o.Oi.Hi(t,e)})).next((function(e){return i=e,o.Yi(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],u=0,s=o.mutations;u<s.length;u++){var a=s[u],c=a.key,h=r.get(c),f=$e(a,h,h,o.di);r=f instanceof vn?r.ot(c,f):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){Ln(e,n)||(r=r.remove(t))})),r}))},t.prototype.Yi=function(t,e,n){for(var r=wt(),i=0,o=e;i<o.length;i++)for(var u=0,s=o[i].mutations;u<s.length;u++){var a=s[u];a instanceof rn&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Fi.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof vn&&(c=c.ot(t,e))})),c}))},t}(),Rr=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.Ji=n,this.Xi=r}return t.Zi=function(e,n){for(var r=wt(),i=wt(),o=0,u=n.docChanges;o<u.length;o++){var s=u[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Cr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.tr=function(t){return n.er(t)},this.nr=function(t){return e.sr(t)})}return t.prototype.er=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.nr&&this.nr(t),t},t}();function Vr(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],u=N(n,i);return 0===u?N(r,o):u}Cr.ir=-1;var Ur=function(){function t(t){this.rr=t,this.buffer=new ht(Vr),this.ar=0}return t.prototype.cr=function(){return++this.ar},t.prototype.ur=function(t){var e=[t,this.cr()];if(this.buffer.size<this.rr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Vr(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),qr={hr:!1,lr:0,_r:0,dr:0},Mr=function(){function t(t,e,n){this.wr=t,this.Er=e,this.Tr=n}return t.Ir=function(e){return new t(e,t.mr,t.Ar)},t}();Mr.mr=10,Mr.Ar=1e3,Mr.Rr=new Mr(41943040,Mr.mr,Mr.Ar),Mr.Pr=new Mr(-1,0,0);var Fr=function(){function t(t,e){this.gr=t,this.cs=e,this.yr=!1,this.Vr=null}return t.prototype.start=function(t){-1!==this.gr.params.wr&&this.pr(t)},t.prototype.stop=function(){this.Vr&&(this.Vr.cancel(),this.Vr=null)},Object.defineProperty(t.prototype,"br",{get:function(){return null!==this.Vr},enumerable:!1,configurable:!0}),t.prototype.pr=function(t){var n=this,i=this.yr?3e5:6e4;y("LruGarbageCollector","Garbage collection scheduled in "+i+"ms"),this.Vr=this.cs.yn("lru_garbage_collection",i,(function(){return Object(e.a)(n,void 0,void 0,(function(){var n;return Object(e.c)(this,(function(e){switch(e.label){case 0:this.Vr=null,this.yr=!0,e.label=1;case 1:return e.trys.push([1,3,,7]),[4,t.vr(this.gr)];case 2:return e.sent(),[3,7];case 3:return rr(n=e.sent())?(y("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n),[3,6]):[3,4];case 4:return[4,uo(n)];case 5:e.sent(),e.label=6;case 6:return[3,7];case 7:return[4,this.pr(t)];case 8:return e.sent(),[2]}}))}))}))},t}(),Br=function(){function t(t,e){this.Sr=t,this.params=e}return t.prototype.Dr=function(t,e){return this.Sr.Cr(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Nr=function(t,e){var n=this;if(0===e)return Zn.resolve(Cr.ir);var r=new Ur(e);return this.Sr.Ce(t,(function(t){return r.ur(t.sequenceNumber)})).next((function(){return n.Sr.Fr(t,(function(t){return r.ur(t)}))})).next((function(){return r.maxValue}))},t.prototype.Or=function(t,e,n){return this.Sr.Or(t,e,n)},t.prototype.kr=function(t,e){return this.Sr.kr(t,e)},t.prototype.Mr=function(t,e){var n=this;return-1===this.params.wr?(y("LruGarbageCollector","Garbage collection skipped; disabled"),Zn.resolve(qr)):this.$r(t).next((function(r){return r<n.params.wr?(y("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.wr),qr):n.Lr(t,e)}))},t.prototype.$r=function(t){return this.Sr.$r(t)},t.prototype.Lr=function(t,e){var n,r,i,c,s,a,h,f=this,l=Date.now();return this.Dr(t,this.params.Er).next((function(e){return e>f.params.Tr?(y("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+f.params.Tr+" from "+e),r=f.params.Tr):r=e,c=Date.now(),f.Nr(t,r)})).next((function(r){return n=r,s=Date.now(),f.Or(t,n,e)})).next((function(e){return i=e,a=Date.now(),f.kr(t,n)})).next((function(t){return h=Date.now(),v()<=o.a.DEBUG&&y("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(c-l)+"ms\n\tDetermined least recently used "+r+" in "+(s-c)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-l)+"ms"),Zn.resolve({hr:!0,lr:r,_r:i,dr:t})}))},t}();function Gr(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Kr(e)),e=zr(t.get(n),e);return Kr(e)}function zr(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Kr(t){return t+""}function Wr(t){var e=t.length;if(O(e>=2),2===e)return O(""===t.charAt(0)&&""===t.charAt(1)),z.U();for(var n=e-2,r=[],i="",o=0;o<e;){var u=t.indexOf("",o);switch((u<0||u>n)&&E(),t.charAt(u+1)){case"":var s=t.substring(o,u),a=void 0;0===i.length?a=s:(a=i+=s,i=""),r.push(a);break;case"":i+=t.substring(o,u),i+="\0";break;case"":i+=t.substring(o,u+1);break;default:E()}o=u+2}return new z(r)}var Hr=function(t){this.Br=t};function Qr(t,e){if(e.document)return function(t,e,n){var r=le(t,e.name),i=ae(e.updateTime),o=new fn({mapValue:{fields:e.fields}});return new vn(r,i,o,{hasCommittedMutations:!!n})}(t.Br,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=H.Z(e.noDocument.path),r=Zr(e.noDocument.readTime);return new yn(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=H.Z(e.unknownDocument.path),o=Zr(e.unknownDocument.version);return new gn(i,o)}return E()}function Yr(t,e,n){var r=Xr(n),i=e.key.path.F().L();if(e instanceof vn){var o=function(t,e){return{name:fe(t,e.key),fields:e.rn().mapValue.fields,updateTime:oe(t,e.version.v())}}(t.Br,e),u=e.hasCommittedMutations;return new _i(null,null,o,u,r,i)}if(e instanceof yn){var s=e.key.path.L(),a=$r(e.version),c=e.hasCommittedMutations;return new _i(null,new Oi(s,a),null,c,r,i)}if(e instanceof gn){var h=e.key.path.L(),f=$r(e.version);return new _i(new Ti(h,f),null,null,!0,r,i)}return E()}function Xr(t){var e=t.v();return[e.seconds,e.nanoseconds]}function Jr(t){var e=new F(t[0],t[1]);return B.V(e)}function $r(t){var e=t.v();return new mi(e.seconds,e.nanoseconds)}function Zr(t){var e=new F(t.seconds,t.nanoseconds);return B.V(e)}function ti(t,e){var n=(e.baseMutations||[]).map((function(e){return be(t.Br,e)})),r=e.mutations.map((function(e){return be(t.Br,e)})),i=F.fromMillis(e.localWriteTimeMs);return new jr(e.batchId,i,n,r)}function ei(t){var e,n,r=Zr(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Zr(t.lastLimboFreeSnapshotVersion):B.min();return void 0!==t.query.documents?(O(1===(n=t.query).documents.length),e=Nn(wn(de(n.documents[0])))):e=Ee(t.query),new it(e,t.targetId,0,t.lastListenSequenceNumber,r,i,S.fromBase64String(t.resumeToken))}function ni(t,e){var n,r=$r(e.nt),i=$r(e.lastLimboFreeSnapshotVersion);n=tt(e.target)?we(t.Br,e.target):Ie(t.Br,e.target);var o=e.resumeToken.toBase64();return new Ni(e.targetId,$(e.target),r,o,e.sequenceNumber,i,n)}var li=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.ki=n,this.qr=r,this.Ur={}}return t.Kr=function(e,n,r,i){return O(""!==e.uid),new t(e.Zs()?e.uid:"",n,r,i)},t.prototype.Qr=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return oi(t).rs({index:Ii.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Wr=function(t,e,n,r){var i=this,o=si(t),u=oi(t);return u.add({}).next((function(s){O("number"==typeof s);for(var a=new jr(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return me(t.Br,e)})),i=n.mutations.map((function(e){return me(t.Br,e)}));return new Ii(e,n.batchId,n.di.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],f=new ht((function(t,e){return N(t.B(),e.B())})),l=0,p=r;l<p.length;l++){var d=p[l],v=Ei.key(i.userId,d.key.path,s);f=f.add(d.key.path.F()),h.push(u.put(c)),h.push(o.put(v,Ei.PLACEHOLDER))}return f.forEach((function(e){h.push(i.ki.jr(t,e))})),t.Ni((function(){i.Ur[s]=a.keys()})),Zn.On(h).next((function(){return a}))}))},t.prototype.Gr=function(t,e){var n=this;return oi(t).get(e).next((function(t){return t?(O(t.userId===n.userId),ti(n.serializer,t)):null}))},t.prototype.zr=function(t,e){var n=this;return this.Ur[e]?Zn.resolve(this.Ur[e]):this.Gr(t,e).next((function(t){if(t){var r=t.keys();return n.Ur[e]=r,r}return null}))},t.prototype.Hr=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return oi(t).rs({index:Ii.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(O(e.batchId>=r),o=ti(n.serializer,e)),i.done()})).next((function(){return o}))},t.prototype.Yr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return oi(t).rs({index:Ii.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.Jr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return oi(t).ts(Ii.userMutationsIndex,n).next((function(t){return t.map((function(t){return ti(e.serializer,t)}))}))},t.prototype.$i=function(t,e){var n=this,r=Ei.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return si(t).rs({range:i},(function(r,i,u){var s=r[0],a=r[1],c=r[2],h=Wr(a);if(s===n.userId&&e.path.isEqual(h))return oi(t).get(c).next((function(t){if(!t)throw E();O(t.userId===n.userId),o.push(ti(n.serializer,t))}));u.done()})).next((function(){return o}))},t.prototype.Ki=function(t,e){var n=this,r=new ht(N),i=[];return e.forEach((function(e){var o=Ei.prefixForPath(n.userId,e.path),u=IDBKeyRange.lowerBound(o),s=si(t).rs({range:u},(function(t,i,o){var u=t[0],s=t[1],a=t[2],c=Wr(s);u===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()}));i.push(s)})),Zn.On(i).next((function(){return n.Xr(t,r)}))},t.prototype.Hi=function(t,e){var n=this,r=e.path,i=r.length+1,o=Ei.prefixForPath(this.userId,r),u=IDBKeyRange.lowerBound(o),s=new ht(N);return si(t).rs({range:u},(function(t,e,o){var u=t[0],a=t[1],c=t[2],h=Wr(a);u===n.userId&&r.M(h)?h.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.Xr(t,s)}))},t.prototype.Xr=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(oi(t).get(e).next((function(t){if(null===t)throw E();O(t.userId===n.userId),r.push(ti(n.serializer,t))})))})),Zn.On(i).next((function(){return r}))},t.prototype.Zr=function(t,e){var n=this;return ii(t.eo,this.userId,e).next((function(r){return t.Ni((function(){n.no(e.batchId)})),Zn.forEach(r,(function(e){return n.qr.so(t,e)}))}))},t.prototype.no=function(t){delete this.Ur[t]},t.prototype.io=function(t){var e=this;return this.Qr(t).next((function(n){if(!n)return Zn.resolve();var r=IDBKeyRange.lowerBound(Ei.prefixForUser(e.userId)),i=[];return si(t).rs({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Wr(t[1]);i.push(o)}else r.done()})).next((function(){O(0===i.length)}))}))},t.prototype.ro=function(t,e){return ri(t,this.userId,e)},t.prototype.oo=function(t){var e=this;return ui(t).get(this.userId).next((function(t){return t||new wi(e.userId,-1,"")}))},t}();function ri(t,e,n){var r=Ei.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),u=!1;return si(t).rs({range:o,ss:!0},(function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(u=!0),r.done()})).next((function(){return u}))}function ii(t,e,n){var r=t.store(Ii.store),i=t.store(Ei.store),o=[],u=IDBKeyRange.only(n.batchId),s=0,a=r.rs({range:u},(function(t,e,n){return s++,n.delete()}));o.push(a.next((function(){O(1===s)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Ei.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Zn.On(o).next((function(){return c}))}function oi(t){return Gi.Kn(t,Ii.store)}function si(t){return Gi.Kn(t,Ei.store)}function ui(t){return Gi.Kn(t,wi.store)}var ai=function(){function t(t,e){this.serializer=t,this.ki=e}return t.prototype.yi=function(t,e,n){return fi(t).put(pi(e),n)},t.prototype.pi=function(t,e){var n=fi(t),r=pi(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.ao(t,r)}))},t.prototype.bi=function(t,e){var n=this;return fi(t).get(pi(e)).next((function(t){return n.co(t)}))},t.prototype.uo=function(t,e){var n=this;return fi(t).get(pi(e)).next((function(t){var e=n.co(t);return e?{ho:e,size:di(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=vt();return this.lo(t,e,(function(t,e){var i=n.co(e);r=r.ot(t,i)})).next((function(){return r}))},t.prototype._o=function(t,e){var n=this,r=vt(),i=new dt(H.D);return this.lo(t,e,(function(t,e){var o=n.co(e);o?(r=r.ot(t,o),i=i.ot(t,di(e))):(r=r.ot(t,null),i=i.ot(t,0))})).next((function(){return{fo:r,do:i}}))},t.prototype.lo=function(t,e,n){if(e.P())return Zn.resolve();var r=IDBKeyRange.bound(e.first().path.L(),e.last().path.L()),i=e._t(),o=i.It();return fi(t).rs({range:r},(function(t,e,r){for(var u=H.Z(t);o&&H.D(o,u)<0;)n(o,null),o=i.It();o&&o.isEqual(u)&&(n(o,e),o=i.At()?i.It():null),o?r.Xn(o.path.L()):r.done()})).next((function(){for(;o;)n(o,null),o=i.At()?i.It():null}))},t.prototype.Qi=function(t,e,n){var r=this,i=gt(),o=e.path.length+1,u={};if(n.isEqual(B.min())){var s=e.path.L();u.range=IDBKeyRange.lowerBound(s)}else{var a=e.path.L(),c=Xr(n);u.range=IDBKeyRange.lowerBound([a,c],!0),u.index=_i.collectionReadTimeIndex}return fi(t).rs(u,(function(t,n,u){if(t.length===o){var s=Qr(r.serializer,n);e.path.M(s.key.path)?s instanceof vn&&Ln(e,s)&&(i=i.ot(s.key,s)):u.done()}})).next((function(){return i}))},t.prototype.wo=function(t){return new ci(this,!!t&&t.Eo)},t.prototype.To=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return hi(t).get(Ai.key).next((function(t){return O(!!t),t}))},t.prototype.ao=function(t,e){return hi(t).put(Ai.key,e)},t.prototype.co=function(t){if(t){var e=Qr(this.serializer,t);return e instanceof yn&&e.version.isEqual(B.min())?null:e}return null},t}(),ci=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).Io=e,r.Eo=n,r.mo=new M((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return Object(e.b)(n,t),n.prototype.Di=function(t){var e=this,n=[],r=0,i=new ht((function(t,e){return N(t.B(),e.B())}));return this.Ri.forEach((function(o,u){var s=e.mo.get(o);if(u){var a=Yr(e.Io.serializer,u,e.readTime);i=i.add(o.path.F());var c=di(a);r+=c-s,n.push(e.Io.yi(t,o,a))}else if(r-=s,e.Eo){var h=Yr(e.Io.serializer,new yn(o,B.min()),e.readTime);n.push(e.Io.yi(t,o,h))}else n.push(e.Io.pi(t,o))})),i.forEach((function(r){n.push(e.Io.ki.jr(t,r))})),n.push(this.Io.updateMetadata(t,r)),Zn.On(n)},n.prototype.vi=function(t,e){var n=this;return this.Io.uo(t,e).next((function(t){return null===t?(n.mo.set(e,0),null):(n.mo.set(e,t.size),t.ho)}))},n.prototype.Si=function(t,e){var n=this;return this.Io._o(t,e).next((function(t){var e=t.fo;return t.do.forEach((function(t,e){n.mo.set(t,e)})),e}))},n}(xr);function hi(t){return Gi.Kn(t,Ai.store)}function fi(t){return Gi.Kn(t,_i.store)}function pi(t){return t.path.L()}function di(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw E();e=t.noDocument}return JSON.stringify(e).length}var vi=function(){function t(){this.Ao=new yi}return t.prototype.jr=function(t,e){return this.Ao.add(e),Zn.resolve()},t.prototype.zi=function(t,e){return Zn.resolve(this.Ao.getEntries(e))},t}(),yi=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.k(),n=t.F(),r=this.index[e]||new ht(z.D),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.k(),n=t.F(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new ht(z.D)).L()},t}(),gi=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;O(n<r&&n>=0&&r<=10);var o=new ir("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(bi.store)}(t),function(t){t.createObjectStore(wi.store,{keyPath:wi.keyPath}),t.createObjectStore(Ii.store,{keyPath:Ii.keyPath,autoIncrement:!0}).createIndex(Ii.userMutationsIndex,Ii.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Ei.store)}(t),xi(t),function(t){t.createObjectStore(_i.store)}(t));var u=Zn.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Di.store),t.deleteObjectStore(Ni.store),t.deleteObjectStore(ji.store)}(t),xi(t)),u=u.next((function(){return function(t){var e=t.store(ji.store),n=new ji(0,0,B.min().v(),0);return e.put(ji.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(u=u.next((function(){return function(t,e){return e.store(Ii.store).ts().next((function(n){t.deleteObjectStore(Ii.store),t.createObjectStore(Ii.store,{keyPath:Ii.keyPath,autoIncrement:!0}).createIndex(Ii.userMutationsIndex,Ii.userMutationsKeyPath,{unique:!0});var r=e.store(Ii.store),i=n.map((function(t){return r.put(t)}));return Zn.On(i)}))}(t,o)}))),u=u.next((function(){!function(t){t.createObjectStore(ki.store,{keyPath:ki.keyPath})}(t)}))),n<5&&r>=5&&(u=u.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(u=u.next((function(){return function(t){t.createObjectStore(Ai.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(u=u.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(u=u.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(u=u.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(_i.store);e.createIndex(_i.readTimeIndex,_i.readTimeIndexPath,{unique:!1}),e.createIndex(_i.collectionReadTimeIndex,_i.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(u=u.next((function(){return i.rewriteCanonicalIds(o)}))),u},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(_i.store).rs((function(t,n){e+=di(n)})).next((function(){var n=new Ai(e);return t.store(Ai.store).put(Ai.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(wi.store),r=t.store(Ii.store);return n.ts().next((function(n){return Zn.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ts(Ii.userMutationsIndex,i).next((function(r){return Zn.forEach(r,(function(r){O(r.userId===n.userId);var i=ti(e.serializer,r);return ii(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Di.store),n=t.store(_i.store);return t.store(ji.store).get(ji.key).next((function(t){var r=[];return n.rs((function(n,i){var o=new z(n),u=function(t){return[0,Gr(t)]}(o);r.push(e.get(u).next((function(n){return n?Zn.resolve():function(n){return e.put(new Di(0,Gr(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Zn.On(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Si.store,{keyPath:Si.keyPath});var n=e.store(Si.store),r=new yi,i=function(t){if(r.add(t)){var e=t.k(),i=t.F();return n.put({collectionId:e,parent:Gr(i)})}};return e.store(_i.store).rs({ss:!0},(function(t,e){var n=new z(t);return i(n.F())})).next((function(){return e.store(Ei.store).rs({ss:!0},(function(t,e){t[0];var n=t[1],r=(t[2],Wr(n));return i(r.F())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(Ni.store);return n.rs((function(t,r){var i=ei(r),o=ni(e.serializer,i);return n.put(o)}))},t}(),mi=function(t,e){this.seconds=t,this.nanoseconds=e},bi=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};bi.store="owner",bi.key="owner";var wi=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};wi.store="mutationQueues",wi.keyPath="userId";var Ii=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Ii.store="mutations",Ii.keyPath="batchId",Ii.userMutationsIndex="userMutationsIndex",Ii.userMutationsKeyPath=["userId","batchId"];var Ei=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Gr(e)]},t.key=function(t,e,n){return[t,Gr(e),n]},t}();Ei.store="documentMutations",Ei.PLACEHOLDER=new Ei;var Oi=function(t,e){this.path=t,this.readTime=e},Ti=function(t,e){this.path=t,this.version=e},_i=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};_i.store="remoteDocuments",_i.readTimeIndex="readTimeIndex",_i.readTimeIndexPath="readTime",_i.collectionReadTimeIndex="collectionReadTimeIndex",_i.collectionReadTimeIndexPath=["parentPath","readTime"];var Ai=function(t){this.byteSize=t};Ai.store="remoteDocumentGlobal",Ai.key="remoteDocumentGlobalKey";var Ni=function(t,e,n,r,i,o,u){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=u};Ni.store="targets",Ni.keyPath="targetId",Ni.queryTargetsIndexName="queryTargetsIndex",Ni.queryTargetsKeyPath=["canonicalId","targetId"];var Di=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Di.store="targetDocuments",Di.keyPath=["targetId","path"],Di.documentTargetsIndex="documentTargetsIndex",Di.documentTargetsKeyPath=["path","targetId"];var ji=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};ji.key="targetGlobalKey",ji.store="targetGlobal";var Si=function(t,e){this.collectionId=t,this.parent=e};function xi(t){t.createObjectStore(Di.store,{keyPath:Di.keyPath}).createIndex(Di.documentTargetsIndex,Di.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ni.store,{keyPath:Ni.keyPath}).createIndex(Ni.queryTargetsIndexName,Ni.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ji.store)}Si.store="collectionParents",Si.keyPath=["collectionId","parent"];var ki=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};ki.store="clientMetadata",ki.keyPath="clientId";var Pi=Object(e.d)(Object(e.d)(Object(e.d)([wi.store,Ii.store,Ei.store,_i.store,Ni.store,bi.store,ji.store,Di.store],[ki.store]),[Ai.store]),[Si.store]),Li=function(){function t(){this.Ro=new yi}return t.prototype.jr=function(t,e){var n=this;if(!this.Ro.has(e)){var r=e.k(),i=e.F();t.Ni((function(){n.Ro.add(e)}));var o={collectionId:r,parent:Gr(i)};return Ri(t).put(o)}return Zn.resolve()},t.prototype.zi=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[j(e),""],!1,!0);return Ri(t).ts(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Wr(o.parent))}return n}))},t}();function Ri(t){return Gi.Kn(t,Si.store)}var Ci=function(){function t(t){this.Po=t}return t.prototype.next=function(){return this.Po+=2,this.Po},t.yo=function(){return new t(0)},t.Vo=function(){return new t(-1)},t}(),Vi=function(){function t(t,e){this.qr=t,this.serializer=e}return t.prototype.po=function(t){var e=this;return this.bo(t).next((function(n){var r=new Ci(n.highestTargetId);return n.highestTargetId=r.next(),e.vo(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.So=function(t){return this.bo(t).next((function(t){return B.V(new F(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.Do=function(t){return this.bo(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Co=function(t,e,n){var r=this;return this.bo(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.v()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.vo(t,i)}))},t.prototype.No=function(t,e){var n=this;return this.xo(t,e).next((function(){return n.bo(t).next((function(r){return r.targetCount+=1,n.Fo(e,r),n.vo(t,r)}))}))},t.prototype.Oo=function(t,e){return this.xo(t,e)},t.prototype.ko=function(t,e){var n=this;return this.Mo(t,e.targetId).next((function(){return Ui(t).delete(e.targetId)})).next((function(){return n.bo(t)})).next((function(e){return O(e.targetCount>0),e.targetCount-=1,n.vo(t,e)}))},t.prototype.Or=function(t,e,n){var r=this,i=0,o=[];return Ui(t).rs((function(u,s){var a=ei(s);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.ko(t,a)))})).next((function(){return Zn.On(o)})).next((function(){return i}))},t.prototype.Ce=function(t,e){return Ui(t).rs((function(t,n){var r=ei(n);e(r)}))},t.prototype.bo=function(t){return qi(t).get(ji.key).next((function(t){return O(null!==t),t}))},t.prototype.vo=function(t,e){return qi(t).put(ji.key,e)},t.prototype.xo=function(t,e){return Ui(t).put(ni(this.serializer,e))},t.prototype.Fo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.$o=function(t){return this.bo(t).next((function(t){return t.targetCount}))},t.prototype.Lo=function(t,e){var n=$(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ui(t).rs({range:r,index:Ni.queryTargetsIndexName},(function(t,n,r){var o=ei(n);Z(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.Bo=function(t,e,n){var r=this,i=[],o=Mi(t);return e.forEach((function(e){var u=Gr(e.path);i.push(o.put(new Di(n,u))),i.push(r.qr.qo(t,n,e))})),Zn.On(i)},t.prototype.Uo=function(t,e,n){var r=this,i=Mi(t);return Zn.forEach(e,(function(e){var o=Gr(e.path);return Zn.On([i.delete([n,o]),r.qr.Ko(t,n,e)])}))},t.prototype.Mo=function(t,e){var n=Mi(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.Qo=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Mi(t),i=wt();return r.rs({range:n,ss:!0},(function(t,e,n){var r=Wr(t[1]),o=new H(r);i=i.add(o)})).next((function(){return i}))},t.prototype.ro=function(t,e){var n=Gr(e.path),r=IDBKeyRange.bound([n],[j(n)],!1,!0),i=0;return Mi(t).rs({index:Di.documentTargetsIndex,ss:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Ue=function(t,e){return Ui(t).get(e).next((function(t){return t?ei(t):null}))},t}();function Ui(t){return Gi.Kn(t,Ni.store)}function qi(t){return Gi.Kn(t,ji.store)}function Mi(t){return Gi.Kn(t,Di.store)}var Fi="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Bi=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).eo=e,r.Wo=n,r}return Object(e.b)(n,t),n}(Pr),Gi=function(){function t(e,n,r,i,o,u,s,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.fn=o,this.window=u,this.document=s,this.jo=c,this.Go=h,this.zo=null,this.Ho=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Yo=null,this.inForeground=!1,this.Jo=null,this.Xo=null,this.Zo=Number.NEGATIVE_INFINITY,this.ta=function(t){return Promise.resolve()},!t.Ln())throw new l(b.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.qr=new Wi(this,i),this.ea=n+"main",this.serializer=new Hr(a),this.na=new hr(this.ea,10,new gi(this.serializer)),this.sa=new Vi(this.qr,this.serializer),this.ki=new Li,this.Fi=function(t,e){return new ai(t,e)}(this.serializer,this.ki),this.window&&this.window.localStorage?this.ia=this.window.localStorage:(this.ia=null,!1===h&&m("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Kn=function(t,e){if(t instanceof Bi)return hr.Kn(t.eo,e);throw E()},t.prototype.start=function(){var t=this;return this.ra().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new l(b.FAILED_PRECONDITION,Fi);return t.oa(),t.aa(),t.ca(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.sa.Do(e)}))})).then((function(e){t.zo=new Cr(e,t.jo)})).then((function(){t.Ho=!0})).catch((function(e){return t.na&&t.na.close(),Promise.reject(e)}))},t.prototype.ua=function(t){var n=this;return this.ta=function(i){return Object(e.a)(n,void 0,void 0,(function(){return Object(e.c)(this,(function(e){return this.br?[2,t(i)]:[2]}))}))},t(this.isPrimary)},t.prototype.ha=function(t){var n=this;this.na.jn((function(i){return Object(e.a)(n,void 0,void 0,(function(){return Object(e.c)(this,(function(e){switch(e.label){case 0:return null===i.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.la=function(t){var n=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws((function(){return Object(e.a)(n,void 0,void 0,(function(){return Object(e.c)(this,(function(t){switch(t.label){case 0:return this.br?[4,this.ra()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.ra=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Ki(e).put(new ki(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t._a(e).next((function(e){e||(t.isPrimary=!1,t.fn.Cs((function(){return t.ta(!1)})))}))})).next((function(){return t.fa(e)})).next((function(n){return t.isPrimary&&!n?t.da(e).next((function(){return!1})):!!n&&t.wa(e).next((function(){return!0}))}))})).catch((function(e){if(rr(e))return y("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return y("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.fn.Cs((function(){return t.ta(e)})),t.isPrimary=e}))},t.prototype._a=function(t){var e=this;return zi(t).get(bi.key).next((function(t){return Zn.resolve(e.Ea(t))}))},t.prototype.Ta=function(t){return Ki(t).delete(this.clientId)},t.prototype.Ia=function(){return Object(e.a)(this,void 0,void 0,(function(){var n,r,i,o,u=this;return Object(e.c)(this,(function(e){switch(e.label){case 0:return!this.isPrimary||this.ma(this.Zo,18e5)?[3,2]:(this.Zo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=t.Kn(e,ki.store);return n.ts().next((function(t){var e=u.Aa(t,18e5),r=t.filter((function(t){return-1===e.indexOf(t)}));return Zn.forEach(r,(function(t){return n.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(n=e.sent(),this.ia)for(r=0,i=n;r<i.length;r++)o=i[r],this.ia.removeItem(this.Ra(o.clientId));e.label=2;case 2:return[2]}}))}))},t.prototype.ca=function(){var t=this;this.Xo=this.fn.yn("client_metadata_refresh",4e3,(function(){return t.ra().then((function(){return t.Ia()})).then((function(){return t.ca()}))}))},t.prototype.Ea=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.fa=function(t){var e=this;return this.Go?Zn.resolve(!0):zi(t).get(bi.key).next((function(n){if(null!==n&&e.ma(n.leaseTimestampMs,5e3)&&!e.Pa(n.ownerId)){if(e.Ea(n)&&e.networkEnabled)return!0;if(!e.Ea(n)){if(!n.allowTabSynchronization)throw new l(b.FAILED_PRECONDITION,Fi);return!1}}return!(!e.networkEnabled||!e.inForeground)||Ki(t).ts().next((function(t){return void 0===e.Aa(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&y("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.ga=function(){return Object(e.a)(this,void 0,void 0,(function(){var t=this;return Object(e.c)(this,(function(e){switch(e.label){case 0:return this.Ho=!1,this.ya(),this.Xo&&(this.Xo.cancel(),this.Xo=null),this.Va(),this.pa(),[4,this.na.runTransaction("shutdown","readwrite",[bi.store,ki.store],(function(e){var n=new Bi(e,Cr.ir);return t.da(n).next((function(){return t.Ta(n)}))}))];case 1:return e.sent(),this.na.close(),this.ba(),[2]}}))}))},t.prototype.Aa=function(t,e){var n=this;return t.filter((function(t){return n.ma(t.updateTimeMs,e)&&!n.Pa(t.clientId)}))},t.prototype.va=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Ki(e).ts().next((function(e){return t.Aa(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"br",{get:function(){return this.Ho},enumerable:!1,configurable:!0}),t.prototype.Sa=function(t){return li.Kr(t,this.serializer,this.ki,this.qr)},t.prototype.Da=function(){return this.sa},t.prototype.Ca=function(){return this.Fi},t.prototype.Na=function(){return this.ki},t.prototype.runTransaction=function(t,e,n){var r=this;y("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.na.runTransaction(t,o,Pi,(function(o){return i=new Bi(o,r.zo?r.zo.next():Cr.ir),"readwrite-primary"===e?r._a(i).next((function(t){return!!t||r.fa(i)})).next((function(e){if(!e)throw m("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.fn.Cs((function(){return r.ta(!1)})),new l(b.FAILED_PRECONDITION,kr);return n(i)})).next((function(t){return r.wa(i).next((function(){return t}))})):r.xa(i).next((function(){return n(i)}))})).then((function(t){return i.xi(),t}))},t.prototype.xa=function(t){var e=this;return zi(t).get(bi.key).next((function(t){if(null!==t&&e.ma(t.leaseTimestampMs,5e3)&&!e.Pa(t.ownerId)&&!e.Ea(t)&&!(e.Go||e.allowTabSynchronization&&t.allowTabSynchronization))throw new l(b.FAILED_PRECONDITION,Fi)}))},t.prototype.wa=function(t){var e=new bi(this.clientId,this.allowTabSynchronization,Date.now());return zi(t).put(bi.key,e)},t.Ln=function(){return hr.Ln()},t.prototype.da=function(t){var e=this,n=zi(t);return n.get(bi.key).next((function(t){return e.Ea(t)?(y("IndexedDbPersistence","Releasing primary lease."),n.delete(bi.key)):Zn.resolve()}))},t.prototype.ma=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(m("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.oa=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Jo=function(){t.fn.ws((function(){return t.inForeground="visible"===t.document.visibilityState,t.ra()}))},this.document.addEventListener("visibilitychange",this.Jo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Va=function(){this.Jo&&(this.document.removeEventListener("visibilitychange",this.Jo),this.Jo=null)},t.prototype.aa=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Yo=function(){e.ya(),e.fn.ws((function(){return e.ga()}))},this.window.addEventListener("unload",this.Yo))},t.prototype.pa=function(){this.Yo&&(this.window.removeEventListener("unload",this.Yo),this.Yo=null)},t.prototype.Pa=function(t){var e;try{var n=null!==(null===(e=this.ia)||void 0===e?void 0:e.getItem(this.Ra(t)));return y("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return m("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.ya=function(){if(this.ia)try{this.ia.setItem(this.Ra(this.clientId),String(Date.now()))}catch(t){m("Failed to set zombie client id.",t)}},t.prototype.ba=function(){if(this.ia)try{this.ia.removeItem(this.Ra(this.clientId))}catch(t){}},t.prototype.Ra=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function zi(t){return Gi.Kn(t,bi.store)}function Ki(t){return Gi.Kn(t,ki.store)}var Wi=function(){function t(t,e){this.db=t,this.gr=new Br(this,e)}return t.prototype.Cr=function(t){var e=this.Fa(t);return this.db.Da().$o(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.Fa=function(t){var e=0;return this.Fr(t,(function(t){e++})).next((function(){return e}))},t.prototype.Ce=function(t,e){return this.db.Da().Ce(t,e)},t.prototype.Fr=function(t,e){return this.Oa(t,(function(t,n){return e(n)}))},t.prototype.qo=function(t,e,n){return Hi(t,n)},t.prototype.Ko=function(t,e,n){return Hi(t,n)},t.prototype.Or=function(t,e,n){return this.db.Da().Or(t,e,n)},t.prototype.so=function(t,e){return Hi(t,e)},t.prototype.ka=function(t,e){return function(t,e){var n=!1;return ui(t).os((function(r){return ri(t,r,e).next((function(t){return t&&(n=!0),Zn.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.kr=function(t,e){var n=this,r=this.db.Ca().wo(),i=[],o=0;return this.Oa(t,(function(u,s){if(s<=e){var a=n.ka(t,u).next((function(e){if(!e)return o++,r.bi(t,u).next((function(){return r.pi(u),Mi(t).delete([0,Gr(u.path)])}))}));i.push(a)}})).next((function(){return Zn.On(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.st(t.Wo);return this.db.Da().Oo(t,n)},t.prototype.Ma=function(t,e){return Hi(t,e)},t.prototype.Oa=function(t,e){var n,r=Mi(t),i=Cr.ir;return r.rs({index:Di.documentTargetsIndex},(function(t,r){var o=t[0],u=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==Cr.ir&&e(new H(Wr(n)),i),i=s,n=u):i=Cr.ir})).next((function(){i!==Cr.ir&&e(new H(Wr(n)),i)}))},t.prototype.$r=function(t){return this.db.Ca().To(t)},t}();function Hi(t,e){return Mi(t).put(function(t,e){return new Di(0,Gr(t.path),e)}(e,t.Wo))}function Qi(t,e){var n=t.projectId;return t.I||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Yi=function(){function t(t,e,n){this.persistence=t,this.$a=e,this.La=new dt(N),this.Ba=new M((function(t){return $(t)}),Z),this.qa=B.min(),this.Oi=t.Sa(n),this.Ua=t.Ca(),this.sa=t.Da(),this.Ka=new Lr(this.Ua,this.Oi,this.persistence.Na()),this.$a.Qa(this.Ka)}return t.prototype.vr=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.Mr(n,e.La)}))},t}();function Xi(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i,o,u;return Object(e.c)(this,(function(e){switch(e.label){case 0:return r=T(t),i=r.Oi,o=r.Ka,[4,r.persistence.runTransaction("Handle user change","readonly",(function(t){var e;return r.Oi.Jr(t).next((function(u){return e=u,i=r.persistence.Sa(n),o=new Lr(r.Ua,i,r.persistence.Na()),i.Jr(t)})).next((function(n){for(var r=[],i=[],u=wt(),s=0,a=e;s<a.length;s++){var c=a[s];r.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];u=u.add(l.key)}}for(var p=0,d=n;p<d.length;p++){var v=d[p];i.push(v.batchId);for(var y=0,m=v.mutations;y<m.length;y++){var g=m[y];u=u.add(g.key)}}return o.qi(t,u).next((function(t){return{Wa:t,ja:r,Ga:i}}))}))}))];case 1:return u=e.sent(),[2,(r.Oi=i,r.Ka=o,r.$a.Qa(r.Ka),u)]}}))}))}function Ji(t,e){var n=T(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Ua.wo({Eo:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),u=Zn.resolve();return o.forEach((function(t){u=u.next((function(){return r.bi(e,t)})).next((function(e){var o=e,u=n.Ai.get(t);O(null!==u),(!o||o.version.u(u)<0)&&(o=i.wi(t,o,n))&&r.yi(o,n.mi)}))})),u.next((function(){return t.Oi.Zr(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.Oi.io(t)})).next((function(){return n.Ka.qi(t,r)}))}))}function $i(t){var e=T(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.sa.So(t)}))}function Zi(t,e){var n=T(t),r=e.nt,i=n.La;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Ua.wo({Eo:!0});i=n.La;var u=[];e.zt.forEach((function(e,o){var s=i.get(o);if(s){u.push(n.sa.Uo(t,e.se,o).next((function(){return n.sa.Bo(t,e.ee,o)})));var a=e.resumeToken;if(a.o()>0){var c=s.it(a,r).st(t.Wo);i=i.ot(o,c),function(t,e,n){return O(e.resumeToken.o()>0),0===t.resumeToken.o()||e.nt.p()-t.nt.p()>=3e8||n.ee.size+n.ne.size+n.se.size>0}(s,c,e)&&u.push(n.sa.Oo(t,c))}}}));var s=pt(),a=wt();if(e.Yt.forEach((function(t,e){a=a.add(t)})),u.push(o.getEntries(t,a).next((function(i){e.Yt.forEach((function(a,c){var h=i.get(a);c instanceof yn&&c.version.isEqual(B.min())?(o.pi(a,r),s=s.ot(a,c)):null==h||c.version.u(h.version)>0||0===c.version.u(h.version)&&h.hasPendingWrites?(o.yi(c,r),s=s.ot(a,c)):y("LocalStore","Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version),e.Jt.has(a)&&u.push(n.persistence.qr.Ma(t,a))}))}))),!r.isEqual(B.min())){var c=n.sa.So(t).next((function(e){return n.sa.Co(t,t.Wo,r)}));u.push(c)}return Zn.On(u).next((function(){return o.apply(t)})).next((function(){return n.Ka.Ui(t,s)}))})).then((function(t){return n.La=i,t}))}function to(t,e){var n=T(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.Oi.Hr(t,e)}))}function eo(t,e){var n=T(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.sa.Lo(t,e).next((function(i){return i?(r=i,Zn.resolve(r)):n.sa.po(t).next((function(i){return r=new it(e,i,0,t.Wo),n.sa.No(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.La.get(t.targetId);return(null===r||t.nt.u(r.nt)>0)&&(n.La=n.La.ot(t.targetId,t),n.Ba.set(e,t.targetId)),t}))}function no(t,n,i){return Object(e.a)(this,void 0,void 0,(function(){var r,o,u,s;return Object(e.c)(this,(function(e){switch(e.label){case 0:r=T(t),o=r.La.get(n),u=i?"readwrite":"readwrite-primary",e.label=1;case 1:return e.trys.push([1,4,,5]),i?[3,3]:[4,r.persistence.runTransaction("Release target",u,(function(t){return r.persistence.qr.removeTarget(t,o)}))];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:if(!rr(s=e.sent()))throw s;return y("LocalStore","Failed to update sequence numbers for target "+n+": "+s),[3,5];case 5:return r.La=r.La.remove(n),r.Ba.delete(o.target),[2]}}))}))}function ro(t,e,n){var r=T(t),i=B.min(),o=wt();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=T(t),i=r.Ba.get(n);return void 0!==i?Zn.resolve(r.La.get(i)):r.sa.Lo(e,n)}(r,t,Nn(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.sa.Qo(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.$a.Qi(t,e,n?i:B.min(),n?o:wt())})).next((function(t){return{documents:t,za:o}}))}))}function io(t,e){var n=T(t),r=T(n.sa),i=n.La.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Ue(t,e).next((function(t){return t?t.target:null}))}))}function oo(t){var e=T(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=T(t),i=pt(),o=Xr(n),u=fi(e),s=IDBKeyRange.lowerBound(o,!0);return u.rs({index:_i.readTimeIndex,range:s},(function(t,e){var n=Qr(r.serializer,e);i=i.ot(n.key,n),o=e.readTime})).next((function(){return{Ha:i,readTime:Jr(o)}}))}(e.Ua,t,e.qa)})).then((function(t){var n=t.Ha,r=t.readTime;return e.qa=r,n}))}function so(t){return Object(e.a)(this,void 0,void 0,(function(){var n;return Object(e.c)(this,(function(e){return[2,(n=T(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=fi(t),n=B.min();return e.rs({index:_i.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Jr(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){n.qa=t}))]}))}))}function uo(t){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(e){if(t.code!==b.FAILED_PRECONDITION||t.message!==kr)throw t;return y("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}var ao=function(){function t(t,e,n,r,i,o){this.fn=t,this.Ya=n,this.Ja=r,this.Xa=i,this.listener=o,this.state=0,this.Za=0,this.tc=null,this.stream=null,this.ys=new $n(t,e)}return t.prototype.ec=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.nc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.sc()},t.prototype.stop=function(){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(t){switch(t.label){case 0:return this.ec()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.ic=function(){this.state=0,this.ys.reset()},t.prototype.rc=function(){var t=this;this.nc()&&null===this.tc&&(this.tc=this.fn.yn(this.Ya,6e4,(function(){return t.oc()})))},t.prototype.ac=function(t){this.cc(),this.stream.send(t)},t.prototype.oc=function(){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(t){return this.nc()?[2,this.close(0)]:[2]}))}))},t.prototype.cc=function(){this.tc&&(this.tc.cancel(),this.tc=null)},t.prototype.close=function(t,n){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(e){switch(e.label){case 0:return this.cc(),this.ys.cancel(),this.Za++,3!==t?this.ys.reset():n&&n.code===b.RESOURCE_EXHAUSTED?(m(n.toString()),m("Using maximum backoff delay to prevent overloading the backend."),this.ys.Rn()):n&&n.code===b.UNAUTHENTICATED&&this.Xa.ri(),null!==this.stream&&(this.uc(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.hc(n)];case 1:return e.sent(),[2]}}))}))},t.prototype.uc=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.lc(this.Za),n=this.Za;this.Xa.getToken().then((function(e){t.Za===n&&t._c(e)}),(function(n){e((function(){var e=new l(b.UNKNOWN,"Fetching auth token failed: "+n.message);return t.fc(e)}))}))},t.prototype._c=function(t){var e=this,n=this.lc(this.Za);this.stream=this.dc(t),this.stream.wc((function(){n((function(){return e.state=2,e.listener.wc()}))})),this.stream.hc((function(t){n((function(){return e.fc(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.sc=function(){var t=this;this.state=4,this.ys.Pn((function(){return Object(e.a)(t,void 0,void 0,(function(){return Object(e.c)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.fc=function(t){return y("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.lc=function(t){var e=this;return function(n){e.fn.ws((function(){return e.Za===t?n():(y("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),co=function(t){function n(e,n,r,i,o){var u=this;return(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,u}return Object(e.b)(n,t),n.prototype.dc=function(t){return this.Ja.Ec("Listen",t)},n.prototype.onMessage=function(t){this.ys.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:E()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Ke?(O(void 0===e||"string"==typeof e),S.fromBase64String(e||"")):(O(void 0===e||e instanceof Uint8Array),S.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),u=e.targetChange.cause,s=u&&function(t){var e=void 0===t.code?b.UNKNOWN:ut(t.code);return new l(e,t.message||"")}(u);n=new St(r,i,o,s||null)}else if("documentChange"in e){e.documentChange;var a=e.documentChange;a.document,a.document.name,a.document.updateTime;var c=le(t,a.document.name),h=ae(a.document.updateTime),f=new fn({mapValue:{fields:a.document.fields}}),d=new vn(c,h,f,{}),p=a.targetIds||[],v=a.removedTargetIds||[];n=new Dt(p,v,d.key,d)}else if("documentDelete"in e){e.documentDelete;var y=e.documentDelete;y.document;var m=le(t,y.document),w=y.readTime?ae(y.readTime):B.min(),g=new yn(m,w),I=y.removedTargetIds||[];n=new Dt([],I,g.key,g)}else if("documentRemove"in e){e.documentRemove;var T=e.documentRemove;T.document;var _=le(t,T.document),A=T.removedTargetIds||[];n=new Dt([],A,_,null)}else{if(!("filter"in e))return E();e.filter;var N=e.filter;N.targetId;var D=N.count||0,j=new ot(D),x=N.targetId;n=new jt(x,j)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return B.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?B.min():e.readTime?ae(e.readTime):B.min()}(t);return this.listener.Tc(e,n)},n.prototype.Ic=function(t){var e={};e.database=ve(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=tt(r)?{documents:we(t,r)}:{query:Ie(t,r)}).targetId=e.targetId,e.resumeToken.o()>0&&(n.resumeToken=se(t,e.resumeToken)),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return E()}}(0,e.et);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.ac(e)},n.prototype.mc=function(t){var e={};e.database=ve(this.serializer),e.removeTarget=t,this.ac(e)},n}(ao),ho=function(t){function n(e,n,r,i,o){var u=this;return(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,u.Ac=!1,u}return Object(e.b)(n,t),Object.defineProperty(n.prototype,"Rc",{get:function(){return this.Ac},enumerable:!1,configurable:!0}),n.prototype.start=function(){this.Ac=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},n.prototype.uc=function(){this.Ac&&this.Pc([])},n.prototype.dc=function(t){return this.Ja.Ec("Write",t)},n.prototype.onMessage=function(t){if(O(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Ac){this.ys.reset();var e=function(t,e){return t&&t.length>0?(O(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?ae(t.updateTime):ae(e);n.isEqual(B.min())&&(n=ae(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new He(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=ae(t.commitTime);return this.listener.gc(n,e)}return O(!t.writeResults||0===t.writeResults.length),this.Ac=!0,this.listener.yc()},n.prototype.Vc=function(){var t={};t.database=ve(this.serializer),this.ac(t)},n.prototype.Pc=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return me(e.serializer,t)}))};this.ac(n)},n}(ao),fo=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Ja=n,i.serializer=r,i.bc=!1,i}return Object(e.b)(n,t),n.prototype.vc=function(){if(this.bc)throw new l(b.FAILED_PRECONDITION,"The client has already been terminated.")},n.prototype.Sc=function(t,e,n){var r=this;return this.vc(),this.credentials.getToken().then((function(i){return r.Ja.Sc(t,e,n,i)})).catch((function(t){throw t.code===b.UNAUTHENTICATED&&r.credentials.ri(),t}))},n.prototype.Dc=function(t,e,n){var r=this;return this.vc(),this.credentials.getToken().then((function(i){return r.Ja.Dc(t,e,n,i)})).catch((function(t){throw t.code===b.UNAUTHENTICATED&&r.credentials.ri(),t}))},n.prototype.terminate=function(){this.bc=!1},n}((function(){})),lo=function(){function t(t,e){this.cs=t,this.Cc=e,this.state="Unknown",this.Nc=0,this.xc=null,this.Fc=!0}return t.prototype.Oc=function(){var t=this;0===this.Nc&&(this.kc("Unknown"),this.xc=this.cs.yn("online_state_timeout",1e4,(function(){return t.xc=null,t.Mc("Backend didn't respond within 10 seconds."),t.kc("Offline"),Promise.resolve()})))},t.prototype.$c=function(t){"Online"===this.state?this.kc("Unknown"):(this.Nc++,this.Nc>=1&&(this.Lc(),this.Mc("Connection failed 1 times. Most recent error: "+t.toString()),this.kc("Offline")))},t.prototype.set=function(t){this.Lc(),this.Nc=0,"Online"===t&&(this.Fc=!1),this.kc(t)},t.prototype.kc=function(t){t!==this.state&&(this.state=t,this.Cc(t))},t.prototype.Mc=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Fc?(m(e),this.Fc=!1):y("OnlineStateTracker",e)},t.prototype.Lc=function(){null!==this.xc&&(this.xc.cancel(),this.xc=null)},t}(),po=function(t,n,i,r,u){var s=this;this.Bc=t,this.qc=n,this.cs=i,this.Uc={},this.Kc=[],this.Qc=new Map,this.Wc=new Set,this.jc=[],this.Gc=u,this.Gc.zc((function(t){i.ws((function(){return Object(e.a)(s,void 0,void 0,(function(){return Object(e.c)(this,(function(t){switch(t.label){case 0:return Oo(this)?(y("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(e.a)(this,void 0,void 0,(function(){var n;return Object(e.c)(this,(function(e){switch(e.label){case 0:return(n=T(t)).Wc.add(4),[4,yo(n)];case 1:return e.sent(),n.Hc.set("Unknown"),n.Wc.delete(4),[4,vo(n)];case 2:return e.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Hc=new lo(i,r)};function vo(t){return Object(e.a)(this,void 0,void 0,(function(){var n,r;return Object(e.c)(this,(function(e){switch(e.label){case 0:if(!Oo(t))return[3,4];n=0,r=t.jc,e.label=1;case 1:return n<r.length?[4,(0,r[n])(!0)]:[3,4];case 2:e.sent(),e.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))}function yo(t){return Object(e.a)(this,void 0,void 0,(function(){var n,r;return Object(e.c)(this,(function(e){switch(e.label){case 0:n=0,r=t.jc,e.label=1;case 1:return n<r.length?[4,(0,r[n])(!1)]:[3,4];case 2:e.sent(),e.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))}function go(t,e){var n=T(t);n.Qc.has(e.targetId)||(n.Qc.set(e.targetId,e),Eo(n)?Io(n):Uo(n).nc()&&bo(n,e))}function mo(t,e){var n=T(t),r=Uo(n);n.Qc.delete(e),r.nc()&&wo(n,e),0===n.Qc.size&&(r.nc()?r.rc():Oo(n)&&n.Hc.set("Unknown"))}function bo(t,e){t.Yc.me(e.targetId),Uo(t).Ic(e)}function wo(t,e){t.Yc.me(e),Uo(t).mc(e)}function Io(t){t.Yc=new kt({qe:function(e){return t.Uc.qe(e)},Ue:function(e){return t.Qc.get(e)||null}}),Uo(t).start(),t.Hc.Oc()}function Eo(t){return Oo(t)&&!Uo(t).ec()&&t.Qc.size>0}function Oo(t){return 0===T(t).Wc.size}function To(t){t.Yc=void 0}function _o(t){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(e){return t.Qc.forEach((function(e,n){bo(t,e)})),[2]}))}))}function Ao(t,n){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(e){return To(t),Eo(t)?(t.Hc.$c(n),Io(t)):t.Hc.set("Unknown"),[2]}))}))}function No(t,n,i){return Object(e.a)(this,void 0,void 0,(function(){var r,u,s;return Object(e.c)(this,(function(a){switch(a.label){case 0:if(t.Hc.set("Online"),!(n instanceof St&&2===n.state&&n.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i,o,u;return Object(e.c)(this,(function(e){switch(e.label){case 0:r=n.cause,i=0,o=n.targetIds,e.label=1;case 1:return i<o.length?(u=o[i],t.Qc.has(u)?[4,t.Uc.Jc(u,r)]:[3,3]):[3,5];case 2:e.sent(),t.Qc.delete(u),t.Yc.removeTarget(u),e.label=3;case 3:e.label=4;case 4:return i++,[3,1];case 5:return[2]}}))}))}(t,n)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),y("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),r),[4,Do(t,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(n instanceof Dt?t.Yc.be(n):n instanceof jt?t.Yc.Oe(n):t.Yc.De(n),i.isEqual(B.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,$i(t.Bc)];case 8:return u=a.sent(),i.u(u)>=0?[4,function(t,e){var n=t.Yc.$e(e);return n.zt.forEach((function(n,r){if(n.resumeToken.o()>0){var i=t.Qc.get(r);i&&t.Qc.set(r,i.it(n.resumeToken,e))}})),n.Ht.forEach((function(e){var n=t.Qc.get(e);if(n){t.Qc.set(e,n.it(S.h,n.nt)),wo(t,e);var r=new it(n.target,e,1,n.sequenceNumber);bo(t,r)}})),t.Uc.Xc(n)}(t,i)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return y("RemoteStore","Failed to raise snapshot:",s=a.sent()),[4,Do(t,s)];case 12:return a.sent(),[3,13];case 13:return[2]}}))}))}function Do(t,n,i){return Object(e.a)(this,void 0,void 0,(function(){var r=this;return Object(e.c)(this,(function(u){switch(u.label){case 0:if(!rr(n))throw n;return t.Wc.add(1),[4,yo(t)];case 1:return u.sent(),t.Hc.set("Offline"),i||(i=function(){return $i(t.Bc)}),t.cs.Cs((function(){return Object(e.a)(r,void 0,void 0,(function(){return Object(e.c)(this,(function(e){switch(e.label){case 0:return y("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return e.sent(),t.Wc.delete(1),[4,vo(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function jo(t,e){return e().catch((function(n){return Do(t,n,e)}))}function So(t){return Object(e.a)(this,void 0,void 0,(function(){var n,r,i,o,u;return Object(e.c)(this,(function(e){switch(e.label){case 0:n=T(t),r=qo(n),i=n.Kc.length>0?n.Kc[n.Kc.length-1].batchId:-1,e.label=1;case 1:if(!function(t){return Oo(t)&&t.Kc.length<10}(n))return[3,7];e.label=2;case 2:return e.trys.push([2,4,,6]),[4,to(n.Bc,i)];case 3:return null===(o=e.sent())?(0===n.Kc.length&&r.rc(),[3,7]):(i=o.batchId,function(t,e){t.Kc.push(e);var n=qo(t);n.nc()&&n.Rc&&n.Pc(e.mutations)}(n,o),[3,6]);case 4:return u=e.sent(),[4,Do(n,u)];case 5:return e.sent(),[3,6];case 6:return[3,1];case 7:return xo(n)&&ko(n),[2]}}))}))}function xo(t){return Oo(t)&&!qo(t).ec()&&t.Kc.length>0}function ko(t){qo(t).start()}function Po(t){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(e){return qo(t).Vc(),[2]}))}))}function Lo(t){return Object(e.a)(this,void 0,void 0,(function(){var n,r,i,o;return Object(e.c)(this,(function(e){for(n=qo(t),r=0,i=t.Kc;r<i.length;r++)o=i[r],n.Pc(o.mutations);return[2]}))}))}function Ro(t,n,i){return Object(e.a)(this,void 0,void 0,(function(){var r,o;return Object(e.c)(this,(function(e){switch(e.label){case 0:return r=t.Kc.shift(),o=Sr.from(r,n,i),[4,jo(t,(function(){return t.Uc.Zc(o)}))];case 1:return e.sent(),[4,So(t)];case 2:return e.sent(),[2]}}))}))}function Co(t,n){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(i){switch(i.label){case 0:return n&&qo(t).Rc?[4,function(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i;return Object(e.c)(this,(function(e){switch(e.label){case 0:return st(i=n.code)&&i!==b.ABORTED?(r=t.Kc.shift(),qo(t).ic(),[4,jo(t,(function(){return t.Uc.tu(r.batchId,n)}))]):[3,3];case 1:return e.sent(),[4,So(t)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))}(t,n)]:[3,2];case 1:i.sent(),i.label=2;case 2:return xo(t)&&ko(t),[2]}}))}))}function Vo(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r;return Object(e.c)(this,(function(e){switch(e.label){case 0:return r=T(t),n?(r.Wc.delete(2),[4,vo(r)]):[3,2];case 1:return e.sent(),[3,5];case 2:return n?[3,4]:(r.Wc.add(2),[4,yo(r)]);case 3:e.sent(),r.Hc.set("Unknown"),e.label=4;case 4:e.label=5;case 5:return[2]}}))}))}function Uo(t){var n=this;return t.eu||(t.eu=function(t,e,n){var r=T(t);return r.vc(),new co(e,r.Ja,r.credentials,r.serializer,n)}(t.qc,t.cs,{wc:_o.bind(null,t),hc:Ao.bind(null,t),Tc:No.bind(null,t)}),t.jc.push((function(i){return Object(e.a)(n,void 0,void 0,(function(){return Object(e.c)(this,(function(e){switch(e.label){case 0:return i?(t.eu.ic(),Eo(t)?Io(t):t.Hc.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.eu.stop()];case 2:e.sent(),To(t),e.label=3;case 3:return[2]}}))}))}))),t.eu}function qo(t){var n=this;return t.nu||(t.nu=function(t,e,n){var r=T(t);return r.vc(),new ho(e,r.Ja,r.credentials,r.serializer,n)}(t.qc,t.cs,{wc:Po.bind(null,t),hc:Co.bind(null,t),yc:Lo.bind(null,t),gc:Ro.bind(null,t)}),t.jc.push((function(i){return Object(e.a)(n,void 0,void 0,(function(){return Object(e.c)(this,(function(e){switch(e.label){case 0:return i?(t.nu.ic(),[4,So(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.nu.stop()];case 3:e.sent(),t.Kc.length>0&&(y("RemoteStore","Stopping write stream with "+t.Kc.length+" pending writes"),t.Kc=[]),e.label=4;case 4:return[2]}}))}))}))),t.nu}var Mo=function(){function t(){this.su=new ht(Fo.iu),this.ru=new ht(Fo.ou)}return t.prototype.P=function(){return this.su.P()},t.prototype.qo=function(t,e){var n=new Fo(t,e);this.su=this.su.add(n),this.ru=this.ru.add(n)},t.prototype.au=function(t,e){var n=this;t.forEach((function(t){return n.qo(t,e)}))},t.prototype.Ko=function(t,e){this.cu(new Fo(t,e))},t.prototype.uu=function(t,e){var n=this;t.forEach((function(t){return n.Ko(t,e)}))},t.prototype.hu=function(t){var e=this,n=new H(new z([])),r=new Fo(n,t),i=new Fo(n,t+1),o=[];return this.ru.xt([r,i],(function(t){e.cu(t),o.push(t.key)})),o},t.prototype.lu=function(){var t=this;this.su.forEach((function(e){return t.cu(e)}))},t.prototype.cu=function(t){this.su=this.su.delete(t),this.ru=this.ru.delete(t)},t.prototype._u=function(t){var e=new H(new z([])),n=new Fo(e,t),r=new Fo(e,t+1),i=wt();return this.ru.xt([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.ro=function(t){var e=new Fo(t,0),n=this.su.Ot(e);return null!==n&&t.isEqual(n.key)},t}(),Fo=function(){function t(t,e){this.key=t,this.fu=e}return t.iu=function(t,e){return H.D(t.key,e.key)||N(t.fu,e.fu)},t.ou=function(t,e){return N(t.fu,e.fu)||H.D(t.key,e.key)},t}();function Bo(t,e){return"firestore_clients_"+t+"_"+e}function Go(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Zs()&&(r+="_"+e.uid),r}function zo(t,e){return"firestore_targets_"+t+"_"+e}var Ko=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.du=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),u=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(u=new l(i.error.code,i.error.message)),o?new t(e,n,i.state,u):(m("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.wu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Wo=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.du=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new l(r.error.code,r.error.message)),i?new t(e,r.state,o):(m("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.wu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Ho=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.du=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Et(),u=0;i&&u<r.activeTargetIds.length;++u)i=X(r.activeTargetIds[u]),o=o.add(r.activeTargetIds[u]);return i?new t(e,o):(m("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Qo=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.du=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(m("SharedClientState","Failed to parse online state: "+e),null)},t}(),Yo=function(){function t(){this.activeTargetIds=Et()}return t.prototype.Eu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Tu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.wu=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Xo=function(){function t(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this.Iu=r,this.mu=null,this.Cc=null,this.tr=null,this.Au=this.Ru.bind(this),this.Pu=new dt(N),this.br=!1,this.gu=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.yu=Bo(this.persistenceKey,this.Iu),this.Vu=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Pu=this.Pu.ot(this.Iu,new Yo),this.pu=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.bu=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.vu=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Su=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.Au)}return t.Ln=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(e.a)(this,void 0,void 0,(function(){var t,n,r,i,o,u,s,a,c,h,f,l=this;return Object(e.c)(this,(function(e){switch(e.label){case 0:return[4,this.mu.va()];case 1:for(t=e.sent(),n=0,r=t;n<r.length;n++)(i=r[n])!==this.Iu&&(o=this.getItem(Bo(this.persistenceKey,i)))&&(u=Ho.du(i,o))&&(this.Pu=this.Pu.ot(u.clientId,u));for(this.Du(),(s=this.storage.getItem(this.Su))&&(a=this.Cu(s))&&this.Nu(a),c=0,h=this.gu;c<h.length;c++)f=h[c],this.Ru(f);return this.gu=[],this.window.addEventListener("unload",(function(){return l.ga()})),this.br=!0,[2]}}))}))},t.prototype.sr=function(t){this.setItem(this.Vu,JSON.stringify(t))},t.prototype.xu=function(){return this.Fu(this.Pu)},t.prototype.Ou=function(t){var e=!1;return this.Pu.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.ku=function(t){this.Mu(t,"pending")},t.prototype.$u=function(t,e,n){this.Mu(t,e,n),this.Lu(t)},t.prototype.Bu=function(t){var e="not-current";if(this.Ou(t)){var n=this.storage.getItem(zo(this.persistenceKey,t));if(n){var r=Wo.du(t,n);r&&(e=r.state)}}return this.qu.Eu(t),this.Du(),e},t.prototype.Uu=function(t){this.qu.Tu(t),this.Du()},t.prototype.Ku=function(t){return this.qu.activeTargetIds.has(t)},t.prototype.Qu=function(t){this.removeItem(zo(this.persistenceKey,t))},t.prototype.Wu=function(t,e,n){this.ju(t,e,n)},t.prototype.Gu=function(t,e,n){var r=this;e.forEach((function(t){r.Lu(t)})),this.currentUser=t,n.forEach((function(t){r.ku(t)}))},t.prototype.zu=function(t){this.Hu(t)},t.prototype.ga=function(){this.br&&(this.window.removeEventListener("storage",this.Au),this.removeItem(this.yu),this.br=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return y("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){y("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){y("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ru=function(t){var n=this,i=t;if(i.storageArea===this.storage){if(y("SharedClientState","EVENT",i.key,i.newValue),i.key===this.yu)return void m("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs((function(){return Object(e.a)(n,void 0,void 0,(function(){var t,n,r,o,u,s;return Object(e.c)(this,(function(e){if(this.br){if(null!==i.key)if(this.pu.test(i.key)){if(null==i.newValue)return t=this.Yu(i.key),[2,this.Ju(t,null)];if(n=this.Xu(i.key,i.newValue))return[2,this.Ju(n.clientId,n)]}else if(this.bu.test(i.key)){if(null!==i.newValue&&(r=this.Zu(i.key,i.newValue)))return[2,this.th(r)]}else if(this.vu.test(i.key)){if(null!==i.newValue&&(o=this.eh(i.key,i.newValue)))return[2,this.nh(o)]}else if(i.key===this.Su){if(null!==i.newValue&&(u=this.Cu(i.newValue)))return[2,this.Nu(u)]}else i.key===this.Vu&&(s=function(t){var e=Cr.ir;if(null!=t)try{var n=JSON.parse(t);O("number"==typeof n),e=n}catch(t){m("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(i.newValue))!==Cr.ir&&this.tr(s)}else this.gu.push(i);return[2]}))}))}))}},Object.defineProperty(t.prototype,"qu",{get:function(){return this.Pu.get(this.Iu)},enumerable:!1,configurable:!0}),t.prototype.Du=function(){this.setItem(this.yu,this.qu.wu())},t.prototype.Mu=function(t,e,n){var r=new Ko(this.currentUser,t,e,n),i=Go(this.persistenceKey,this.currentUser,t);this.setItem(i,r.wu())},t.prototype.Lu=function(t){var e=Go(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Hu=function(t){var e={clientId:this.Iu,onlineState:t};this.storage.setItem(this.Su,JSON.stringify(e))},t.prototype.ju=function(t,e,n){var r=zo(this.persistenceKey,t),i=new Wo(t,e,n);this.setItem(r,i.wu())},t.prototype.Yu=function(t){var e=this.pu.exec(t);return e?e[1]:null},t.prototype.Xu=function(t,e){var n=this.Yu(t);return Ho.du(n,e)},t.prototype.Zu=function(t,e){var n=this.bu.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Ko.du(new Or(i),r,e)},t.prototype.eh=function(t,e){var n=this.vu.exec(t),r=Number(n[1]);return Wo.du(r,e)},t.prototype.Cu=function(t){return Qo.du(t)},t.prototype.th=function(t){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.mu.sh(t.batchId,t.state,t.error)]:(y("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.nh=function(t){return this.mu.ih(t.targetId,t.state,t.error)},t.prototype.Ju=function(t,e){var n=this,r=e?this.Pu.ot(t,e):this.Pu.remove(t),i=this.Fu(this.Pu),o=this.Fu(r),u=[],s=[];return o.forEach((function(t){i.has(t)||u.push(t)})),i.forEach((function(t){o.has(t)||s.push(t)})),this.mu.rh(u,s).then((function(){n.Pu=r}))},t.prototype.Nu=function(t){this.Pu.get(t.clientId)&&this.Cc(t.onlineState)},t.prototype.Fu=function(t){var e=Et();return t.forEach((function(t,n){e=e.kt(n.activeTargetIds)})),e},t}(),Jo=function(){function t(){this.oh=new Yo,this.ah={},this.Cc=null,this.tr=null}return t.prototype.ku=function(t){},t.prototype.$u=function(t,e,n){},t.prototype.Bu=function(t){return this.oh.Eu(t),this.ah[t]||"not-current"},t.prototype.Wu=function(t,e,n){this.ah[t]=e},t.prototype.Uu=function(t){this.oh.Tu(t)},t.prototype.Ku=function(t){return this.oh.activeTargetIds.has(t)},t.prototype.Qu=function(t){delete this.ah[t]},t.prototype.xu=function(){return this.oh.activeTargetIds},t.prototype.Ou=function(t){return this.oh.activeTargetIds.has(t)},t.prototype.start=function(){return this.oh=new Yo,Promise.resolve()},t.prototype.Gu=function(t,e,n){},t.prototype.zu=function(t){},t.prototype.ga=function(){},t.prototype.sr=function(t){},t}(),$o=function(t){this.key=t},Zo=function(t){this.key=t},ts=function(){function t(t,e){this.query=t,this.uh=e,this.hh=null,this.te=!1,this.lh=wt(),this.Qt=wt(),this._h=Rn(t),this.fh=new Ot(this._h)}return Object.defineProperty(t.prototype,"dh",{get:function(){return this.uh},enumerable:!1,configurable:!0}),t.prototype.wh=function(t,e){var n=this,r=e?e.Eh:new Tt,i=e?e.fh:this.fh,o=e?e.Qt:this.Qt,u=i,s=!1,a=In(this.query)&&i.size===this.query.limit?i.last():null,c=En(this.query)&&i.size===this.query.limit?i.first():null;if(t.ht((function(t,e){var h=i.get(t),f=e instanceof vn?e:null;f&&(f=Ln(n.query,f)?f:null);var l=!!h&&n.Qt.has(h.key),p=!!f&&(f.Je||n.Qt.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.Th(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n._h(f,a)>0||c&&n._h(f,c)<0)&&(s=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(s=!0)),d&&(f?(u=u.add(f),o=p?o.add(t):o.delete(t)):(u=u.delete(t),o=o.delete(t)))})),In(this.query)||En(this.query))for(;u.size>this.query.limit;){var h=In(this.query)?u.last():u.first();u=u.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fh:u,Eh:r,Ih:s,Qt:o}},t.prototype.Th=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},t.prototype.Di=function(t,e,n){var r=this,i=this.fh;this.fh=t.fh,this.Qt=t.Qt;var o=t.Eh.Ut();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return E()}};return n(t)-n(e)}(t.type,e.type)||r._h(t.doc,e.doc)})),this.mh(n);var u=e?this.Ah():[],s=0===this.lh.size&&this.te?1:0,a=s!==this.hh;return this.hh=s,0!==o.length||a?{snapshot:new _t(this.query,t.fh,i,o,t.Qt,0===s,a,!1),Rh:u}:{Rh:u}},t.prototype.Ks=function(t){return this.te&&"Offline"===t?(this.te=!1,this.Di({fh:this.fh,Eh:new Tt,Qt:this.Qt,Ih:!1},!1)):{Rh:[]}},t.prototype.Ph=function(t){return!this.uh.has(t)&&!!this.fh.has(t)&&!this.fh.get(t).Je},t.prototype.mh=function(t){var e=this;t&&(t.ee.forEach((function(t){return e.uh=e.uh.add(t)})),t.ne.forEach((function(t){})),t.se.forEach((function(t){return e.uh=e.uh.delete(t)})),this.te=t.te)},t.prototype.Ah=function(){var t=this;if(!this.te)return[];var e=this.lh;this.lh=wt(),this.fh.forEach((function(e){t.Ph(e.key)&&(t.lh=t.lh.add(e.key))}));var n=[];return e.forEach((function(e){t.lh.has(e)||n.push(new Zo(e))})),this.lh.forEach((function(t){e.has(t)||n.push(new $o(t))})),n},t.prototype.gh=function(t){this.uh=t.za,this.lh=wt();var e=this.wh(t.documents);return this.Di(e,!0)},t.prototype.yh=function(){return _t.Gt(this.query,this.fh,this.Qt,0===this.hh)},t}(),es=function(t,e,n){this.query=t,this.targetId=e,this.view=n},ns=function(t){this.key=t,this.Vh=!1},rs=function(){function t(t,e,n,r,i,o){this.Bc=t,this.ph=e,this.bh=n,this.Sh=r,this.currentUser=i,this.Dh=o,this.Ch={},this.Nh=new M((function(t){return kn(t)}),xn),this.xh=new Map,this.Fh=[],this.Oh=new dt(H.D),this.kh=new Map,this.Mh=new Mo,this.$h={},this.Lh=new Map,this.Bh=Ci.Vo(),this.onlineState="Unknown",this.qh=void 0}return Object.defineProperty(t.prototype,"Uh",{get:function(){return!0===this.qh},enumerable:!1,configurable:!0}),t}();function is(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i,o,u,s,a;return Object(e.c)(this,(function(e){switch(e.label){case 0:return r=ks(t),(u=r.Nh.get(n))?(i=u.targetId,r.Sh.Bu(i),o=u.view.yh(),[3,4]):[3,1];case 1:return[4,eo(r.Bc,Nn(n))];case 2:return s=e.sent(),a=r.Sh.Bu(s.targetId),i=s.targetId,[4,os(r,n,i,"current"===a)];case 3:o=e.sent(),r.Uh&&go(r.ph,s),e.label=4;case 4:return[2,o]}}))}))}function os(t,n,i,r){return Object(e.a)(this,void 0,void 0,(function(){var u,s,a,o,c,h;return Object(e.c)(this,(function(f){switch(f.label){case 0:return t.Kh=function(n,i,r){return function(t,n,i,r){return Object(e.a)(this,void 0,void 0,(function(){var o,u,s;return Object(e.c)(this,(function(e){switch(e.label){case 0:return(o=n.view.wh(i)).Ih?[4,ro(t.Bc,n.query,!1).then((function(t){var e=t.documents;return n.view.wh(e,o)}))]:[3,2];case 1:o=e.sent(),e.label=2;case 2:return u=r&&r.zt.get(n.targetId),s=n.view.Di(o,t.Uh,u),[2,(ms(t,n.targetId,s.Rh),s.snapshot)]}}))}))}(t,n,i,r)},[4,ro(t.Bc,n,!0)];case 1:return u=f.sent(),s=new ts(n,u.za),a=s.wh(u.documents),o=Nt.Zt(i,r&&"Offline"!==t.onlineState),c=s.Di(a,t.Uh,o),ms(t,i,c.Rh),h=new es(n,i,s),[2,(t.Nh.set(n,h),t.xh.has(i)?t.xh.get(i).push(n):t.xh.set(i,[n]),c.snapshot)]}}))}))}function ss(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i,o;return Object(e.c)(this,(function(e){switch(e.label){case 0:return r=T(t),i=r.Nh.get(n),(o=r.xh.get(i.targetId)).length>1?[2,(r.xh.set(i.targetId,o.filter((function(t){return!xn(t,n)}))),void r.Nh.delete(n))]:r.Uh?(r.Sh.Uu(i.targetId),r.Sh.Ou(i.targetId)?[3,2]:[4,no(r.Bc,i.targetId,!1).then((function(){r.Sh.Qu(i.targetId),mo(r.ph,i.targetId),ys(r,i.targetId)})).catch(uo)]):[3,3];case 1:e.sent(),e.label=2;case 2:return[3,5];case 3:return ys(r,i.targetId),[4,no(r.Bc,i.targetId,!0)];case 4:e.sent(),e.label=5;case 5:return[2]}}))}))}function us(t,n,i){return Object(e.a)(this,void 0,void 0,(function(){var r,o,u,s;return Object(e.c)(this,(function(e){switch(e.label){case 0:r=Ps(t),e.label=1;case 1:return e.trys.push([1,5,,6]),[4,function(t,e){var n,r=T(t),i=F.now(),o=e.reduce((function(t,e){return t.add(e.key)}),wt());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Ka.qi(t,o).next((function(o){n=o;for(var u=[],s=0,a=e;s<a.length;s++){var c=a[s],h=Ze(c,n.get(c.key));null!=h&&u.push(new rn(c.key,h,pn(h.proto.mapValue),Qe.exists(!0)))}return r.Oi.Wr(t,i,u,e)}))})).then((function(t){var e=t.Ii(n);return{batchId:t.batchId,Ri:e}}))}(r.Bc,n)];case 2:return o=e.sent(),r.Sh.ku(o.batchId),function(t,e,n){var r=t.$h[t.currentUser.ti()];r||(r=new dt(N)),r=r.ot(e,n),t.$h[t.currentUser.ti()]=r}(r,o.batchId,i),[4,Is(r,o.Ri)];case 3:return e.sent(),[4,So(r.ph)];case 4:return e.sent(),[3,6];case 5:return u=e.sent(),s=pr(u,"Failed to persist write"),i.reject(s),[3,6];case 6:return[2]}}))}))}function as(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i;return Object(e.c)(this,(function(e){switch(e.label){case 0:r=T(t),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,Zi(r.Bc,n)];case 2:return i=e.sent(),n.zt.forEach((function(t,e){var n=r.kh.get(e);n&&(O(t.ee.size+t.ne.size+t.se.size<=1),t.ee.size>0?n.Vh=!0:t.ne.size>0?O(n.Vh):t.se.size>0&&(O(n.Vh),n.Vh=!1))})),[4,Is(r,i,n)];case 3:return e.sent(),[3,6];case 4:return[4,uo(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}}))}))}function cs(t,e,n){var r=T(t);if(r.Uh&&0===n||!r.Uh&&1===n){var i=[];r.Nh.forEach((function(t,n){var r=n.view.Ks(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=T(t);n.onlineState=e;var r=!1;n.Bs.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Ks(e)&&(r=!0)})),r&&Ir(n)}(r.bh,e),i.length&&r.Ch.Tc(i),r.onlineState=e,r.Uh&&r.Sh.zu(e)}}function hs(t,n,i){return Object(e.a)(this,void 0,void 0,(function(){var r,o,u,s,a,c;return Object(e.c)(this,(function(e){switch(e.label){case 0:return(r=T(t)).Sh.Wu(n,"rejected",i),o=r.kh.get(n),(u=o&&o.key)?(s=(s=new dt(H.D)).ot(u,new yn(u,B.min())),a=wt().add(u),c=new At(B.min(),new Map,new ht(N),s,a),[4,as(r,c)]):[3,2];case 1:return e.sent(),r.Oh=r.Oh.remove(u),r.kh.delete(n),ws(r),[3,4];case 2:return[4,no(r.Bc,n,!1).then((function(){return ys(r,n,i)})).catch(uo)];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))}function fs(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i,o;return Object(e.c)(this,(function(e){switch(e.label){case 0:r=T(t),i=n.batch.batchId,e.label=1;case 1:return e.trys.push([1,4,,6]),[4,Ji(r.Bc,n)];case 2:return o=e.sent(),vs(r,i,null),ds(r,i),r.Sh.$u(i,"acknowledged"),[4,Is(r,o)];case 3:return e.sent(),[3,6];case 4:return[4,uo(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}}))}))}function ls(t,n,i){return Object(e.a)(this,void 0,void 0,(function(){var r,o;return Object(e.c)(this,(function(e){switch(e.label){case 0:r=T(t),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,function(t,e){var n=T(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.Oi.Gr(t,e).next((function(e){return O(null!==e),r=e.keys(),n.Oi.Zr(t,e)})).next((function(){return n.Oi.io(t)})).next((function(){return n.Ka.qi(t,r)}))}))}(r.Bc,n)];case 2:return o=e.sent(),vs(r,n,i),ds(r,n),r.Sh.$u(n,"rejected",i),[4,Is(r,o)];case 3:return e.sent(),[3,6];case 4:return[4,uo(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}}))}))}function ps(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i,o,u,s;return Object(e.c)(this,(function(e){switch(e.label){case 0:Oo((r=T(t)).ph)||y("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,function(t){var e=T(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.Oi.Yr(t)}))}(r.Bc)];case 2:return-1===(i=e.sent())?[2,void n.resolve()]:((o=r.Lh.get(i)||[]).push(n),r.Lh.set(i,o),[3,4]);case 3:return u=e.sent(),s=pr(u,"Initialization of waitForPendingWrites() operation failed"),n.reject(s),[3,4];case 4:return[2]}}))}))}function ds(t,e){(t.Lh.get(e)||[]).forEach((function(t){t.resolve()})),t.Lh.delete(e)}function vs(t,e,n){var r=T(t),i=r.$h[r.currentUser.ti()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.$h[r.currentUser.ti()]=i}}function ys(t,e,n){void 0===n&&(n=null),t.Sh.Uu(e);for(var r=0,i=t.xh.get(e);r<i.length;r++){var o=i[r];t.Nh.delete(o),n&&t.Ch.Qh(o,n)}t.xh.delete(e),t.Uh&&t.Mh.hu(e).forEach((function(e){t.Mh.ro(e)||gs(t,e)}))}function gs(t,e){var n=t.Oh.get(e);null!==n&&(mo(t.ph,n),t.Oh=t.Oh.remove(e),t.kh.delete(n),ws(t))}function ms(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof $o?(t.Mh.qo(o.key,e),bs(t,o)):o instanceof Zo?(y("SyncEngine","Document no longer in limbo: "+o.key),t.Mh.Ko(o.key,e),t.Mh.ro(o.key)||gs(t,o.key)):E()}}function bs(t,e){var n=e.key;t.Oh.get(n)||(y("SyncEngine","New document in limbo: "+n),t.Fh.push(n),ws(t))}function ws(t){for(;t.Fh.length>0&&t.Oh.size<t.Dh;){var e=t.Fh.shift(),n=t.Bh.next();t.kh.set(n,new ns(e)),t.Oh=t.Oh.ot(e,n),go(t.ph,new it(Nn(wn(e.path)),n,2,Cr.ir))}}function Is(t,n,i){return Object(e.a)(this,void 0,void 0,(function(){var r,u,s,a;return Object(e.c)(this,(function(o){switch(o.label){case 0:return r=T(t),u=[],s=[],a=[],r.Nh.P()?[3,3]:(r.Nh.forEach((function(t,e){a.push(r.Kh(e,n,i).then((function(t){if(t){r.Uh&&r.Sh.Wu(e.targetId,t.fromCache?"not-current":"current"),u.push(t);var n=Rr.Zi(e.targetId,t);s.push(n)}})))})),[4,Promise.all(a)]);case 1:return o.sent(),r.Ch.Tc(u),[4,function(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i,o,u,s,a,c,h,f;return Object(e.c)(this,(function(e){switch(e.label){case 0:r=T(t),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Zn.forEach(n,(function(e){return Zn.forEach(e.Ji,(function(n){return r.persistence.qr.qo(t,e.targetId,n)})).next((function(){return Zn.forEach(e.Xi,(function(n){return r.persistence.qr.Ko(t,e.targetId,n)}))}))}))}))];case 2:return e.sent(),[3,4];case 3:if(!rr(i=e.sent()))throw i;return y("LocalStore","Failed to update sequence numbers: "+i),[3,4];case 4:for(o=0,u=n;o<u.length;o++)s=u[o],a=s.targetId,s.fromCache||(c=r.La.get(a),h=c.nt,f=c.rt(h),r.La=r.La.ot(a,f));return[2]}}))}))}(r.Bc,s)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))}function Es(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i;return Object(e.c)(this,(function(e){switch(e.label){case 0:return(r=T(t)).currentUser.isEqual(n)?[3,3]:(y("SyncEngine","User change. New user:",n.ti()),[4,Xi(r.Bc,n)]);case 1:return i=e.sent(),r.currentUser=n,function(t,e){t.Lh.forEach((function(t){t.forEach((function(t){t.reject(new l(b.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Lh.clear()}(r),r.Sh.Gu(n,i.ja,i.Ga),[4,Is(r,i.Wa)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))}function Os(t,e){var n=T(t),r=n.kh.get(e);if(r&&r.Vh)return wt().add(r.key);var i=wt(),o=n.xh.get(e);if(!o)return i;for(var u=0,s=o;u<s.length;u++){var a=s[u],c=n.Nh.get(a);i=i.kt(c.view.dh)}return i}function Ts(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i,o;return Object(e.c)(this,(function(e){switch(e.label){case 0:return[4,ro((r=T(t)).Bc,n.query,!0)];case 1:return i=e.sent(),o=n.view.gh(i),[2,(r.Uh&&ms(r,n.targetId,o.Rh),o)]}}))}))}function _s(t,n,i,r){return Object(e.a)(this,void 0,void 0,(function(){var o,u;return Object(e.c)(this,(function(e){switch(e.label){case 0:return[4,function(t,e){var n=T(t),r=T(n.Oi);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.zr(t,e).next((function(e){return e?n.Ka.qi(t,e):Zn.resolve(null)}))}))}((o=T(t)).Bc,n)];case 1:return null===(u=e.sent())?[3,6]:"pending"!==i?[3,3]:[4,So(o.ph)];case 2:return e.sent(),[3,4];case 3:"acknowledged"===i||"rejected"===i?(vs(o,n,r||null),ds(o,n),function(t,e){T(T(t).Oi).no(e)}(o.Bc,n)):E(),e.label=4;case 4:return[4,Is(o,u)];case 5:return e.sent(),[3,7];case 6:y("SyncEngine","Cannot apply mutation batch with id: "+n),e.label=7;case 7:return[2]}}))}))}function As(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i,o,u,s,a,c,h;return Object(e.c)(this,(function(e){switch(e.label){case 0:return ks(r=T(t)),Ps(r),!0!==n||!0===r.qh?[3,3]:(i=r.Sh.xu(),[4,Ns(r,i.L())]);case 1:return o=e.sent(),r.qh=!0,[4,Vo(r.ph,!0)];case 2:for(e.sent(),u=0,s=o;u<s.length;u++)a=s[u],go(r.ph,a);return[3,7];case 3:return!1!==n||!1===r.qh?[3,7]:(c=[],h=Promise.resolve(),r.xh.forEach((function(t,e){r.Sh.Ku(e)?c.push(e):h=h.then((function(){return ys(r,e),no(r.Bc,e,!0)})),mo(r.ph,e)})),[4,h]);case 4:return e.sent(),[4,Ns(r,c)];case 5:return e.sent(),function(t){var e=T(t);e.kh.forEach((function(t,n){mo(e.ph,n)})),e.Mh.lu(),e.kh=new Map,e.Oh=new dt(H.D)}(r),r.qh=!1,[4,Vo(r.ph,!1)];case 6:e.sent(),e.label=7;case 7:return[2]}}))}))}function Ns(t,n,i){return Object(e.a)(this,void 0,void 0,(function(){var r,i,o,u,s,a,c,h,f,l,p,d,v,y;return Object(e.c)(this,(function(e){switch(e.label){case 0:r=T(t),i=[],o=[],u=0,s=n,e.label=1;case 1:return u<s.length?(a=s[u],c=void 0,(h=r.xh.get(a))&&0!==h.length?[4,eo(r.Bc,Nn(h[0]))]:[3,7]):[3,13];case 2:c=e.sent(),f=0,l=h,e.label=3;case 3:return f<l.length?(p=l[f],d=r.Nh.get(p),[4,Ts(r,d)]):[3,6];case 4:(v=e.sent()).snapshot&&o.push(v.snapshot),e.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,io(r.Bc,a)];case 8:return y=e.sent(),[4,eo(r.Bc,y)];case 9:return c=e.sent(),[4,os(r,Ds(y),a,!1)];case 10:e.sent(),e.label=11;case 11:i.push(c),e.label=12;case 12:return u++,[3,1];case 13:return[2,(r.Ch.Tc(o),i)]}}))}))}function Ds(t){return bn(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function js(t){var e=T(t);return T(T(e.Bc).persistence).va()}function Ss(t,n,i,r){return Object(e.a)(this,void 0,void 0,(function(){var o,u,s;return Object(e.c)(this,(function(e){switch(e.label){case 0:return(o=T(t)).qh?(y("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!o.xh.has(n))return[3,8];switch(i){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,oo(o.Bc)];case 3:return u=e.sent(),s=At.Xt(n,"current"===i),[4,Is(o,u,s)];case 4:return e.sent(),[3,8];case 5:return[4,no(o.Bc,n,!0)];case 6:return e.sent(),ys(o,n,r),[3,8];case 7:E(),e.label=8;case 8:return[2]}}))}))}function xs(t,n,i){return Object(e.a)(this,void 0,void 0,(function(){var r,o,u,s,a,c,h,f,l,p;return Object(e.c)(this,(function(d){switch(d.label){case 0:if(!(r=ks(t)).qh)return[3,10];o=0,u=n,d.label=1;case 1:return o<u.length?(s=u[o],r.xh.has(s)?(y("SyncEngine","Adding an already active target "+s),[3,5]):[4,io(r.Bc,s)]):[3,6];case 2:return a=d.sent(),[4,eo(r.Bc,a)];case 3:return c=d.sent(),[4,os(r,Ds(a),c.targetId,!1)];case 4:d.sent(),go(r.ph,c),d.label=5;case 5:return o++,[3,1];case 6:h=function(t){return Object(e.c)(this,(function(e){switch(e.label){case 0:return r.xh.has(t)?[4,no(r.Bc,t,!1).then((function(){mo(r.ph,t),ys(r,t)})).catch(uo)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},f=0,l=i,d.label=7;case 7:return f<l.length?(p=l[f],[5,h(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return f++,[3,7];case 10:return[2]}}))}))}function ks(t){var e=T(t);return e.ph.Uc.Xc=as.bind(null,e),e.ph.Uc.qe=Os.bind(null,e),e.ph.Uc.Jc=hs.bind(null,e),e.Ch.Tc=mr.bind(null,e.bh),e.Ch.Qh=wr.bind(null,e.bh),e}function Ps(t){var e=T(t);return e.ph.Uc.Zc=fs.bind(null,e),e.ph.Uc.tu=ls.bind(null,e),e}var Ls=function(){function t(){}return t.prototype.Qa=function(t){this.Wh=t},t.prototype.Qi=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.on.length||1===t.on.length&&t.on[0].field.W())}(e)||n.isEqual(B.min())?this.jh(t,e):this.Wh.qi(t,r).next((function(c){var s=i.Gh(e,c);return(In(e)||En(e))&&i.Ih(e.an,s,r,n)?i.jh(t,e):(v()<=o.a.DEBUG&&y("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Pn(e)),i.Wh.Qi(t,e,n).next((function(t){return s.forEach((function(e){t=t.ot(e.key,e)})),t})))}))},t.prototype.Gh=function(t,e){var n=new ht(Rn(t));return e.forEach((function(e,r){r instanceof vn&&Ln(t,r)&&(n=n.add(r))})),n},t.prototype.Ih=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.u(r)>0)},t.prototype.jh=function(t,e){return v()<=o.a.DEBUG&&y("IndexFreeQueryEngine","Using full collection scan to execute query:",Pn(e)),this.Wh.Qi(t,e,B.min())},t}(),Rs=function(){function t(t,e){this.ki=t,this.qr=e,this.Oi=[],this.zh=1,this.Hh=new ht(Fo.iu)}return t.prototype.Qr=function(t){return Zn.resolve(0===this.Oi.length)},t.prototype.Wr=function(t,e,n,r){var i=this.zh;this.zh++,this.Oi.length>0&&this.Oi[this.Oi.length-1];var o=new jr(i,e,n,r);this.Oi.push(o);for(var u=0,s=r;u<s.length;u++){var a=s[u];this.Hh=this.Hh.add(new Fo(a.key,i)),this.ki.jr(t,a.key.path.F())}return Zn.resolve(o)},t.prototype.Gr=function(t,e){return Zn.resolve(this.Yh(e))},t.prototype.Hr=function(t,e){var n=e+1,r=this.Jh(n),i=r<0?0:r;return Zn.resolve(this.Oi.length>i?this.Oi[i]:null)},t.prototype.Yr=function(){return Zn.resolve(0===this.Oi.length?-1:this.zh-1)},t.prototype.Jr=function(t){return Zn.resolve(this.Oi.slice())},t.prototype.$i=function(t,e){var n=this,r=new Fo(e,0),i=new Fo(e,Number.POSITIVE_INFINITY),o=[];return this.Hh.xt([r,i],(function(t){var e=n.Yh(t.fu);o.push(e)})),Zn.resolve(o)},t.prototype.Ki=function(t,e){var n=this,r=new ht(N);return e.forEach((function(t){var e=new Fo(t,0),i=new Fo(t,Number.POSITIVE_INFINITY);n.Hh.xt([e,i],(function(t){r=r.add(t.fu)}))})),Zn.resolve(this.Xh(r))},t.prototype.Hi=function(t,e){var n=e.path,r=n.length+1,i=n;H.X(i)||(i=i.child(""));var o=new Fo(new H(i),0),u=new ht(N);return this.Hh.Ft((function(t){var e=t.key.path;return!!n.M(e)&&(e.length===r&&(u=u.add(t.fu)),!0)}),o),Zn.resolve(this.Xh(u))},t.prototype.Xh=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.Yh(t);null!==r&&n.push(r)})),n},t.prototype.Zr=function(t,e){var n=this;O(0===this.Zh(e.batchId,"removed")),this.Oi.shift();var r=this.Hh;return Zn.forEach(e.mutations,(function(i){var o=new Fo(i.key,e.batchId);return r=r.delete(o),n.qr.so(t,i.key)})).next((function(){n.Hh=r}))},t.prototype.no=function(t){},t.prototype.ro=function(t,e){var n=new Fo(e,0),r=this.Hh.Ot(n);return Zn.resolve(e.isEqual(r&&r.key))},t.prototype.io=function(t){return this.Oi.length,Zn.resolve()},t.prototype.Zh=function(t,e){return this.Jh(t)},t.prototype.Jh=function(t){return 0===this.Oi.length?0:t-this.Oi[0].batchId},t.prototype.Yh=function(t){var e=this.Jh(t);return e<0||e>=this.Oi.length?null:this.Oi[e]},t}(),Cs=function(){function t(t,e){this.ki=t,this.tl=e,this.docs=new dt(H.D),this.size=0}return t.prototype.yi=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,u=this.tl(e);return this.docs=this.docs.ot(r,{ho:e,size:u,readTime:n}),this.size+=u-o,this.ki.jr(t,r.path.F())},t.prototype.pi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.bi=function(t,e){var n=this.docs.get(e);return Zn.resolve(n?n.ho:null)},t.prototype.getEntries=function(t,e){var n=this,r=vt();return e.forEach((function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ho:null)})),Zn.resolve(r)},t.prototype.Qi=function(t,e,n){for(var r=gt(),i=new H(e.path.child("")),o=this.docs.ft(i);o.At();){var u=o.It(),s=u.key,a=u.value,c=a.ho,h=a.readTime;if(!e.path.M(s.path))break;h.u(n)<=0||c instanceof vn&&Ln(e,c)&&(r=r.ot(c.key,c))}return Zn.resolve(r)},t.prototype.el=function(t,e){return Zn.forEach(this.docs,(function(t){return e(t)}))},t.prototype.wo=function(t){return new Vs(this)},t.prototype.To=function(t){return Zn.resolve(this.size)},t}(),Vs=function(t){function n(e){var n=this;return(n=t.call(this)||this).Io=e,n}return Object(e.b)(n,t),n.prototype.Di=function(t){var e=this,n=[];return this.Ri.forEach((function(r,i){i?n.push(e.Io.yi(t,i,e.readTime)):e.Io.pi(r)})),Zn.On(n)},n.prototype.vi=function(t,e){return this.Io.bi(t,e)},n.prototype.Si=function(t,e){return this.Io.getEntries(t,e)},n}(xr),Us=function(){function t(t){this.persistence=t,this.nl=new M((function(t){return $(t)}),Z),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.sl=0,this.il=new Mo,this.targetCount=0,this.rl=Ci.yo()}return t.prototype.Ce=function(t,e){return this.nl.forEach((function(t,n){return e(n)})),Zn.resolve()},t.prototype.So=function(t){return Zn.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Do=function(t){return Zn.resolve(this.sl)},t.prototype.po=function(t){return this.highestTargetId=this.rl.next(),Zn.resolve(this.highestTargetId)},t.prototype.Co=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.sl&&(this.sl=e),Zn.resolve()},t.prototype.xo=function(t){this.nl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.rl=new Ci(e),this.highestTargetId=e),t.sequenceNumber>this.sl&&(this.sl=t.sequenceNumber)},t.prototype.No=function(t,e){return this.xo(e),this.targetCount+=1,Zn.resolve()},t.prototype.Oo=function(t,e){return this.xo(e),Zn.resolve()},t.prototype.ko=function(t,e){return this.nl.delete(e.target),this.il.hu(e.targetId),this.targetCount-=1,Zn.resolve()},t.prototype.Or=function(t,e,n){var r=this,i=0,o=[];return this.nl.forEach((function(u,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.nl.delete(u),o.push(r.Mo(t,s.targetId)),i++)})),Zn.On(o).next((function(){return i}))},t.prototype.$o=function(t){return Zn.resolve(this.targetCount)},t.prototype.Lo=function(t,e){var n=this.nl.get(e)||null;return Zn.resolve(n)},t.prototype.Bo=function(t,e,n){return this.il.au(e,n),Zn.resolve()},t.prototype.Uo=function(t,e,n){this.il.uu(e,n);var r=this.persistence.qr,i=[];return r&&e.forEach((function(e){i.push(r.so(t,e))})),Zn.On(i)},t.prototype.Mo=function(t,e){return this.il.hu(e),Zn.resolve()},t.prototype.Qo=function(t,e){var n=this.il._u(e);return Zn.resolve(n)},t.prototype.ro=function(t,e){return Zn.resolve(this.il.ro(e))},t}(),qs=function(){function t(t){var e=this;this.ol={},this.zo=new Cr(0),this.Ho=!1,this.Ho=!0,this.qr=t(this),this.sa=new Us(this),this.ki=new vi,this.Fi=function(t,n){return new Cs(t,(function(t){return e.qr.al(t)}))}(this.ki)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.ga=function(){return this.Ho=!1,Promise.resolve()},Object.defineProperty(t.prototype,"br",{get:function(){return this.Ho},enumerable:!1,configurable:!0}),t.prototype.ha=function(){},t.prototype.la=function(){},t.prototype.Na=function(){return this.ki},t.prototype.Sa=function(t){var e=this.ol[t.ti()];return e||(e=new Rs(this.ki,this.qr),this.ol[t.ti()]=e),e},t.prototype.Da=function(){return this.sa},t.prototype.Ca=function(){return this.Fi},t.prototype.runTransaction=function(t,e,n){var r=this;y("MemoryPersistence","Starting transaction:",t);var i=new Ms(this.zo.next());return this.qr.cl(),n(i).next((function(t){return r.qr.ul(i).next((function(){return t}))})).xn().then((function(t){return i.xi(),t}))},t.prototype.hl=function(t,e){return Zn.kn(Object.values(this.ol).map((function(n){return function(){return n.ro(t,e)}})))},t}(),Ms=function(t){function n(e){var n=this;return(n=t.call(this)||this).Wo=e,n}return Object(e.b)(n,t),n}(Pr),Fs=function(){function t(t){this.persistence=t,this.ll=new Mo,this._l=null}return t.fl=function(e){return new t(e)},Object.defineProperty(t.prototype,"dl",{get:function(){if(this._l)return this._l;throw E()},enumerable:!1,configurable:!0}),t.prototype.qo=function(t,e,n){return this.ll.qo(n,e),this.dl.delete(n.toString()),Zn.resolve()},t.prototype.Ko=function(t,e,n){return this.ll.Ko(n,e),this.dl.add(n.toString()),Zn.resolve()},t.prototype.so=function(t,e){return this.dl.add(e.toString()),Zn.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.ll.hu(e.targetId).forEach((function(t){return n.dl.add(t.toString())}));var r=this.persistence.Da();return r.Qo(t,e.targetId).next((function(t){t.forEach((function(t){return n.dl.add(t.toString())}))})).next((function(){return r.ko(t,e)}))},t.prototype.cl=function(){this._l=new Set},t.prototype.ul=function(t){var e=this,n=this.persistence.Ca().wo();return Zn.forEach(this.dl,(function(r){var i=H.H(r);return e.wl(t,i).next((function(t){t||n.pi(i)}))})).next((function(){return e._l=null,n.apply(t)}))},t.prototype.Ma=function(t,e){var n=this;return this.wl(t,e).next((function(t){t?n.dl.delete(e.toString()):n.dl.add(e.toString())}))},t.prototype.al=function(t){return 0},t.prototype.wl=function(t,e){var n=this;return Zn.kn([function(){return Zn.resolve(n.ll.ro(e))},function(){return n.persistence.Da().ro(t,e)},function(){return n.persistence.hl(t,e)}])},t}(),Bs=function(){function t(t){this.El=t.El,this.Tl=t.Tl}return t.prototype.wc=function(t){this.Il=t},t.prototype.hc=function(t){this.ml=t},t.prototype.onMessage=function(t){this.Al=t},t.prototype.close=function(){this.Tl()},t.prototype.send=function(t){this.El(t)},t.prototype.Rl=function(){this.Il()},t.prototype.Pl=function(t){this.ml(t)},t.prototype.gl=function(t){this.Al(t)},t}(),Gs={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},zs=function(t){function n(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.T=e.T,n}return Object(e.b)(n,t),n.prototype.Sl=function(t,e,n,r){return new Promise((function(i,o){var u=new h.d;u.listenOnce(h.b.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case h.a.NO_ERROR:var e=u.getResponseJson();y("Connection","XHR received:",JSON.stringify(e)),i(e);break;case h.a.TIMEOUT:y("Connection",'RPC "'+t+'" timed out'),o(new l(b.DEADLINE_EXCEEDED,"Request time out"));break;case h.a.HTTP_ERROR:var n=u.getStatus();if(y("Connection",'RPC "'+t+'" failed with status:',n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var s=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(b).indexOf(e)>=0?e:b.UNKNOWN}(r.status);o(new l(s,r.message))}else o(new l(b.UNKNOWN,"Server responded with status "+u.getStatus()))}else o(new l(b.UNAVAILABLE,"Connection failed."));break;default:E()}}finally{y("Connection",'RPC "'+t+'" completed.')}}));var s=JSON.stringify(r);u.send(e,"POST",s,n,15)}))},n.prototype.Ec=function(t,e){var n=[this.Vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=Object(h.e)(),i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.T};this.vl(i.initMessageHeaders,e),Object(c.x)()||Object(c.A)()||Object(c.t)()||Object(c.v)()||Object(c.B)()||Object(c.s)()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");y("Connection","Creating WebChannel: "+o,i);var u=r.createWebChannel(o,i),s=!1,f=!1,d=new Bs({El:function(t){f?y("Connection","Not sending because WebChannel is closed:",t):(s||(y("Connection","Opening WebChannel transport."),u.open(),s=!0),y("Connection","WebChannel sending:",t),u.send(t))},Tl:function(){return u.close()}}),v=function(t,e){u.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return v(h.c.EventType.OPEN,(function(){f||y("Connection","WebChannel transport opened.")})),v(h.c.EventType.CLOSE,(function(){f||(f=!0,y("Connection","WebChannel transport closed"),d.Pl())})),v(h.c.EventType.ERROR,(function(t){f||(f=!0,w("Connection","WebChannel transport errored:",t),d.Pl(new l(b.UNAVAILABLE,"The operation could not be completed")))})),v(h.c.EventType.MESSAGE,(function(t){var e;if(!f){var n=t.data[0];O(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){y("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=et[t];if(void 0!==e)return ut(e)}(o),a=i.message;void 0===s&&(s=b.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),f=!0,d.Pl(new l(s,a)),u.close()}else y("Connection","WebChannel received:",n),d.gl(n)}})),setTimeout((function(){d.Rl()}),0),d},n}(function(){function t(t){this.yl=t,this._=t._;var e=t.ssl?"https":"http";this.Vl=e+"://"+t.host,this.pl="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}return t.prototype.Sc=function(t,e,n,r){var i=this.bl(t,e);y("RestConnection","Sending: ",i,n);var o={};return this.vl(o,r),this.Sl(t,i,o,n).then((function(t){return y("RestConnection","Received: ",t),t}),(function(e){throw w("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Dc=function(t,e,n,r){return this.Sc(t,e,n,r)},t.prototype.vl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.1",t["Content-Type"]="text/plain",e)for(var n in e.si)e.si.hasOwnProperty(n)&&(t[n]=e.si[n])},t.prototype.bl=function(t,e){var n=Gs[t];return this.Vl+"/v1/"+e+":"+n},t}()),Ks=function(){function t(){var t=this;this.Dl=function(){return t.Cl()},this.Nl=function(){return t.xl()},this.Fl=[],this.Ol()}return t.prototype.zc=function(t){this.Fl.push(t)},t.prototype.ga=function(){window.removeEventListener("online",this.Dl),window.removeEventListener("offline",this.Nl)},t.prototype.Ol=function(){window.addEventListener("online",this.Dl),window.addEventListener("offline",this.Nl)},t.prototype.Cl=function(){y("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Fl;t<e.length;t++)(0,e[t])(0)},t.prototype.xl=function(){y("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Fl;t<e.length;t++)(0,e[t])(1)},t.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Ws=function(){function t(){}return t.prototype.zc=function(t){},t.prototype.ga=function(){},t}();function Hs(t){return new ee(t,!0)}var Qs=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(e){switch(e.label){case 0:return this.Sh=this.kl(t),this.persistence=this.Ml(t),[4,this.persistence.start()];case 1:return e.sent(),this.$l=this.Ll(t),this.Bc=this.Bl(t),[2]}}))}))},t.prototype.Ll=function(t){return null},t.prototype.Bl=function(t){return e=this.persistence,n=new Ls,r=t.ql,new Yi(e,n,r);var e,n,r},t.prototype.Ml=function(t){return new qs(Fs.fl)},t.prototype.kl=function(t){return new Jo},t.prototype.terminate=function(){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(t){switch(t.label){case 0:return this.$l&&this.$l.stop(),[4,this.Sh.ga()];case 1:return t.sent(),[4,this.persistence.ga()];case 2:return t.sent(),[2]}}))}))},t}(),Ys=function(t){function i(e,n,r){var i=this;return(i=t.call(this)||this).Ul=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(e.b)(i,t),i.prototype.initialize=function(n){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(e){switch(e.label){case 0:return[4,t.prototype.initialize.call(this,n)];case 1:return e.sent(),[4,so(this.Bc)];case 2:return e.sent(),[4,this.Ul.initialize(this,n)];case 3:return e.sent(),[4,Ps(this.Ul.mu)];case 4:return e.sent(),[4,So(this.Ul.ph)];case 5:return e.sent(),[2]}}))}))},i.prototype.Ll=function(t){var e=this.persistence.qr.gr;return new Fr(e,t.cs)},i.prototype.Ml=function(t){var e=Qi(t.yl._,t.yl.persistenceKey),n=void 0!==this.cacheSizeBytes?Mr.Ir(this.cacheSizeBytes):Mr.Rr,r=Hs(t.yl._);return new Gi(this.synchronizeTabs,e,t.clientId,n,t.cs,cr(),br(),r,this.Sh,!!this.forceOwnership)},i.prototype.kl=function(t){return new Jo},i}(Qs),Xs=function(t){function i(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Ul=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(e.b)(i,t),i.prototype.initialize=function(n){return Object(e.a)(this,void 0,void 0,(function(){var i,r=this;return Object(e.c)(this,(function(u){switch(u.label){case 0:return[4,t.prototype.initialize.call(this,n)];case 1:return u.sent(),i=this.Ul.mu,this.Sh instanceof Xo?(this.Sh.mu={sh:_s.bind(null,i),ih:Ss.bind(null,i),rh:xs.bind(null,i),va:js.bind(null,i)},[4,this.Sh.start()]):[3,3];case 2:u.sent(),u.label=3;case 3:return[4,this.persistence.ua((function(t){return Object(e.a)(r,void 0,void 0,(function(){return Object(e.c)(this,(function(e){switch(e.label){case 0:return[4,As(this.Ul.mu,t)];case 1:return e.sent(),this.$l&&(t&&!this.$l.br?this.$l.start(this.Bc):t||this.$l.stop()),[2]}}))}))}))];case 4:return u.sent(),[2]}}))}))},i.prototype.kl=function(t){var e=cr();if(!Xo.Ln(e))throw new l(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Qi(t.yl._,t.yl.persistenceKey);return new Xo(e,t.cs,n,t.clientId,t.ql)},i}(Ys),Js=function(){function t(){}return t.prototype.initialize=function(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r=this;return Object(e.c)(this,(function(e){switch(e.label){case 0:return this.Bc?[3,2]:(this.Bc=t.Bc,this.Sh=t.Sh,this.qc=this.Kl(n),this.ph=this.Ql(n),this.bh=this.Wl(n),this.mu=this.jl(n,!t.synchronizeTabs),this.Sh.Cc=function(t){return cs(r.mu,t,1)},this.ph.Uc.Gl=Es.bind(null,this.mu),[4,Vo(this.ph,this.mu.Uh)]);case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.Wl=function(t){return new vr},t.prototype.Kl=function(t){var e,n=Hs(t.yl._),r=(e=t.yl,new zs(e));return function(t,e,n){return new fo(t,e,n)}(t.credentials,r,n)},t.prototype.Ql=function(t){var e,n,r,i,o,u=this;return e=this.Bc,n=this.qc,r=t.cs,i=function(t){return cs(u.mu,t,0)},o=Ks.Ln()?new Ks:new Ws,new po(e,n,r,i,o)},t.prototype.jl=function(t,e){return function(t,e,n,r,i,o,u){var s=new rs(t,e,n,r,i,o);return u&&(s.qh=!0),s}(this.Bc,this.ph,this.bh,this.Sh,t.ql,t.Dh,e)},t.prototype.terminate=function(){return function(t){return Object(e.a)(this,void 0,void 0,(function(){var n;return Object(e.c)(this,(function(e){switch(e.label){case 0:return n=T(t),y("RemoteStore","RemoteStore shutting down."),n.Wc.add(5),[4,yo(n)];case 1:return e.sent(),n.Gc.ga(),n.Hc.set("Unknown"),[2]}}))}))}(this.ph)},t}(),$s=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.zl(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.zl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Hl=function(){this.muted=!0},t.prototype.zl=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}();function Zs(t,e,n){if(!n)throw new l(b.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function tu(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new l(b.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function eu(t,e,n,r){if(!0===e&&!0===r)throw new l(b.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function nu(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":E()}function ru(t,e){if(e<=0)throw new l(b.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var iu=function(t){for(var e=0;e<t.length;++e)if(0===t[e].length)throw new l(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Yl=new W(t)},ou=function(t){function n(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,e)||this}return Object(e.b)(n,t),n.documentId=function(){return new n(W.j().B())},n.prototype.isEqual=function(t){return t instanceof n&&this.Yl.isEqual(t.Yl)},n}(iu),su=new RegExp("[~\\*/\\[\\]]"),uu=function(t){this.Jl=t},au=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Object(e.b)(n,t),n.prototype.Xl=function(t){if(2!==t.Zl)throw 1===t.Zl?t.t_(this.Jl+"() can only appear at the top level of your update data"):t.t_(this.Jl+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},n.prototype.isEqual=function(t){return t instanceof n},n}(uu);function cu(t,e,n){return new Iu({Zl:3,e_:e.settings.e_,methodName:t.Jl,n_:n},e._,e.serializer,e.ignoreUndefinedProperties)}var hu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Object(e.b)(n,t),n.prototype.Xl=function(t){return new We(t.path,new Ve)},n.prototype.isEqual=function(t){return t instanceof n},n}(uu),fu=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).s_=n,r}return Object(e.b)(n,t),n.prototype.Xl=function(t){var e=cu(this,t,!0),n=this.s_.map((function(t){return Nu(t,e)})),r=new Ue(n);return new We(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(uu),lu=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).s_=n,r}return Object(e.b)(n,t),n.prototype.Xl=function(t){var e=cu(this,t,!0),n=this.s_.map((function(t){return Nu(t,e)})),r=new Me(n);return new We(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(uu),pu=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).i_=n,r}return Object(e.b)(n,t),n.prototype.Xl=function(t){var e=new Be(t.serializer,ie(t.serializer,this.i_));return new We(t.path,e)},n.prototype.isEqual=function(t){return this===t},n}(uu),du=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new l(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new l(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.r_=t,this.o_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.r_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.o_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.r_===t.r_&&this.o_===t.o_},t.prototype.toJSON=function(){return{latitude:this.r_,longitude:this.o_}},t.prototype.g=function(t){return N(this.r_,t.r_)||N(this.o_,t.o_)},t}(),vu=function(t){this.a_=t},yu=/^__.*__$/,gu=function(t,e,n){this.c_=t,this.u_=e,this.h_=n},mu=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.l_=function(t,e){var n=[];return null!==this.Qe?n.push(new rn(t,this.data,this.Qe,e)):n.push(new nn(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new sn(t,this.fieldTransforms)),n},t}(),bu=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.l_=function(t,e){var n=[new rn(t,this.data,this.Qe,e)];return this.fieldTransforms.length>0&&n.push(new sn(t,this.fieldTransforms)),n},t}();function wu(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw E()}}var Iu=function(){function t(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.__(),this.fieldTransforms=i||[],this.Qe=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Zl",{get:function(){return this.settings.Zl},enumerable:!1,configurable:!0}),t.prototype.f_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},t.prototype.d_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.f_({path:n,n_:!1});return r.w_(t),r},t.prototype.E_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.f_({path:n,n_:!1});return r.__(),r},t.prototype.T_=function(t){return this.f_({path:void 0,n_:!0})},t.prototype.t_=function(t){return Pu(t,this.settings.methodName,this.settings.I_||!1,this.path,this.settings.e_)},t.prototype.contains=function(t){return void 0!==this.Qe.find((function(e){return t.M(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.M(e.field)}))},t.prototype.__=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.w_(this.path.get(t))},t.prototype.w_=function(t){if(0===t.length)throw this.t_("Document fields must not be empty");if(wu(this.Zl)&&yu.test(t))throw this.t_('Document fields cannot begin and end with "__"')},t}(),Eu=function(){function t(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||Hs(t)}return t.prototype.m_=function(t,e,n,r){return void 0===r&&(r=!1),new Iu({Zl:t,methodName:e,e_:n,path:W.U(),n_:!1,I_:r},this._,this.serializer,this.ignoreUndefinedProperties)},t}();function Ou(t,e,n,r,i,o){void 0===o&&(o={});var u=t.m_(o.merge||o.mergeFields?2:0,e,n,i);Su("Data must be an object, but it was:",u,r);var s,a,c=Du(r,u);if(o.merge)s=new Ke(u.Qe),a=u.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,d=o.mergeFields;f<d.length;f++){var p=d[f],v=void 0;if(p instanceof iu)v=p.Yl;else{if("string"!=typeof p)throw E();v=ku(e,p,n)}if(!u.contains(v))throw new l(b.INVALID_ARGUMENT,"Field '"+v+"' is specified in your field mask but missing from your input data.");Lu(h,v)||h.push(v)}s=new Ke(h),a=u.fieldTransforms.filter((function(t){return s.Ye(t.field)}))}else s=null,a=u.fieldTransforms;return new mu(new fn(c),s,a)}function Tu(t,e,n,r){var i=t.m_(1,e,n);Su("Data must be an object, but it was:",i,r);var o=[],u=new ln;V(r,(function(t,r){var s=ku(e,t,n),a=i.E_(s);if(r instanceof au||r instanceof vu&&r.a_ instanceof au)o.push(s);else{var c=Nu(r,a);null!=c&&(o.push(s),u.set(s,c))}}));var s=new Ke(o);return new bu(u.Xe(),s,i.fieldTransforms)}function _u(t,e,n,r,i,o){var u=t.m_(1,e,n),s=[xu(e,r,n)],a=[i];if(o.length%2!=0)throw new l(b.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)s.push(xu(e,o[c])),a.push(o[c+1]);for(var h=[],f=new ln,d=s.length-1;d>=0;--d)if(!Lu(h,s[d])){var p=s[d],v=a[d],y=u.E_(p);if(v instanceof au||v instanceof vu&&v.a_ instanceof au)h.push(p);else{var m=Nu(v,y);null!=m&&(h.push(p),f.set(p,m))}}var w=new Ke(h);return new bu(f.Xe(),w,u.fieldTransforms)}function Au(t,e,n,r){return void 0===r&&(r=!1),Nu(n,t.m_(r?4:3,e))}function Nu(t,e){if(t instanceof vu&&(t=t.a_),ju(t))return Su("Unsupported field value:",e,t),Du(t,e);if(t instanceof uu)return function(t,e){if(!wu(e.Zl))throw e.t_(t.Jl+"() can only be used with update() and set()");if(!e.path)throw e.t_(t.Jl+"() is not currently supported inside arrays");var n=t.Xl(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Qe.push(e.path),t instanceof Array){if(e.settings.n_&&4!==e.Zl)throw e.t_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var u=Nu(o[i],e.T_(r));null==u&&(u={nullValue:"NULL_VALUE"}),n.push(u),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ie(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=F.fromDate(t);return{timestampValue:oe(e.serializer,n)}}if(t instanceof F){var r=new F(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:oe(e.serializer,r)}}if(t instanceof du)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof x)return{bytesValue:se(e.serializer,t.l)};if(t instanceof gu){var i=e._,o=t.c_;if(!o.isEqual(i))throw e.t_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:ce(t.c_||e._,t.u_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.t_("Unsupported field value: "+nu(t))}(t,e)}function Du(t,e){var n={};return U(t)?e.path&&e.path.length>0&&e.Qe.push(e.path):V(t,(function(t,r){var i=Nu(r,e.d_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function ju(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof F||t instanceof du||t instanceof x||t instanceof gu||t instanceof uu)}function Su(t,e,n){if(!ju(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=nu(n);throw"an object"===r?e.t_(t+" a custom object"):e.t_(t+" "+r)}}function xu(t,e,n){if(e instanceof iu)return e.Yl;if("string"==typeof e)return ku(t,e);throw Pu("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function ku(t,n,r){try{return function(t){if(t.search(su)>=0)throw new l(b.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ou.bind.apply(ou,Object(e.d)([void 0],t.split("."))))}catch(e){throw new l(b.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(n).Yl}catch(n){throw Pu((i=n)instanceof Error?i.message:i.toString(),t,!1,void 0,r)}var i}function Pu(t,e,n,r,i){var o=r&&!r.P(),u=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var a="";return(o||u)&&(a+=" (found",o&&(a+=" in field "+r),u&&(a+=" in document "+i),a+=")"),new l(b.INVALID_ARGUMENT,(s+=". ")+t+a)}function Lu(t,e){return t.some((function(t){return t.isEqual(e)}))}var Ru=function(){function t(t){this.qc=t,this.A_=new Map,this.mutations=[],this.R_=!1,this.P_=null,this.g_=new Set}return t.prototype.y_=function(t){return Object(e.a)(this,void 0,void 0,(function(){var n,i=this;return Object(e.c)(this,(function(r){switch(r.label){case 0:if(this.V_(),this.mutations.length>0)throw new l(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i,o,u,s,a;return Object(e.c)(this,(function(e){switch(e.label){case 0:return r=T(t),i=ve(r.serializer)+"/documents",o={documents:n.map((function(t){return fe(r.serializer,t)}))},[4,r.Dc("BatchGetDocuments",i,o)];case 1:return u=e.sent(),s=new Map,u.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){O(!!e.found),e.found.name,e.found.updateTime;var n=le(t,e.found.name),r=ae(e.found.updateTime),i=new fn({mapValue:{fields:e.found.fields}});return new vn(n,r,i,{})}(t,e):"missing"in e?function(t,e){O(!!e.missing),O(!!e.readTime);var n=le(t,e.missing),r=ae(e.readTime);return new yn(n,r)}(t,e):E()}(r.serializer,t);s.set(e.key.toString(),e)})),a=[],[2,(n.forEach((function(t){var e=s.get(t.toString());O(!!e),a.push(e)})),a)]}}))}))}(this.qc,t)];case 1:return[2,((n=r.sent()).forEach((function(t){t instanceof yn||t instanceof vn?i.p_(t):E()})),n)]}}))}))},t.prototype.set=function(t,e){this.write(e.l_(t,this.Ge(t))),this.g_.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.l_(t,this.b_(t)))}catch(t){this.P_=t}this.g_.add(t.toString())},t.prototype.delete=function(t){this.write([new cn(t,this.Ge(t))]),this.g_.add(t.toString())},t.prototype.commit=function(){return Object(e.a)(this,void 0,void 0,(function(){var t,n=this;return Object(e.c)(this,(function(i){switch(i.label){case 0:if(this.V_(),this.P_)throw this.P_;return t=this.A_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,e){var r=H.H(e);n.mutations.push(new hn(r,n.Ge(r)))})),[4,function(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i,o;return Object(e.c)(this,(function(e){switch(e.label){case 0:return r=T(t),i=ve(r.serializer)+"/documents",o={writes:n.map((function(t){return me(r.serializer,t)}))},[4,r.Sc("Commit",i,o)];case 1:return e.sent(),[2]}}))}))}(this.qc,this.mutations)];case 1:return i.sent(),this.R_=!0,[2]}}))}))},t.prototype.p_=function(t){var e;if(t instanceof vn)e=t.version;else{if(!(t instanceof yn))throw E();e=B.min()}var n=this.A_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new l(b.ABORTED,"Document version changed between two reads.")}else this.A_.set(t.key.toString(),e)},t.prototype.Ge=function(t){var e=this.A_.get(t.toString());return!this.g_.has(t.toString())&&e?Qe.updateTime(e):Qe.ze()},t.prototype.b_=function(t){var e=this.A_.get(t.toString());if(!this.g_.has(t.toString())&&e){if(e.isEqual(B.min()))throw new l(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qe.updateTime(e)}return Qe.exists(!0)},t.prototype.write=function(t){this.V_(),this.mutations=this.mutations.concat(t)},t.prototype.V_=function(){},t}(),Cu=function(){function t(t,e,n,r){this.cs=t,this.qc=e,this.updateFunction=n,this.ls=r,this.v_=5,this.ys=new $n(this.cs,"transaction_retry")}return t.prototype.run=function(){this.S_()},t.prototype.S_=function(){var t=this;this.ys.Pn((function(){return Object(e.a)(t,void 0,void 0,(function(){var t,n,r=this;return Object(e.c)(this,(function(e){return t=new Ru(this.qc),(n=this.D_(t))&&n.then((function(e){r.cs.ws((function(){return t.commit().then((function(){r.ls.resolve(e)})).catch((function(t){r.C_(t)}))}))})).catch((function(t){r.C_(t)})),[2]}))}))}))},t.prototype.D_=function(t){try{var e=this.updateFunction(t);return!Q(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},t.prototype.C_=function(t){var e=this;this.v_>0&&this.N_(t)?(this.v_-=1,this.cs.ws((function(){return e.S_(),Promise.resolve()}))):this.ls.reject(t)},t.prototype.N_=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!st(e)}return!1},t}(),Vu=function(){function t(t,e,n){var r=this;this.credentials=t,this.cs=e,this.yl=n,this.user=Or.UNAUTHENTICATED,this.clientId=A.t(),this.x_=function(){},this.ui=new Jn,this.credentials.oi((function(t){y("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.x_(t)),r.ui.resolve()}))}return t.prototype.getConfiguration=function(){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(t){switch(t.label){case 0:return[4,this.ui.promise];case 1:return[2,(t.sent(),{cs:this.cs,yl:this.yl,clientId:this.clientId,credentials:this.credentials,ql:this.user,Dh:100})]}}))}))},t.prototype.F_=function(t){var e=this;this.x_=t,this.ui.promise.then((function(){return e.x_(e.user)}))},t.prototype.O_=function(){if(this.cs.ps)throw new l(b.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.cs.Ds();var n=new Jn;return this.cs.bs((function(){return Object(e.a)(t,void 0,void 0,(function(){var t,r;return Object(e.c)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),this.k_?[4,this.k_.terminate()]:[3,2];case 1:e.sent(),e.label=2;case 2:return this.M_?[4,this.M_.terminate()]:[3,4];case 3:e.sent(),e.label=4;case 4:return this.credentials.ai(),n.resolve(),[3,6];case 5:return t=e.sent(),r=pr(t,"Failed to shutdown persistence"),n.reject(r),[3,6];case 6:return[2]}}))}))})),n.promise},t}();function Uu(t,n){return Object(e.a)(this,void 0,void 0,(function(){var i,r=this;return Object(e.c)(this,(function(u){switch(u.label){case 0:return t.cs.Fs(),y("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return i=u.sent(),[4,n.initialize(i)];case 2:return u.sent(),t.F_((function(i){return t.cs.Cs((function(){return Object(e.a)(r,void 0,void 0,(function(){return Object(e.c)(this,(function(t){switch(t.label){case 0:return[4,Xi(n.Bc,i)];case 1:return t.sent(),[2]}}))}))}))})),n.persistence.ha((function(){return t.terminate()})),t.M_=n,[2]}}))}))}function qu(t,n){return Object(e.a)(this,void 0,void 0,(function(){var i,r;return Object(e.c)(this,(function(u){switch(u.label){case 0:return t.cs.Fs(),[4,Mu(t)];case 1:return i=u.sent(),y("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=u.sent(),[4,n.initialize(i,r)];case 3:return u.sent(),t.F_((function(i){return t.cs.Cs((function(){return function(t,n){return Object(e.a)(this,void 0,void 0,(function(){var r,i;return Object(e.c)(this,(function(e){switch(e.label){case 0:return(r=T(t)).cs.Fs(),y("RemoteStore","RemoteStore received new credentials"),i=Oo(r),r.Wc.add(3),[4,yo(r)];case 1:return e.sent(),i&&r.Hc.set("Unknown"),[4,r.Uc.Gl(n)];case 2:return e.sent(),r.Wc.delete(3),[4,vo(r)];case 3:return e.sent(),[2]}}))}))}(n.ph,i)}))})),t.k_=n,[2]}}))}))}function Mu(t){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(e){switch(e.label){case 0:return t.M_?[3,2]:(y("FirestoreClient","Using default OfflineComponentProvider"),[4,Uu(t,new Qs)]);case 1:e.sent(),e.label=2;case 2:return[2,t.M_]}}))}))}function Fu(t){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(e){switch(e.label){case 0:return t.k_?[3,2]:(y("FirestoreClient","Using default OnlineComponentProvider"),[4,qu(t,new Js)]);case 1:e.sent(),e.label=2;case 2:return[2,t.k_]}}))}))}function Bu(t){return Mu(t).then((function(t){return t.persistence}))}function Gu(t){return Mu(t).then((function(t){return t.Bc}))}function zu(t){return Fu(t).then((function(t){return t.ph}))}function Ku(t){return Fu(t).then((function(t){return t.mu}))}function Wu(t){return Object(e.a)(this,void 0,void 0,(function(){var n,r;return Object(e.c)(this,(function(e){switch(e.label){case 0:return[4,Fu(t)];case 1:return n=e.sent(),[2,((r=n.bh).Us=is.bind(null,n.mu),r.Ws=ss.bind(null,n.mu),r)]}}))}))}function Hu(t,n,i,r){var u=this,s=new $s(r),a=new Er(n,s,i);return t.cs.ws((function(){return Object(e.a)(u,void 0,void 0,(function(){var n;return Object(e.c)(this,(function(e){switch(e.label){case 0:return n=yr,[4,Wu(t)];case 1:return[2,n.apply(void 0,[e.sent(),a])]}}))}))})),function(){s.Hl(),t.cs.ws((function(){return Object(e.a)(u,void 0,void 0,(function(){var n;return Object(e.c)(this,(function(e){switch(e.label){case 0:return n=gr,[4,Wu(t)];case 1:return[2,n.apply(void 0,[e.sent(),a])]}}))}))}))}}function Qu(t,n){var i=this,r=new Jn;return t.cs.ws((function(){return Object(e.a)(i,void 0,void 0,(function(){var o;return Object(e.c)(this,(function(e){switch(e.label){case 0:return o=us,[4,Ku(t)];case 1:return[2,o.apply(void 0,[e.sent(),n,r])]}}))}))})),r.promise}function Yu(t,n){var i=this,r=new $s(n);return t.cs.ws((function(){return Object(e.a)(i,void 0,void 0,(function(){var n;return Object(e.c)(this,(function(e){switch(e.label){case 0:return n=function(t,e){T(t).qs.add(e),e.next()},[4,Wu(t)];case 1:return[2,n.apply(void 0,[e.sent(),r])]}}))}))})),function(){r.Hl(),t.cs.ws((function(){return Object(e.a)(i,void 0,void 0,(function(){var n;return Object(e.c)(this,(function(e){switch(e.label){case 0:return n=function(t,e){T(t).qs.delete(e)},[4,Wu(t)];case 1:return[2,n.apply(void 0,[e.sent(),r])]}}))}))}))}}function Xu(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Ju=function(){function t(t,e,n,r){this._=t,this.L_=e,this.B_=n,this.q_=r}return t.prototype.U_=function(t){switch(Ut(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Kt(t.integerValue||t.doubleValue);case 3:return this.K_(t.timestampValue);case 4:return this.Q_(t);case 5:return t.stringValue;case 6:return this.q_(Wt(t.bytesValue));case 7:return this.W_(t.referenceValue);case 8:return this.j_(t.geoPointValue);case 9:return this.G_(t.arrayValue);case 10:return this.z_(t.mapValue);default:throw E()}},t.prototype.z_=function(t){var e=this,n={};return V(t.fields||{},(function(t,r){n[t]=e.U_(r)})),n},t.prototype.j_=function(t){return new du(Kt(t.latitude),Kt(t.longitude))},t.prototype.G_=function(t){var e=this;return(t.values||[]).map((function(t){return e.U_(t)}))},t.prototype.Q_=function(t){switch(this.L_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return Rt(n)?t(n):n}(t);return null==e?null:this.U_(e);case"estimate":return this.K_(Ct(t));default:return null}},t.prototype.K_=function(t){var e=zt(t);return new F(e.seconds,e.nanos)},t.prototype.W_=function(t){var e=z.q(t);O(ke(e));var n=new R(e.get(1),e.get(3)),r=new H(e.N(5));return n.isEqual(this._)||m("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.B_(r)},t}(),$u=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new l(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new l(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,eu("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}();function Zu(t){na(t);var e=ua(t),n=t.H_(),r=new Js;return ta(e,r,new Xs(r,n.cacheSizeBytes))}function ta(t,n,i){var r=this,u=new Jn;return t.cs.enqueue((function(){return Object(e.a)(r,void 0,void 0,(function(){var r;return Object(e.c)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,Uu(t,i)];case 1:return e.sent(),[4,qu(t,n)];case 2:return e.sent(),u.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===b.FAILED_PRECONDITION||t.code===b.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=e.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),u.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return u.promise}))}function ea(t){var n=this;if(t.Y_&&!t.J_)throw new l(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var i=new Jn;return t.X_.bs((function(){return Object(e.a)(n,void 0,void 0,(function(){var n;return Object(e.c)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(e.a)(this,void 0,void 0,(function(){var n;return Object(e.c)(this,(function(e){switch(e.label){case 0:return hr.Ln()?(n=t+"main",[4,hr.delete(n)]):[2,Promise.resolve()];case 1:return e.sent(),[2]}}))}))}(Qi(t.c_,t.Z_))];case 1:return r.sent(),i.resolve(),[3,3];case 2:return n=r.sent(),i.reject(n),[3,3];case 3:return[2]}}))}))})),i.promise}function na(t){if(t.Y_||t.J_)throw new l(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var ra="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",ia=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){throw new l(b.FAILED_PRECONDITION,ra)},t.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new l(b.FAILED_PRECONDITION,ra)},t.prototype.clearIndexedDbPersistence=function(t){throw new l(b.FAILED_PRECONDITION,ra)},t}(),oa=function(){function t(){this.enableMultiTabIndexedDbPersistence=Zu.bind(null),this.clearIndexedDbPersistence=ea.bind(null)}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){na(t);var n=ua(t),r=t.H_(),i=new Js;return ta(n,i,new Ys(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t,{forceOwnership:e})},t}(),sa=function(){function t(n,i,r){var u=this;if(void 0===r&&(r=new ia),this.tf=r,this.ef=null,this.X_=new lr,this.INTERNAL={delete:function(){return Object(e.a)(u,void 0,void 0,(function(){return Object(e.c)(this,(function(t){switch(t.label){case 0:return this.nf||aa(this),[4,this.nf.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof n.options){var s=n;this.ef=s,this.c_=t.sf(s),this.Z_=s.name,this.if=new Ar(i)}else{var a=n;if(!a.projectId)throw new l(b.INVALID_ARGUMENT,"Must provide projectId");this.c_=new R(a.projectId,a.database),this.Z_="[DEFAULT]",this.if=new _r}this.rf=new $u({})}return Object.defineProperty(t.prototype,"Y_",{get:function(){return!!this.nf},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"J_",{get:function(){return this.X_.ps},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"af",{get:function(){return this.cf||(this.cf=new Eu(this.c_,this.rf.ignoreUndefinedProperties)),this.cf},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.rf),t)).merge;var e=new $u(t);if(this.nf&&!this.rf.isEqual(e))throw new l(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.rf=e,void 0!==e.credentials&&(this.if=function(t){if(!t)return new _r;switch(t.type){case"gapi":var e=t.client;return O(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Dr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new l(b.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.rf.host&&w("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},t.prototype.enableNetwork=function(){return ua(this),function(t){var n=this;return t.cs.enqueue((function(){return Object(e.a)(n,void 0,void 0,(function(){var n,r;return Object(e.c)(this,(function(e){switch(e.label){case 0:return[4,Bu(t)];case 1:return n=e.sent(),[4,zu(t)];case 2:return r=e.sent(),[2,(n.la(!0),function(t){var e=T(t);return e.Wc.delete(0),vo(e)}(r))]}}))}))}))}(this.nf)},t.prototype.disableNetwork=function(){return ua(this),function(t){var n=this;return t.cs.enqueue((function(){return Object(e.a)(n,void 0,void 0,(function(){var n,i;return Object(e.c)(this,(function(r){switch(r.label){case 0:return[4,Bu(t)];case 1:return n=r.sent(),[4,zu(t)];case 2:return i=r.sent(),[2,(n.la(!1),function(t){return Object(e.a)(this,void 0,void 0,(function(){var n;return Object(e.c)(this,(function(e){switch(e.label){case 0:return(n=T(t)).Wc.add(0),[4,yo(n)];case 1:return e.sent(),n.Hc.set("Offline"),[2]}}))}))}(i))]}}))}))}))}(this.nf)},t.prototype.enablePersistence=function(t){if(this.nf)throw new l(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1,n=!1;return t&&eu("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.tf.enableMultiTabIndexedDbPersistence(this):this.tf.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return Object(e.a)(this,void 0,void 0,(function(){return Object(e.c)(this,(function(t){return[2,this.tf.clearIndexedDbPersistence(this)]}))}))},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},t.prototype.waitForPendingWrites=function(){return ua(this),function(t){var n=this,i=new Jn;return t.cs.ws((function(){return Object(e.a)(n,void 0,void 0,(function(){var n;return Object(e.c)(this,(function(e){switch(e.label){case 0:return n=ps,[4,Ku(t)];case 1:return[2,n.apply(void 0,[e.sent(),i])]}}))}))})),i.promise}(this.nf)},t.prototype.onSnapshotsInSync=function(t){if(ua(this),Xu(t))return Yu(this.nf,t);var e={next:t};return Yu(this.nf,e)},t.sf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new l(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new l(b.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new R(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.ef)throw new l(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ef},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){return Zs("Firestore.collection","path",t),ua(this),new Ia(z.q(t),this,null)},t.prototype.doc=function(t){return Zs("Firestore.doc","path",t),ua(this),fa.uf(z.q(t),this,null)},t.prototype.collectionGroup=function(t){if(Zs("Firestore.collectionGroup","collectionId",t),t.indexOf("/")>=0)throw new l(b.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return ua(this),new ba(function(t){return new mn(z.U(),t)}(t),this,null)},t.prototype.runTransaction=function(t){var n=this;return function(t,n){var i=this,r=new Jn;return t.cs.ws((function(){return Object(e.a)(i,void 0,void 0,(function(){var o;return Object(e.c)(this,(function(e){switch(e.label){case 0:return[4,function(t){return Fu(t).then((function(t){return t.qc}))}(t)];case 1:return o=e.sent(),new Cu(t.cs,o,n,r).run(),[2]}}))}))})),r.promise}(ua(this),(function(e){return t(new ca(n,e))}))},t.prototype.batch=function(){return ua(this),new ha(this)},t.prototype.H_=function(){return this.rf},t}();function ua(t){return t.nf||aa(t),t.nf.O_(),t.nf}function aa(t){var e=t.H_(),n=function(t,e,n){return new L(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.c_,t.Z_,e);t.nf=new Vu(t.if,t.X_,n)}var ca=function(){function t(t,e){this.hf=t,this.lf=e}return t.prototype.get=function(t){var e=this,n=Ea("Transaction.get",t,this.hf);return this.lf.y_([n.u_]).then((function(t){if(!t||1!==t.length)return E();var r=t[0];if(r instanceof yn)return new pa(e.hf,n.u_,null,!1,!1,n.h_);if(r instanceof vn)return new pa(e.hf,n.u_,r,!1,!1,n.h_);throw E()}))},t.prototype.set=function(t,e,n){var r=Ea("Transaction.set",t,this.hf);n=tu("Transaction.set",n);var i=Ta(r.h_,e,n),o=Ou(this.hf.af,"Transaction.set",r.u_,i,null!==r.h_,n);return this.lf.set(r.u_,o),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],u=3;u<arguments.length;u++)o[u-3]=arguments[u];return"string"==typeof e||e instanceof ou?(r=Ea("Transaction.update",t,this.hf),i=_u(this.hf.af,"Transaction.update",r.u_,e,n,o)):(r=Ea("Transaction.update",t,this.hf),i=Tu(this.hf.af,"Transaction.update",r.u_,e)),this.lf.update(r.u_,i),this},t.prototype.delete=function(t){var e=Ea("Transaction.delete",t,this.hf);return this.lf.delete(e.u_),this},t}(),ha=function(){function t(t){this.hf=t,this._f=[],this.ff=!1}return t.prototype.set=function(t,e,n){this.df();var r=Ea("WriteBatch.set",t,this.hf);n=tu("WriteBatch.set",n);var i=Ta(r.h_,e,n),o=Ou(this.hf.af,"WriteBatch.set",r.u_,i,null!==r.h_,n);return this._f=this._f.concat(o.l_(r.u_,Qe.ze())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],u=3;u<arguments.length;u++)o[u-3]=arguments[u];return this.df(),"string"==typeof e||e instanceof ou?(r=Ea("WriteBatch.update",t,this.hf),i=_u(this.hf.af,"WriteBatch.update",r.u_,e,n,o)):(r=Ea("WriteBatch.update",t,this.hf),i=Tu(this.hf.af,"WriteBatch.update",r.u_,e)),this._f=this._f.concat(i.l_(r.u_,Qe.exists(!0))),this},t.prototype.delete=function(t){this.df();var e=Ea("WriteBatch.delete",t,this.hf);return this._f=this._f.concat(new cn(e.u_,Qe.ze())),this},t.prototype.commit=function(){return this.df(),this.ff=!0,this._f.length>0?Qu(ua(this.hf),this._f):Promise.resolve()},t.prototype.df=function(){if(this.ff)throw new l(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),fa=function(t){function i(e,n,r){var i=this;return(i=t.call(this,n.c_,e,r)||this).u_=e,i.firestore=n,i.h_=r,i.nf=ua(n),i}return Object(e.b)(i,t),i.uf=function(t,e,n){if(t.length%2!=0)throw new l(b.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.B()+" has "+t.length);return new i(new H(t),e,n)},Object.defineProperty(i.prototype,"id",{get:function(){return this.u_.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return new Ia(this.u_.path.F(),this.firestore,this.h_)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"path",{get:function(){return this.u_.path.B()},enumerable:!1,configurable:!0}),i.prototype.collection=function(t){if(Zs("DocumentReference.collection","path",t),!t)throw new l(b.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=z.q(t);return new Ia(this.u_.path.child(e),this.firestore,null)},i.prototype.isEqual=function(t){return t instanceof i&&this.firestore===t.firestore&&this.u_.isEqual(t.u_)&&this.h_===t.h_},i.prototype.set=function(t,e){e=tu("DocumentReference.set",e);var n=Ta(this.h_,t,e),r=Ou(this.firestore.af,"DocumentReference.set",this.u_,n,null!==this.h_,e);return Qu(this.nf,r.l_(this.u_,Qe.ze()))},i.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof ou?_u(this.firestore.af,"DocumentReference.update",this.u_,t,e,r):Tu(this.firestore.af,"DocumentReference.update",this.u_,t),Qu(this.nf,n.l_(this.u_,Qe.exists(!0)))},i.prototype.delete=function(){return Qu(this.nf,[new cn(this.u_,Qe.ze())])},i.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var u={includeMetadataChanges:!1},s=0;"object"!=typeof i[s]||Xu(i[s])||(u=i[s],s++);var a={includeMetadataChanges:u.includeMetadataChanges};if(Xu(i[s])){var c=i[s];i[s]=null===(t=c.next)||void 0===t?void 0:t.bind(c),i[s+1]=null===(e=c.error)||void 0===e?void 0:e.bind(c),i[s+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}var h={next:function(t){i[s]&&i[s](r.wf(t))},error:i[s+1],complete:i[s+2]};return Hu(this.nf,wn(this.u_.path),a,h)},i.prototype.get=function(t){var n=this;return t&&"cache"===t.source?function(t,n){var i=this,r=new Jn;return t.cs.ws((function(){return Object(e.a)(i,void 0,void 0,(function(){var i;return Object(e.c)(this,(function(u){switch(u.label){case 0:return i=function(t,n,i){return Object(e.a)(this,void 0,void 0,(function(){var r,o,u;return Object(e.c)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,function(t,e){var n=T(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Ka.Mi(t,e)}))}(t,n)];case 1:return(r=e.sent())instanceof vn?i.resolve(r):r instanceof yn?i.resolve(null):i.reject(new l(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return o=e.sent(),u=pr(o,"Failed to get document '"+n+" from cache"),i.reject(u),[3,3];case 3:return[2]}}))}))},[4,Gu(t)];case 1:return[2,i.apply(void 0,[u.sent(),n,r])]}}))}))})),r.promise}(this.nf,this.u_).then((function(t){return new pa(n.firestore,n.u_,t,!0,t instanceof vn&&t.Je,n.h_)})):function(t,n,i){var r=this;void 0===i&&(i={});var u=new Jn;return t.cs.ws((function(){return Object(e.a)(r,void 0,void 0,(function(){var r;return Object(e.c)(this,(function(e){switch(e.label){case 0:return r=function(t,e,n,r,i){var o=new $s({next:function(o){e.ws((function(){return gr(t,u)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new l(b.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new l(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),u=new Er(wn(n.path),o,{includeMetadataChanges:!0,Xs:!0});return yr(t,u)},[4,Wu(t)];case 1:return[2,r.apply(void 0,[e.sent(),t.cs,n,i,u])]}}))}))})),u.promise}(this.nf,this.u_,t).then((function(t){return n.wf(t)}))},i.prototype.withConverter=function(t){return new i(this.u_,this.firestore,t)},i.prototype.wf=function(t){var e=t.docs.get(this.u_);return new pa(this.firestore,this.u_,e,t.fromCache,t.hasPendingWrites,this.h_)},i}(gu),la=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),pa=function(){function t(t,e,n,r,i,o){this.hf=t,this.u_=e,this.Ef=n,this.Tf=r,this.If=i,this.h_=o}return t.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.Ef){if(this.h_){var n=new da(this.hf,this.u_,this.Ef,this.Tf,this.If,null);return this.h_.fromFirestore(n,t)}return new Ju(this.hf.c_,t.serverTimestamps||"none",(function(t){return new fa(t,e.hf,null)}),(function(t){return new P(t)})).U_(this.Ef.rn())}},t.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.Ef){var r=this.Ef.data().field(xu("DocumentSnapshot.get",t,this.u_));if(null!==r)return new Ju(this.hf.c_,e.serverTimestamps||"none",(function(t){return new fa(t,n.hf,n.h_)}),(function(t){return new P(t)})).U_(r)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.u_.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new fa(this.u_,this.hf,this.h_)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.Ef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new la(this.If,this.Tf)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&this.hf===e.hf&&this.Tf===e.Tf&&this.u_.isEqual(e.u_)&&(null===this.Ef?null===e.Ef:this.Ef.isEqual(e.Ef))&&this.h_===e.h_},t}(),da=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Object(e.b)(n,t),n.prototype.data=function(e){return t.prototype.data.call(this,e)},n}(pa);function va(t,e,n){if("string"==typeof n){if(""===n)throw new l(b.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!_n(e)&&-1!==n.indexOf("/"))throw new l(b.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(z.q(n));if(!H.X(r))throw new l(b.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ht(t,new H(r))}if(n instanceof gu)return Ht(t,n.u_);throw new l(b.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+nu(n)+".")}function ya(t,e){if(!Array.isArray(t)||0===t.length)throw new l(b.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new l(b.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function ga(t,e,n){if(!n.isEqual(e))throw new l(b.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ma(t){if(En(t)&&0===t.on.length)throw new l(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ba=function(){function t(t,e,n){this.mf=t,this.firestore=e,this.h_=n}return t.prototype.where=function(e,n,r){var i=xu("Query.where",e),o=function(t,e,n,r,i,o,u){var s;if(i.W()){if("array-contains"===o||"array-contains-any"===o)throw new l(b.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){ya(u,o);for(var a=[],c=0,h=u;c<h.length;c++){var f=h[c];a.push(va(r,t,f))}s={arrayValue:{values:a}}}else s=va(r,t,u)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||ya(u,o),s=Au(n,"Query.where",u,"in"===o||"not-in"===o);var d=Cn.create(i,o,s);return function(t,e){if(e.hn()){var n=Tn(t);if(null!==n&&!n.isEqual(e.field))throw new l(b.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=On(t);null!==r&&ga(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new l(b.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new l(b.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,d),d}(this.mf,0,this.firestore.af,this.firestore.c_,i,n,r);return new t(function(t,e){var n=t.filters.concat([e]);return new mn(t.path,t.collectionGroup,t.on.slice(),n,t.limit,t.an,t.startAt,t.endAt)}(this.mf,o),this.firestore,this.h_)},t.prototype.orderBy=function(e,n){var r;if(void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new l(b.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}var i=xu("Query.orderBy",e),o=function(t,e,n){if(null!==t.startAt)throw new l(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new l(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Qn(e,n);return function(t,e){if(null===On(t)){var n=Tn(t);null!==n&&ga(0,n,e.field)}}(t,r),r}(this.mf,i,r);return new t(function(t,e){var n=t.on.concat([e]);return new mn(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.an,t.startAt,t.endAt)}(this.mf,o),this.firestore,this.h_)},t.prototype.limit=function(e){return ru("Query.limit",e),new t(Dn(this.mf,e,"F"),this.firestore,this.h_)},t.prototype.limitToLast=function(e){return ru("Query.limitToLast",e),new t(Dn(this.mf,e,"L"),this.firestore,this.h_)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Af("Query.startAt",e,n,!0);return new t(jn(this.mf,i),this.firestore,this.h_)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Af("Query.startAfter",e,n,!1);return new t(jn(this.mf,i),this.firestore,this.h_)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Af("Query.endBefore",e,n,!0);return new t(Sn(this.mf,i),this.firestore,this.h_)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Af("Query.endAt",e,n,!1);return new t(Sn(this.mf,i),this.firestore,this.h_)},t.prototype.isEqual=function(e){return e instanceof t&&this.firestore===e.firestore&&xn(this.mf,e.mf)&&this.h_===e.h_},t.prototype.withConverter=function(e){return new t(this.mf,this.firestore,e)},t.prototype.Af=function(t,e,n,r){if(e instanceof pa)return function(t,e,n,r,i){if(!r)throw new l(b.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],u=0,s=An(t);u<s.length;u++){var a=s[u];if(a.field.W())o.push(Ht(e,r.key));else{var c=r.field(a.field);if(Rt(c))throw new l(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.B();throw new l(b.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new tr(o,i)}(this.mf,this.firestore.c_,t,e.Ef,r);var i=[e].concat(n);return function(t,e,n,r,i,o){var u=t.on;if(i.length>u.length)throw new l(b.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],a=0;a<i.length;a++){var c=i[a];if(u[a].field.W()){if("string"!=typeof c)throw new l(b.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!_n(t)&&-1!==c.indexOf("/"))throw new l(b.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(z.q(c));if(!H.X(h))throw new l(b.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new H(h);s.push(Ht(e,f))}else{var d=Au(n,r,c);s.push(d)}}return new tr(s,o)}(this.mf,this.firestore.c_,this.firestore.af,t,i,r)},t.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var u={},s=0;if("object"!=typeof i[s]||Xu(i[s])||(u=i[s],s++),Xu(i[s])){var a=i[s];i[s]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[s+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[s+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)}var c={next:function(t){i[s]&&i[s](new wa(r.firestore,r.mf,t,r.h_))},error:i[s+1],complete:i[s+2]};return ma(this.mf),Hu(ua(this.firestore),this.mf,u,c)},t.prototype.get=function(t){var n=this;ma(this.mf);var i=ua(this.firestore);return(t&&"cache"===t.source?function(t,n){var i=this,r=new Jn;return t.cs.ws((function(){return Object(e.a)(i,void 0,void 0,(function(){var i;return Object(e.c)(this,(function(u){switch(u.label){case 0:return i=function(t,n,i){return Object(e.a)(this,void 0,void 0,(function(){var r,o,u,s,a,c;return Object(e.c)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,ro(t,n,!0)];case 1:return r=e.sent(),o=new ts(n,r.za),u=o.wh(r.documents),s=o.Di(u,!1),i.resolve(s.snapshot),[3,3];case 2:return a=e.sent(),c=pr(a,"Failed to execute query '"+n+" against cache"),i.reject(c),[3,3];case 3:return[2]}}))}))},[4,Gu(t)];case 1:return[2,i.apply(void 0,[u.sent(),n,r])]}}))}))})),r.promise}(i,this.mf):function(t,n,i){var r=this;void 0===i&&(i={});var u=new Jn;return t.cs.ws((function(){return Object(e.a)(r,void 0,void 0,(function(){var r;return Object(e.c)(this,(function(e){switch(e.label){case 0:return r=function(t,e,n,r,i){var o=new $s({next:function(n){e.ws((function(){return gr(t,u)})),n.fromCache&&"server"===r.source?i.reject(new l(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),u=new Er(n,o,{includeMetadataChanges:!0,Xs:!0});return yr(t,u)},[4,Wu(t)];case 1:return[2,r.apply(void 0,[e.sent(),t.cs,n,i,u])]}}))}))})),u.promise}(i,this.mf,t)).then((function(t){return new wa(n.firestore,n.mf,t,n.h_)}))},t}(),wa=function(){function t(t,e,n,r){this.hf=t,this.Rf=e,this.Pf=n,this.h_=r,this.gf=null,this.yf=null,this.metadata=new la(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.Pf.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Pf.docs.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.Pf.docs.forEach((function(r){t.call(e,n.Vf(r,n.metadata.fromCache,n.Pf.Qt.has(r.key)))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new ba(this.Rf,this.hf,this.h_)},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=!(!t||!t.includeMetadataChanges);if(e&&this.Pf.jt)throw new l(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.gf&&this.yf===e||(this.gf=function(t,e,n){if(t.Kt.P()){var r=0;return t.docChanges.map((function(e){var i=n(e.doc,t.fromCache,t.Qt.has(e.doc.key));return e.doc,{type:"added",doc:i,oldIndex:-1,newIndex:r++}}))}var i=t.Kt;return t.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var r=n(e.doc,t.fromCache,t.Qt.has(e.doc.key)),o=-1,u=-1;return 0!==e.type&&(o=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(u=(i=i.add(e.doc)).indexOf(e.doc.key)),{type:Oa(e.type),doc:r,oldIndex:o,newIndex:u}}))}(this.Pf,e,this.Vf.bind(this)),this.yf=e),this.gf},t.prototype.isEqual=function(e){return e instanceof t&&this.hf===e.hf&&xn(this.Rf,e.Rf)&&this.Pf.isEqual(e.Pf)&&this.h_===e.h_},t.prototype.Vf=function(t,e,n){return new da(this.hf,t.key,t,e,n,this.h_)},t}(),Ia=function(t){function n(e,n,r){var i=this;if((i=t.call(this,wn(e),n,r)||this).pf=e,e.length%2!=1)throw new l(b.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.B()+" has "+e.length);return i}return Object(e.b)(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return this.mf.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){var t=this.mf.path.F();return t.P()?null:new fa(new H(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this.mf.path.B()},enumerable:!1,configurable:!0}),n.prototype.doc=function(t){0===arguments.length&&(t=A.t()),Zs("CollectionReference.doc","path",t);var e=z.q(t);return fa.uf(this.mf.path.child(e),this.firestore,this.h_)},n.prototype.add=function(t){var e=this.h_?this.h_.toFirestore(t):t,n=this.doc();return new fa(n.u_,this.firestore,null).set(e).then((function(){return n}))},n.prototype.withConverter=function(t){return new n(this.pf,this.firestore,t)},n}(ba);function Ea(t,e,n){var r=function(t,e){if(!(t instanceof e)){if(e.name===t.constructor.name)throw new l(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=nu(t);throw new l(b.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}(e,fa);if(r.firestore!==n)throw new l(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}function Oa(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return E()}}function Ta(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var _a,Aa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Object(e.b)(n,t),n.serverTimestamp=function(){var t=new hu("serverTimestamp");return t.Jl="FieldValue.serverTimestamp",new n(t)},n.delete=function(){var t=new au("deleteField");return t.Jl="FieldValue.delete",new n(t)},n.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new fu("arrayUnion",t)}.apply(void 0,t);return r.Jl="FieldValue.arrayUnion",new n(r)},n.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new lu("arrayRemove",t)}.apply(void 0,t);return r.Jl="FieldValue.arrayRemove",new n(r)},n.increment=function(t){var e=function(t){return new pu("increment",t)}(t);return e.Jl="FieldValue.increment",new n(e)},n.prototype.isEqual=function(t){return this.a_.isEqual(t.a_)},n}(vu),Na={Firestore:sa,GeoPoint:du,Timestamp:F,Blob:P,Transaction:ca,WriteBatch:ha,DocumentReference:fa,DocumentSnapshot:pa,Query:ba,QueryDocumentSnapshot:da,QuerySnapshot:wa,CollectionReference:Ia,FieldPath:ou,FieldValue:Aa,setLogLevel:function(t){var e;e=t,d.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new f.a("firestore",(function(t){return function(t,e){return new sa(t,e,new oa)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Na)))})(_a=r.a),_a.registerVersion("@firebase/firestore","2.0.1")}).call(this,n(146))},977:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return or})),n.d(e,"b",(function(){return sr})),n.d(e,"c",(function(){return ur})),n.d(e,"d",(function(){return ar})),n.d(e,"e",(function(){return ir}));var r=function(t,b){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(t[p]=b[p])})(t,b)};function o(t){var s="function"==typeof Symbol&&Symbol.iterator,e=s&&t[s],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}var g,c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},h=h||{},f=c||self;function l(){}function d(a){var b=typeof a;return"object"!=b?b:a?Array.isArray(a)?"array":b:"null"}function v(a){var b=d(a);return"array"==b||"object"==b&&"number"==typeof a.length}function y(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var m="closure_uid_"+(1e9*Math.random()>>>0),w=0;function I(a,b,t){return a.call.apply(a.bind,arguments)}function E(a,b,t){if(!a)throw Error();if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,e),a.apply(b,t)}}return function(){return a.apply(b,arguments)}}function p(a,b,t){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?I:E).apply(null,arguments)}function O(a,b){var t=Array.prototype.slice.call(arguments,1);return function(){var e=t.slice();return e.push.apply(e,arguments),a.apply(this,e)}}var q=Date.now;function T(a,b){function t(){}t.prototype=b.prototype,a.S=b.prototype,a.prototype=new t,a.prototype.constructor=a}function u(){this.j=this.j,this.i=this.i}u.prototype.j=!1,u.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0))(function(a){Object.prototype.hasOwnProperty.call(a,m)&&a[m]||(a[m]=++w)})(this)},u.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var _=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"==typeof a)return"string"!=typeof b||1!=b.length?-1:a.indexOf(b,0);for(var t=0;t<a.length;t++)if(t in a&&a[t]===b)return t;return-1},A=Array.prototype.forEach?function(a,b,t){Array.prototype.forEach.call(a,b,t)}:function(a,b,t){for(var e=a.length,n="string"==typeof a?a.split(""):a,r=0;r<e;r++)r in n&&b.call(t,n[r],r,a)};function N(a){return Array.prototype.concat.apply([],arguments)}function D(a){var b=a.length;if(0<b){for(var t=Array(b),e=0;e<b;e++)t[e]=a[e];return t}return[]}function j(a){return/^[\s\xa0]*$/.test(a)}var S,x=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1]};function k(a,b){return-1!=a.indexOf(b)}function P(a,b){return a<b?-1:a>b?1:0}t:{var L=f.navigator;if(L){var R=L.userAgent;if(R){S=R;break t}}S=""}function C(a,b,t){for(var e in a)b.call(t,a[e],e,a)}function V(a){var b={};for(var t in a)b[t]=a[t];return b}var U="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(a,b){for(var t,e,n=1;n<arguments.length;n++){for(t in e=arguments[n])a[t]=e[t];for(var r=0;r<U.length;r++)t=U[r],Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=e[t])}}function F(a){return F[" "](a),a}F[" "]=l;var B,a,G=k(S,"Opera"),z=k(S,"Trident")||k(S,"MSIE"),K=k(S,"Edge"),W=K||z,H=k(S,"Gecko")&&!(k(S.toLowerCase(),"webkit")&&!k(S,"Edge"))&&!(k(S,"Trident")||k(S,"MSIE"))&&!k(S,"Edge"),Q=k(S.toLowerCase(),"webkit")&&!k(S,"Edge");function Y(){var a=f.document;return a?a.documentMode:void 0}t:{var X="",J=(a=S,H?/rv:([^\);]+)(\)|;)/.exec(a):K?/Edge\/([\d\.]+)/.exec(a):z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a):Q?/WebKit\/(\S+)/.exec(a):G?/(?:Version)[ \/]?(\S+)/.exec(a):void 0);if(J&&(X=J?J[1]:""),z){var $=Y();if(null!=$&&$>parseFloat(X)){B=String($);break t}}B=X}var Z,tt={};function et(a){return function(a,b){var t=tt;return Object.prototype.hasOwnProperty.call(t,a)?t[a]:t[a]=b(a)}(a,(function(){for(var b=0,t=x(String(B)).split("."),e=x(String(a)).split("."),n=Math.max(t.length,e.length),r=0;0==b&&r<n;r++){var o=t[r]||"",c=e[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],c=/(\d*)(\D*)(.*)/.exec(c)||["","","",""],0==o[0].length&&0==c[0].length)break;b=P(0==o[1].length?0:parseInt(o[1],10),0==c[1].length?0:parseInt(c[1],10))||P(0==o[2].length,0==c[2].length)||P(o[2],c[2]),o=o[3],c=c[3]}while(0==b)}return 0<=b}))}if(f.document&&z){var nt=Y();Z=nt||(parseInt(B,10)||void 0)}else Z=void 0;var it=Z,ot=!z||9<=Number(it),st=z&&!et("9"),ut=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{f.addEventListener("test",l,b),f.removeEventListener("test",l,b)}catch(t){}return a}();function at(a,b){this.type=a,this.a=this.target=b,this.defaultPrevented=!1}function ct(a,b){if(at.call(this,a?a.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,a){var t=this.type=a.type,e=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.a=b,b=a.relatedTarget){if(H){t:{try{F(b.nodeName);var n=!0;break t}catch(t){}n=!1}n||(b=null)}}else"mouseover"==t?b=a.fromElement:"mouseout"==t&&(b=a.toElement);this.relatedTarget=b,e?(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType="string"==typeof a.pointerType?a.pointerType:ht[a.pointerType]||"",this.c=a,a.defaultPrevented&&this.b()}}at.prototype.b=function(){this.defaultPrevented=!0},T(ct,at);var ht={2:"touch",3:"pen",4:"mouse"};ct.prototype.b=function(){ct.S.b.call(this);var a=this.c;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,st)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(t){}};var ft="closure_listenable_"+(1e6*Math.random()|0),lt=0;function pt(a,b,t,e,n){this.listener=a,this.proxy=null,this.src=b,this.type=t,this.capture=!!e,this.ca=n,this.key=++lt,this.Y=this.Z=!1}function vt(a){a.Y=!0,a.listener=null,a.proxy=null,a.src=null,a.ca=null}function yt(a){this.src=a,this.a={},this.b=0}function gt(a,b){var t=b.type;if(t in a.a){var e,n=a.a[t],r=_(n,b);(e=0<=r)&&Array.prototype.splice.call(n,r,1),e&&(vt(b),0==a.a[t].length&&(delete a.a[t],a.b--))}}function mt(a,b,t,e){for(var n=0;n<a.length;++n){var r=a[n];if(!r.Y&&r.listener==b&&r.capture==!!t&&r.ca==e)return n}return-1}yt.prototype.add=function(a,b,t,e,n){var r=a.toString();(a=this.a[r])||(a=this.a[r]=[],this.b++);var o=mt(a,b,e,n);return-1<o?(b=a[o],t||(b.Z=!1)):((b=new pt(b,this.src,r,!!e,n)).Z=t,a.push(b)),b};var bt="closure_lm_"+(1e6*Math.random()|0),wt={};function It(a,b,t,e,n){if(e&&e.once)return function t(a,b,e,n,r){if(Array.isArray(b)){for(var o=0;o<b.length;o++)t(a,b[o],e,n,r);return null}return e=jt(e),a&&a[ft]?a.wa(b,e,y(n)?!!n.capture:!!n,r):Et(a,b,e,!0,n,r)}(a,b,t,e,n);if(Array.isArray(b)){for(var r=0;r<b.length;r++)It(a,b[r],t,e,n);return null}return t=jt(t),a&&a[ft]?a.va(b,t,y(e)?!!e.capture:!!e,n):Et(a,b,t,!1,e,n)}function Et(a,b,t,e,n,r){if(!b)throw Error("Invalid event type");var o=y(n)?!!n.capture:!!n;if(o&&!ot)return null;var c=Nt(a);if(c||(a[bt]=c=new yt(a)),(t=c.add(b,t,e,o,r)).proxy)return t;if(e=function(){var a=At,b=ot?function(t){return a.call(b.src,b.listener,t)}:function(t){if(!(t=a.call(b.src,b.listener,t)))return t};return b}(),t.proxy=e,e.src=a,e.listener=t,a.addEventListener)ut||(n=o),void 0===n&&(n=!1),a.addEventListener(b.toString(),e,n);else if(a.attachEvent)a.attachEvent(Tt(b.toString()),e);else{if(!a.addListener||!a.removeListener)throw Error("addEventListener and attachEvent are unavailable.");a.addListener(e)}return t}function Ot(a){if("number"!=typeof a&&a&&!a.Y){var b=a.src;if(b&&b[ft])gt(b.c,a);else{var t=a.type,e=a.proxy;b.removeEventListener?b.removeEventListener(t,e,a.capture):b.detachEvent?b.detachEvent(Tt(t),e):b.addListener&&b.removeListener&&b.removeListener(e),(t=Nt(b))?(gt(t,a),0==t.b&&(t.src=null,b[bt]=null)):vt(a)}}}function Tt(a){return a in wt?wt[a]:wt[a]="on"+a}function _t(a,b){var t=a.listener,e=a.ca||a.src;return a.Z&&Ot(a),t.call(e,b)}function At(a,b){if(a.Y)return!0;if(!ot){if(!b)t:{b=["window","event"];for(var t=f,e=0;e<b.length;e++)if(null==(t=t[b[e]])){b=null;break t}b=t}return _t(a,b=new ct(b,this))}return _t(a,new ct(b,this))}function Nt(a){return(a=a[bt])instanceof yt?a:null}var Dt="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(a){return"function"==d(a)?a:(a[Dt]||(a[Dt]=function(b){return a.handleEvent(b)}),a[Dt])}function St(){u.call(this),this.c=new yt(this),this.J=this,this.C=null}function xt(a,b,t,e){if(!(b=a.c.a[String(b)]))return!0;b=b.concat();for(var n=!0,r=0;r<b.length;++r){var o=b[r];if(o&&!o.Y&&o.capture==t){var c=o.listener,h=o.ca||o.src;o.Z&&gt(a.c,o),n=!1!==c.call(h,e)&&n}}return n&&!e.defaultPrevented}T(St,u),St.prototype[ft]=!0,(g=St.prototype).addEventListener=function(a,b,t,e){It(this,a,b,t,e)},g.removeEventListener=function(a,b,t,e){!function t(a,b,e,n,r){if(Array.isArray(b))for(var o=0;o<b.length;o++)t(a,b[o],e,n,r);else n=y(n)?!!n.capture:!!n,e=jt(e),a&&a[ft]?(a=a.c,(b=String(b).toString())in a.a&&(-1<(e=mt(o=a.a[b],e,n,r))&&(vt(o[e]),Array.prototype.splice.call(o,e,1),0==o.length&&(delete a.a[b],a.b--)))):a&&(a=Nt(a))&&(b=a.a[b.toString()],a=-1,b&&(a=mt(b,e,n,r)),(e=-1<a?b[a]:null)&&Ot(e))}(this,a,b,t,e)},g.dispatchEvent=function(a){var b,t=this.C;if(t)for(b=[];t;t=t.C)b.push(t);t=this.J;var e=a.type||a;if("string"==typeof a)a=new at(a,t);else if(a instanceof at)a.target=a.target||t;else{var n=a;M(a=new at(e,t),n)}if(n=!0,b)for(var r=b.length-1;0<=r;r--){var o=a.a=b[r];n=xt(o,e,!0,a)&&n}if(n=xt(o=a.a=t,e,!0,a)&&n,n=xt(o,e,!1,a)&&n,b)for(r=0;r<b.length;r++)n=xt(o=a.a=b[r],e,!1,a)&&n;return n},g.G=function(){if(St.S.G.call(this),this.c){var t,a=this.c;for(t in a.a){for(var e=a.a[t],n=0;n<e.length;n++)vt(e[n]);delete a.a[t],a.b--}}this.C=null},g.va=function(a,b,t,e){return this.c.add(String(a),b,!1,t,e)},g.wa=function(a,b,t,e){return this.c.add(String(a),b,!0,t,e)};var kt=f.JSON.stringify;function Pt(){this.b=this.a=null}var Lt,Rt=new(function(){function t(a,b,t){this.f=t,this.c=a,this.g=b,this.b=0,this.a=null}return t.prototype.get=function(){var a;return 0<this.b?(this.b--,a=this.a,this.a=a.next,a.next=null):a=this.c(),a},t}())((function(){return new Vt}),(function(a){a.reset()}),100);function Ct(){var a=Ft,b=null;return a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null),b}function Vt(){this.next=this.b=this.a=null}function Ut(a){f.setTimeout((function(){throw a}),0)}function qt(a,b){Lt||function(){var a=f.Promise.resolve(void 0);Lt=function(){a.then(Bt)}}(),Mt||(Lt(),Mt=!0),Ft.add(a,b)}Pt.prototype.add=function(a,b){var t=Rt.get();t.set(a,b),this.b?this.b.next=t:this.a=t,this.b=t},Vt.prototype.set=function(a,b){this.a=a,this.b=b,this.next=null},Vt.prototype.reset=function(){this.next=this.b=this.a=null};var Mt=!1,Ft=new Pt;function Bt(){for(var a;a=Ct();){try{a.a.call(a.b)}catch(t){Ut(t)}var b=Rt;b.g(a),b.b<b.f&&(b.b++,a.next=b.a,b.a=a)}Mt=!1}function Gt(a,b){St.call(this),this.b=a||1,this.a=b||f,this.f=p(this.Ya,this),this.g=q()}function zt(a){a.aa=!1,a.M&&(a.a.clearTimeout(a.M),a.M=null)}function Kt(a,b,t){if("function"==d(a))t&&(a=p(a,t));else{if(!a||"function"!=typeof a.handleEvent)throw Error("Invalid listener argument");a=p(a.handleEvent,a)}return 2147483647<Number(b)?-1:f.setTimeout(a,b||0)}function Wt(a){a.a=Kt((function(){a.a=null,a.c&&(a.c=!1,Wt(a))}),a.h);var b=a.b;a.b=null,a.g.apply(null,b)}T(Gt,St),(g=Gt.prototype).aa=!1,g.M=null,g.Ya=function(){if(this.aa){var a=q()-this.g;0<a&&a<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-a):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(zt(this),this.start()))}},g.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},g.G=function(){Gt.S.G.call(this),zt(this),delete this.a};var Ht=function(t){function e(a,b,e){var n=t.call(this)||this;return n.g=null!=e?a.bind(e):a,n.h=b,n.b=null,n.c=!1,n.a=null,n}return function(t,b){function e(){this.constructor=t}r(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}(e,t),e.prototype.f=function(a){this.b=arguments,this.a?this.c=!0:Wt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(f.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(u);function Qt(a){u.call(this),this.b=a,this.a={}}T(Qt,u);var Yt=[];function Xt(a,b,t,e){Array.isArray(t)||(t&&(Yt[0]=t.toString()),t=Yt);for(var n=0;n<t.length;n++){var r=It(b,t[n],e||a.handleEvent,!1,a.b||a);if(!r)break;a.a[r.key]=r}}function Jt(a){C(a.a,(function(b,t){this.a.hasOwnProperty(t)&&Ot(b)}),a),a.a={}}function $t(){this.a=!0}function Zt(a,b,t,e){a.info((function(){return"XMLHTTP TEXT ("+b+"): "+function(a,b){if(!a.a)return b;if(!b)return null;try{var t=JSON.parse(b);if(t)for(a=0;a<t.length;a++)if(Array.isArray(t[a])){var e=t[a];if(!(2>e.length)){var n=e[1];if(Array.isArray(n)&&!(1>n.length)){var r=n[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<n.length;o++)n[o]=""}}}return kt(t)}catch(t){return b}}(a,t)+(e?" "+e:"")}))}Qt.prototype.G=function(){Qt.S.G.call(this),Jt(this)},Qt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},$t.prototype.info=function(){};var te=null;function ee(){return te=te||new St}function ne(a){at.call(this,"serverreachability",a)}function re(a){var b=ee();b.dispatchEvent(new ne(b,a))}function ie(a){at.call(this,"statevent",a)}function oe(a){var b=ee();b.dispatchEvent(new ie(b,a))}function se(a){at.call(this,"timingevent",a)}function ue(a,b){if("function"!=d(a))throw Error("Fn must not be null and must be a function");return f.setTimeout((function(){a()}),b)}T(ne,at),T(ie,at),T(se,at);var ae={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},ce={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function he(){}function fe(a){var b;return(b=a.a)||(b=a.a={}),b}function le(){}he.prototype.a=null;var pe,de={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function ve(){at.call(this,"d")}function ye(){at.call(this,"c")}function ge(){}function me(a,b,t,e){this.g=a,this.c=b,this.f=t,this.T=e||1,this.J=new Qt(this),this.P=be,a=W?125:void 0,this.R=new Gt(a),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}T(ve,at),T(ye,at),T(ge,he),pe=new ge;var be=45e3,we={},Ie={};function Ee(a,b,t){a.H=1,a.i=ze(Ue(b)),a.j=t,a.I=!0,Oe(a,null)}function Oe(a,b){a.u=q(),Ae(a),a.l=Ue(a.i);var t=a.l,e=a.T;Array.isArray(e)||(e=[String(e)]),nn(t.b,"t",e),a.D=0,a.a=Xn(a.g,a.g.C?b:null),0<a.O&&(a.F=new Ht(p(a.Ca,a,a.a),a.O)),Xt(a.J,a.a,"readystatechange",a.Wa),b=a.B?V(a.B):{},a.j?(a.m||(a.m="POST"),b["Content-Type"]="application/x-www-form-urlencoded",a.a.ba(a.l,a.m,a.j,b)):(a.m="GET",a.a.ba(a.l,a.m,null,b)),re(1),function(a,b,t,e,n,r){a.info((function(){if(a.a)if(r)for(var o="",c=r.split("&"),h=0;h<c.length;h++){var f=c[h].split("=");if(1<f.length){var l=f[0];f=f[1];var d=l.split("_");o=2<=d.length&&"type"==d[1]?o+(l+"=")+f+"&":o+(l+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+e+") [attempt "+n+"]: "+b+"\n"+t+"\n"+o}))}(a.c,a.m,a.l,a.f,a.T,a.j)}function Te(a,b,t){for(var e=!0;!a.A&&a.D<t.length;){var n=_e(a,t);if(n==Ie){4==b&&(a.h=4,oe(14),e=!1),Zt(a.c,a.f,null,"[Incomplete Response]");break}if(n==we){a.h=4,oe(15),Zt(a.c,a.f,t,"[Invalid Chunk]"),e=!1;break}Zt(a.c,a.f,n,null),xe(a,n)}4==b&&0==t.length&&(a.h=1,oe(16),e=!1),a.b=a.b&&e,e?0<t.length&&!a.W&&(a.W=!0,(b=a.g).a==a&&b.V&&!b.F&&(b.c.info("Great, no buffering proxy detected. Bytes received: "+t.length),Bn(b),b.F=!0)):(Zt(a.c,a.f,t,"[Invalid Chunked Response]"),Se(a),je(a))}function _e(a,b){var t=a.D,e=b.indexOf("\n",t);return-1==e?Ie:(t=Number(b.substring(t,e)),isNaN(t)?we:(e+=1)+t>b.length?Ie:(b=b.substr(e,t),a.D=e+t,b))}function Ae(a){a.U=q()+a.P,Ne(a,a.P)}function Ne(a,b){if(null!=a.o)throw Error("WatchDog timer not null");a.o=ue(p(a.Ua,a),b)}function De(a){a.o&&(f.clearTimeout(a.o),a.o=null)}function je(a){0==a.g.v||a.A||Kn(a.g,a)}function Se(a){De(a);var b=a.F;b&&"function"==typeof b.ja&&b.ja(),a.F=null,zt(a.R),Jt(a.J),a.a&&(b=a.a,a.a=null,b.abort(),b.ja())}function xe(a,b){try{var t=a.g;if(0!=t.v&&(t.a==a||hn(t.b,a)))if(t.I=a.N,!a.C&&hn(t.b,a)&&3==t.v){try{var e=t.ka.a.parse(b)}catch(t){e=null}if(Array.isArray(e)&&3==e.length){var n=e;if(0==n[0]){t:if(!t.j){if(t.a){if(!(t.a.u+3e3<a.u))break t;zn(t),Pn(t)}Fn(t),oe(18)}}else t.oa=n[1],0<t.oa-t.P&&37500>n[2]&&t.H&&0==t.o&&!t.m&&(t.m=ue(p(t.Ra,t),6e3));if(1>=cn(t.b)&&t.ea){try{t.ea()}catch(t){}t.ea=void 0}}else Hn(t,11)}else if((a.C||t.a==a)&&zn(t),!j(b))for(b=e=t.ka.a.parse(b),e=0;e<b.length;e++)if(n=b[e],t.P=n[0],n=n[1],2==t.v)if("c"==n[0]){t.J=n[1],t.ga=n[2];var r=n[3];null!=r&&(t.ha=r,t.c.info("VER="+t.ha));var o=n[4];null!=o&&(t.pa=o,t.c.info("SVER="+t.pa));var c=n[5];if(null!=c&&"number"==typeof c&&0<c){var h=1.5*c;t.D=h,t.c.info("backChannelRequestTimeoutMs_="+h)}h=t;var f=a.a;if(f){var l=f.a?f.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var d=h.b;!d.a&&(k(l,"spdy")||k(l,"quic")||k(l,"h2"))&&(d.f=d.g,d.a=new Set,d.b&&(fn(d,d.b),d.b=null))}if(h.A){var v=f.a?f.a.getResponseHeader("X-HTTP-Session-Id"):null;v&&(h.na=v,Ge(h.B,h.A,v))}}t.v=3,t.f&&t.f.ta(),t.V&&(t.N=q()-a.u,t.c.info("Handshake RTT: "+t.N+"ms"));var y=a;if((h=t).la=Yn(h,h.C?h.ga:null,h.fa),y.C){ln(h.b,y);var m=y,w=h.D;w&&m.setTimeout(w),m.o&&(De(m),Ae(m)),h.a=y}else Mn(h);0<t.g.length&&Cn(t)}else"stop"!=n[0]&&"close"!=n[0]||Hn(t,7);else 3==t.v&&("stop"==n[0]||"close"==n[0]?"stop"==n[0]?Hn(t,7):kn(t):"noop"!=n[0]&&t.f&&t.f.sa(n),t.o=0);re(4)}catch(t){}}function ke(a,b){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,void 0);else if(v(a)||"string"==typeof a)A(a,b,void 0);else{if(a.L&&"function"==typeof a.L)var t=a.L();else if(a.K&&"function"==typeof a.K)t=void 0;else if(v(a)||"string"==typeof a){t=[];for(var e=a.length,n=0;n<e;n++)t.push(n)}else for(n in t=[],e=0,a)t[e++]=n;n=(e=function(a){if(a.K&&"function"==typeof a.K)return a.K();if("string"==typeof a)return a.split("");if(v(a)){for(var b=[],t=a.length,e=0;e<t;e++)b.push(a[e]);return b}for(e in b=[],t=0,a)b[t++]=a[e];return b}(a)).length;for(var r=0;r<n;r++)b.call(void 0,e[r],t&&t[r],a)}}function Pe(a,b){this.b={},this.a=[],this.c=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var e=0;e<t;e+=2)this.set(arguments[e],arguments[e+1])}else if(a)if(a instanceof Pe)for(t=a.L(),e=0;e<t.length;e++)this.set(t[e],a.get(t[e]));else for(e in a)this.set(e,a[e])}function Le(a){if(a.c!=a.a.length){for(var b=0,t=0;b<a.a.length;){var e=a.a[b];Re(a.b,e)&&(a.a[t++]=e),b++}a.a.length=t}if(a.c!=a.a.length){var n={};for(t=b=0;b<a.a.length;)Re(n,e=a.a[b])||(a.a[t++]=e,n[e]=1),b++;a.a.length=t}}function Re(a,b){return Object.prototype.hasOwnProperty.call(a,b)}(g=me.prototype).setTimeout=function(a){this.P=a},g.Wa=function(a){a=a.target;var b=this.F;b&&3==Dn(a)?b.f():this.Ca(a)},g.Ca=function(a){try{if(a==this.a)t:{var b=Dn(this.a),t=this.a.ua(),e=this.a.X();if(!(3>b||3==b&&!W&&!this.a.$())){this.A||4!=b||7==t||re(8==t||0>=e?3:2),De(this);var n=this.a.X();this.N=n;var r=this.a.$();if(this.b=200==n,function(a,b,t,e,n,r,o){a.info((function(){return"XMLHTTP RESP ("+e+") [ attempt "+n+"]: "+b+"\n"+t+"\n"+r+" "+o}))}(this.c,this.m,this.l,this.f,this.T,b,n),this.b){if(this.V&&!this.C){e:{if(this.a){var o,c=this.a;if((o=c.a?c.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(o)){var h=o;break e}}h=null}if(!h){this.b=!1,this.h=3,oe(12),Se(this),je(this);break t}Zt(this.c,this.f,h,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,xe(this,h)}this.I?(Te(this,b,r),W&&this.b&&3==b&&(Xt(this.J,this.R,"tick",this.Va),this.R.start())):(Zt(this.c,this.f,r,null),xe(this,r)),4==b&&Se(this),this.b&&!this.A&&(4==b?Kn(this.g,this):(this.b=!1,Ae(this)))}else 400==n&&0<r.indexOf("Unknown SID")?(this.h=3,oe(12)):(this.h=0,oe(13)),Se(this),je(this)}}}catch(t){}},g.Va=function(){if(this.a){var a=Dn(this.a),b=this.a.$();this.D<b.length&&(De(this),Te(this,a,b),this.b&&4!=a&&Ae(this))}},g.cancel=function(){this.A=!0,Se(this)},g.Ua=function(){this.o=null;var a=q();0<=a-this.U?(function(a,b){a.info((function(){return"TIMEOUT: "+b}))}(this.c,this.l),2!=this.H&&(re(3),oe(17)),Se(this),this.h=2,je(this)):Ne(this,this.U-a)},(g=Pe.prototype).K=function(){Le(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a},g.L=function(){return Le(this),this.a.concat()},g.get=function(a,b){return Re(this.b,a)?this.b[a]:b},g.set=function(a,b){Re(this.b,a)||(this.c++,this.a.push(a)),this.b[a]=b},g.forEach=function(a,b){for(var t=this.L(),e=0;e<t.length;e++){var n=t[e],r=this.get(n);a.call(b,r,n,this)}};var Ce=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ve(a,b){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,a instanceof Ve){this.a=void 0!==b?b:a.a,qe(this,a.f),this.j=a.j,Me(this,a.c),Fe(this,a.h),this.g=a.g,b=a.b;var t=new Ze;t.c=b.c,b.a&&(t.a=new Pe(b.a),t.b=b.b),Be(this,t),this.i=a.i}else a&&(t=String(a).match(Ce))?(this.a=!!b,qe(this,t[1]||"",!0),this.j=Ke(t[2]||""),Me(this,t[3]||"",!0),Fe(this,t[4]),this.g=Ke(t[5]||"",!0),Be(this,t[6]||"",!0),this.i=Ke(t[7]||"")):(this.a=!!b,this.b=new Ze(null,this.a))}function Ue(a){return new Ve(a)}function qe(a,b,t){a.f=t?Ke(b,!0):b,a.f&&(a.f=a.f.replace(/:$/,""))}function Me(a,b,t){a.c=t?Ke(b,!0):b}function Fe(a,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);a.h=b}else a.h=null}function Be(a,b,t){b instanceof Ze?(a.b=b,function(a,b){b&&!a.f&&(tn(a),a.c=null,a.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(dd(this,e),nn(this,n,t))}),a)),a.f=b}(a.b,a.a)):(t||(b=We(b,Je)),a.b=new Ze(b,a.a))}function Ge(a,b,t){a.b.set(b,t)}function ze(a){return Ge(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),a}function Ke(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function We(a,b,t){return"string"==typeof a?(a=encodeURI(a).replace(b,He),t&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function He(a){return"%"+((a=a.charCodeAt(0))>>4&15).toString(16)+(15&a).toString(16)}Ve.prototype.toString=function(){var a=[],b=this.f;b&&a.push(We(b,Qe,!0),":");var t=this.c;return(t||"file"==b)&&(a.push("//"),(b=this.j)&&a.push(We(b,Qe,!0),"@"),a.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.h)&&a.push(":",String(t))),(t=this.g)&&(this.c&&"/"!=t.charAt(0)&&a.push("/"),a.push(We(t,"/"==t.charAt(0)?Xe:Ye,!0))),(t=this.b.toString())&&a.push("?",t),(t=this.i)&&a.push("#",We(t,$e)),a.join("")};var Qe=/[#\/\?@]/g,Ye=/[#\?:]/g,Xe=/[#\?]/g,Je=/[#\?@]/g,$e=/#/g;function Ze(a,b){this.b=this.a=null,this.c=a||null,this.f=!!b}function tn(a){a.a||(a.a=new Pe,a.b=0,a.c&&function(a,b){if(a){a=a.split("&");for(var t=0;t<a.length;t++){var e=a[t].indexOf("="),n=null;if(0<=e){var r=a[t].substring(0,e);n=a[t].substring(e+1)}else r=a[t];b(r,n?decodeURIComponent(n.replace(/\+/g," ")):"")}}}(a.c,(function(b,t){a.add(decodeURIComponent(b.replace(/\+/g," ")),t)})))}function dd(a,b){tn(a),b=rn(a,b),Re(a.a.b,b)&&(a.c=null,a.b-=a.a.get(b).length,Re((a=a.a).b,b)&&(delete a.b[b],a.c--,a.a.length>2*a.c&&Le(a)))}function en(a,b){return tn(a),b=rn(a,b),Re(a.a.b,b)}function nn(a,b,t){dd(a,b),0<t.length&&(a.c=null,a.a.set(rn(a,b),D(t)),a.b+=t.length)}function rn(a,b){return b=String(b),a.f&&(b=b.toLowerCase()),b}function on(a,b){this.b=a,this.a=b}function sn(a){this.g=a||un,f.PerformanceNavigationTiming?a=0<(a=f.performance.getEntriesByType("navigation")).length&&("hq"==a[0].nextHopProtocol||"h2"==a[0].nextHopProtocol):a=!!(f.ia&&f.ia.ya&&f.ia.ya()&&f.ia.ya().qb),this.f=a?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(g=Ze.prototype).add=function(a,b){tn(this),this.c=null,a=rn(this,a);var t=this.a.get(a);return t||this.a.set(a,t=[]),t.push(b),this.b+=1,this},g.forEach=function(a,b){tn(this),this.a.forEach((function(t,e){A(t,(function(t){a.call(b,t,e,this)}),this)}),this)},g.L=function(){tn(this);for(var a=this.a.K(),b=this.a.L(),t=[],e=0;e<b.length;e++)for(var n=a[e],r=0;r<n.length;r++)t.push(b[e]);return t},g.K=function(a){tn(this);var b=[];if("string"==typeof a)en(this,a)&&(b=N(b,this.a.get(rn(this,a))));else{a=this.a.K();for(var t=0;t<a.length;t++)b=N(b,a[t])}return b},g.set=function(a,b){return tn(this),this.c=null,en(this,a=rn(this,a))&&(this.b-=this.a.get(a).length),this.a.set(a,[b]),this.b+=1,this},g.get=function(a,b){return a&&0<(a=this.K(a)).length?String(a[0]):b},g.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var a=[],b=this.a.L(),t=0;t<b.length;t++){var e=b[t],n=encodeURIComponent(String(e));e=this.K(e);for(var r=0;r<e.length;r++){var o=n;""!==e[r]&&(o+="="+encodeURIComponent(String(e[r]))),a.push(o)}}return this.c=a.join("&")};var un=10;function an(a){return!!a.b||!!a.a&&a.a.size>=a.f}function cn(a){return a.b?1:a.a?a.a.size:0}function hn(a,b){return a.b?a.b==b:!!a.a&&a.a.has(b)}function fn(a,b){a.a?a.a.add(b):a.b=b}function ln(a,b){a.b&&a.b==b?a.b=null:a.a&&a.a.has(b)&&a.a.delete(b)}function pn(a){var t,e;if(null!=a.b)return a.c.concat(a.b.s);if(null!=a.a&&0!==a.a.size){var b=a.c;try{for(var n=o(a.a.values()),r=n.next();!r.done;r=n.next()){var c=r.value;b=b.concat(c.s)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return b}return D(a.c)}function dn(){}function vn(){this.a=new dn}function yn(a,b,t){var e=t||"";try{ke(a,(function(t,n){var r=t;y(t)&&(r=kt(t)),b.push(e+n+"="+encodeURIComponent(r))}))}catch(t){throw b.push(e+"type="+encodeURIComponent("_badmap")),t}}function gn(a,b,t,e,n){try{b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null,n(e)}catch(t){}}sn.prototype.cancel=function(){var t,e;if(this.c=pn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=o(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},dn.prototype.stringify=function(a){return f.JSON.stringify(a,void 0)},dn.prototype.parse=function(a){return f.JSON.parse(a,void 0)};var mn=f.JSON.parse;function bn(a){St.call(this),this.headers=new Pe,this.H=a||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=wn,this.D=this.F=!1}T(bn,St);var wn="",In=/^https?$/i,En=["POST","PUT"];function On(a){return"content-type"==a.toLowerCase()}function td(a,b){a.b=!1,a.a&&(a.g=!0,a.a.abort(),a.g=!1),a.f=b,a.h=5,Tn(a),An(a)}function Tn(a){a.u||(a.u=!0,a.dispatchEvent("complete"),a.dispatchEvent("error"))}function _n(a){if(a.b&&void 0!==h&&(!a.s[1]||4!=Dn(a)||2!=a.X()))if(a.l&&4==Dn(a))Kt(a.za,0,a);else if(a.dispatchEvent("readystatechange"),4==Dn(a)){a.b=!1;try{var t,b=a.X();t:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}if(!(t=e)){var n;if(n=0===b){var r=String(a.B).match(Ce)[1]||null;if(!r&&f.self&&f.self.location){var o=f.self.location.protocol;r=o.substr(0,o.length-1)}n=!In.test(r?r.toLowerCase():"")}t=n}if(t)a.dispatchEvent("complete"),a.dispatchEvent("success");else{a.h=6;try{var c=2<Dn(a)?a.a.statusText:""}catch(t){c=""}a.f=c+" ["+a.X()+"]",Tn(a)}}finally{An(a)}}}function An(a,b){if(a.a){Nn(a);var t=a.a,e=a.s[0]?l:null;a.a=null,a.s=null,b||a.dispatchEvent("ready");try{t.onreadystatechange=e}catch(t){}}}function Nn(a){a.a&&a.D&&(a.a.ontimeout=null),a.m&&(f.clearTimeout(a.m),a.m=null)}function Dn(a){return a.a?a.a.readyState:0}function jn(a,b,t){t:{for(e in t){var e=!1;break t}e=!0}e||(t=function(a){var b="";return C(a,(function(t,e){b+=e,b+=":",b+=t,b+="\r\n"})),b}(t),"string"==typeof a?null!=t&&encodeURIComponent(String(t)):Ge(a,b,t))}function Sn(a,b,t){return t&&t.internalChannelParams&&t.internalChannelParams[a]||b}function xn(a){this.pa=0,this.g=[],this.c=new $t,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Sn("failFast",!1,a),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Sn("baseRetryDelayMs",5e3,a),this.Ma=Sn("retryDelaySeedMs",1e4,a),this.Ja=Sn("forwardChannelMaxRetries",2,a),this.ma=Sn("forwardChannelRequestTimeoutMs",2e4,a),this.Ka=a&&a.g||void 0,this.D=void 0,this.C=a&&a.supportsCrossDomainXhr||!1,this.J="",this.b=new sn(a&&a.concurrentRequestLimit),this.ka=new vn,this.da=a&&a.fastHandshake||!1,this.Ga=a&&a.b||!1,a&&a.f&&(this.c.a=!1),a&&a.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&a&&a.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function kn(a){if(Ln(a),3==a.v){var b=a.R++,t=Ue(a.B);Ge(t,"SID",a.J),Ge(t,"RID",b),Ge(t,"TYPE","terminate"),Un(a,t),(b=new me(a,a.c,b,void 0)).H=2,b.i=ze(Ue(t)),t=!1,f.navigator&&f.navigator.sendBeacon&&(t=f.navigator.sendBeacon(b.i.toString(),"")),!t&&f.Image&&((new Image).src=b.i,t=!0),t||(b.a=Xn(b.g,null),b.a.ba(b.i)),b.u=q(),Ae(b)}Qn(a)}function Pn(a){a.a&&(Bn(a),a.a.cancel(),a.a=null)}function Ln(a){Pn(a),a.j&&(f.clearTimeout(a.j),a.j=null),zn(a),a.b.cancel(),a.h&&("number"==typeof a.h&&f.clearTimeout(a.h),a.h=null)}function Rn(a,b){a.g.push(new on(a.La++,b)),3==a.v&&Cn(a)}function Cn(a){an(a.b)||a.h||(a.h=!0,qt(a.Ba,a),a.u=0)}function Vn(a,b){var t;t=b?b.f:a.R++;var e=Ue(a.B);Ge(e,"SID",a.J),Ge(e,"RID",t),Ge(e,"AID",a.P),Un(a,e),a.i&&a.l&&jn(e,a.i,a.l),t=new me(a,a.c,t,a.u+1),null===a.i&&(t.B=a.l),b&&(a.g=b.s.concat(a.g)),b=qn(a,t,1e3),t.setTimeout(Math.round(.5*a.ma)+Math.round(.5*a.ma*Math.random())),fn(a.b,t),Ee(t,e,b)}function Un(a,b){a.f&&ke({},(function(t,e){Ge(b,e,t)}))}function qn(a,b,t){t=Math.min(a.g.length,t);var e=a.f?p(a.f.Ha,a.f,a):null;t:for(var n=a.g,r=-1;;){var o=["count="+t];-1==r?0<t?(r=n[0].b,o.push("ofs="+r)):r=0:o.push("ofs="+r);for(var c=!0,h=0;h<t;h++){var f=n[h].b,l=n[h].a;if(0>(f-=r))r=Math.max(0,n[h].b-100),c=!1;else try{yn(l,o,"req"+f+"_")}catch(t){e&&e(l)}}if(c){e=o.join("&");break t}}return a=a.g.splice(0,t),b.s=a,e}function Mn(a){a.a||a.j||(a.U=1,qt(a.Aa,a),a.o=0)}function Fn(a){return!(a.a||a.j||3<=a.o)&&(a.U++,a.j=ue(p(a.Aa,a),Wn(a,a.o)),a.o++,!0)}function Bn(a){null!=a.s&&(f.clearTimeout(a.s),a.s=null)}function Gn(a){a.a=new me(a,a.c,"rpc",a.U),null===a.i&&(a.a.B=a.l),a.a.O=0;var b=Ue(a.la);Ge(b,"RID","rpc"),Ge(b,"SID",a.J),Ge(b,"CI",a.H?"0":"1"),Ge(b,"AID",a.P),Un(a,b),Ge(b,"TYPE","xmlhttp"),a.i&&a.l&&jn(b,a.i,a.l),a.D&&a.a.setTimeout(a.D);var t=a.a;a=a.ga,t.H=1,t.i=ze(Ue(b)),t.j=null,t.I=!0,Oe(t,a)}function zn(a){null!=a.m&&(f.clearTimeout(a.m),a.m=null)}function Kn(a,b){var t=null;if(a.a==b){zn(a),Bn(a),a.a=null;var e=2}else{if(!hn(a.b,b))return;t=b.s,ln(a.b,b),e=1}if(a.I=b.N,0!=a.v)if(b.b)if(1==e){t=b.j?b.j.length:0,b=q()-b.u;var n=a.u;(e=ee()).dispatchEvent(new se(e,t,b,n)),Cn(a)}else Mn(a);else if(3==(n=b.h)||0==n&&0<a.I||!(1==e&&function(a,b){return!(cn(a.b)>=a.b.f-(a.h?1:0))&&(a.h?(a.g=b.s.concat(a.g),!0):!(1==a.v||2==a.v||a.u>=(a.Ia?0:a.Ja))&&(a.h=ue(p(a.Ba,a,b),Wn(a,a.u)),a.u++,!0))}(a,b)||2==e&&Fn(a)))switch(t&&0<t.length&&(b=a.b,b.c=b.c.concat(t)),n){case 1:Hn(a,5);break;case 4:Hn(a,10);break;case 3:Hn(a,6);break;default:Hn(a,2)}}function Wn(a,b){var t=a.Fa+Math.floor(Math.random()*a.Ma);return a.f||(t*=2),t*b}function Hn(a,b){if(a.c.info("Error code "+b),2==b){var t=null;a.f&&(t=null);var e=p(a.Xa,a);t||(t=new Ve("//www.google.com/images/cleardot.gif"),f.location&&"http"==f.location.protocol||qe(t,"https"),ze(t)),function(a,b){var t=new $t;if(f.Image){var e=new Image;e.onload=O(gn,t,e,"TestLoadImage: loaded",!0,b),e.onerror=O(gn,t,e,"TestLoadImage: error",!1,b),e.onabort=O(gn,t,e,"TestLoadImage: abort",!1,b),e.ontimeout=O(gn,t,e,"TestLoadImage: timeout",!1,b),f.setTimeout((function(){e.ontimeout&&e.ontimeout()}),1e4),e.src=a}else b(!1)}(t.toString(),e)}else oe(2);a.v=0,a.f&&a.f.ra(b),Qn(a),Ln(a)}function Qn(a){a.v=0,a.I=-1,a.f&&(0==pn(a.b).length&&0==a.g.length||(a.b.c.length=0,D(a.g),a.g.length=0),a.f.qa())}function Yn(a,b,t){var e=function(a){return a instanceof Ve?Ue(a):new Ve(a,void 0)}(t);if(""!=e.c)b&&Me(e,b+"."+e.c),Fe(e,e.h);else{var n=f.location;e=function(a,b,t,e){var n=new Ve(null,void 0);return a&&qe(n,a),b&&Me(n,b),t&&Fe(n,t),e&&(n.g=e),n}(n.protocol,b?b+"."+n.hostname:n.hostname,+n.port,t)}return a.W&&C(a.W,(function(t,n){Ge(e,n,t)})),b=a.A,t=a.na,b&&t&&Ge(e,b,t),Ge(e,"VER",a.ha),Un(a,e),e}function Xn(a,b){if(b&&!a.C)throw Error("Can't create secondary domain capable XhrIo object.");return(b=new bn(a.Ka)).F=a.C,b}function Jn(){}function $n(){if(z&&!(10<=Number(it)))throw Error("Environmental error: no available transport.")}function Zn(a,b){St.call(this),this.a=new xn(b),this.l=a,this.b=b&&b.messageUrlParams||null,a=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.a.l=a,a=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(a?a["X-WebChannel-Content-Type"]=b.messageContentType:a={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.a&&(a?a["X-WebChannel-Client-Profile"]=b.a:a={"X-WebChannel-Client-Profile":b.a}),this.a.O=a,(a=b&&b.httpHeadersOverwriteParam)&&!j(a)&&(this.a.i=a),this.h=b&&b.supportsCrossDomainXhr||!1,this.g=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!j(b)&&(this.a.A=b,null!==(a=this.b)&&b in a&&(b in(a=this.b)&&delete a[b])),this.f=new rr(this)}function er(a){ve.call(this);var b=a.__sm__;if(b){t:{for(var t in b){a=t;break t}a=void 0}(this.c=a)?(a=this.c,this.data=null!==b&&a in b?b[a]:void 0):this.data=b}else this.data=a}function nr(){ye.call(this),this.status=1}function rr(a){this.a=a}(g=bn.prototype).ba=function(a,b,t,e){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+a);b=b?b.toUpperCase():"GET",this.B=a,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?fe(this.H):fe(pe),this.a.onreadystatechange=p(this.za,this);try{this.A=!0,this.a.open(b,String(a),!0),this.A=!1}catch(t){return void td(this,t)}a=t||"";var n=new Pe(this.headers);e&&ke(e,(function(t,e){n.set(e,t)})),e=function(a){t:{for(var b=On,t=a.length,e="string"==typeof a?a.split(""):a,n=0;n<t;n++)if(n in e&&b.call(void 0,e[n],n,a)){b=n;break t}b=-1}return 0>b?null:"string"==typeof a?a.charAt(b):a[b]}(n.L()),t=f.FormData&&a instanceof f.FormData,!(0<=_(En,b))||e||t||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),n.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Nn(this),0<this.o&&((this.D=function(a){return z&&et(9)&&"number"==typeof a.timeout&&void 0!==a.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=p(this.xa,this)):this.m=Kt(this.xa,this.o,this)),this.l=!0,this.a.send(a),this.l=!1}catch(t){td(this,t)}},g.xa=function(){void 0!==h&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},g.abort=function(a){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=a||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),An(this))},g.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),An(this,!0)),bn.S.G.call(this)},g.za=function(){this.j||(this.A||this.l||this.g?_n(this):this.Ta())},g.Ta=function(){_n(this)},g.X=function(){try{return 2<Dn(this)?this.a.status:-1}catch(t){return-1}},g.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},g.Na=function(a){if(this.a){var b=this.a.responseText;return a&&0==b.indexOf(a)&&(b=b.substring(a.length)),mn(b)}},g.ua=function(){return this.h},g.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(g=xn.prototype).ha=8,g.v=1,g.Ba=function(a){if(this.h)if(this.h=null,1==this.v){if(!a){this.R=Math.floor(1e5*Math.random()),a=this.R++;var t,b=new me(this,this.c,a,void 0),e=this.l;if(this.O&&(e?M(e=V(e),this.O):e=this.O),null===this.i&&(b.B=e),this.da)t:{for(var n=t=0;n<this.g.length;n++){var r=this.g[n];if(void 0===(r="__data__"in r.a&&"string"==typeof(r=r.a.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break t}if(4096===t||n===this.g.length-1){t=n+1;break t}}t=1e3}else t=1e3;t=qn(this,b,t),Ge(n=Ue(this.B),"RID",a),Ge(n,"CVER",22),this.A&&Ge(n,"X-HTTP-Session-Id",this.A),Un(this,n),this.i&&e&&jn(n,this.i,e),fn(this.b,b),this.Ga&&Ge(n,"TYPE","init"),this.da?(Ge(n,"$req",t),Ge(n,"SID","null"),b.V=!0,Ee(b,n,null)):Ee(b,n,t),this.v=2}}else 3==this.v&&(a?Vn(this,a):0==this.g.length||an(this.b)||Vn(this))},g.Aa=function(){if(this.j=null,Gn(this),this.V&&!(this.F||null==this.a||0>=this.N)){var a=2*this.N;this.c.info("BP detection timer enabled: "+a),this.s=ue(p(this.Sa,this),a)}},g.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Pn(this),Gn(this))},g.Ra=function(){null!=this.m&&(this.m=null,Pn(this),Fn(this),oe(19))},g.Xa=function(a){a?(this.c.info("Successfully pinged google.com"),oe(2)):(this.c.info("Failed to ping google.com"),oe(1))},(g=Jn.prototype).ta=function(){},g.sa=function(){},g.ra=function(){},g.qa=function(){},g.Ha=function(){},$n.prototype.a=function(a,b){return new Zn(a,b)},T(Zn,St),(g=Zn.prototype).addEventListener=function(a,b,t,e){Zn.S.addEventListener.call(this,a,b,t,e)},g.removeEventListener=function(a,b,t,e){Zn.S.removeEventListener.call(this,a,b,t,e)},g.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var a=this.a,b=this.l,t=this.b||void 0;oe(0),a.fa=b,a.W=t||{},a.H=a.T,a.B=Yn(a,null,a.fa),Cn(a)},g.close=function(){kn(this.a)},g.Pa=function(a){if("string"==typeof a){var b={};b.__data__=a,Rn(this.a,b)}else this.g?((b={}).__data__=kt(a),Rn(this.a,b)):Rn(this.a,a)},g.G=function(){this.a.f=null,delete this.f,kn(this.a),delete this.a,Zn.S.G.call(this)},T(er,ve),T(nr,ye),T(rr,Jn),rr.prototype.ta=function(){this.a.dispatchEvent("a")},rr.prototype.sa=function(a){this.a.dispatchEvent(new er(a))},rr.prototype.ra=function(a){this.a.dispatchEvent(new nr(a))},rr.prototype.qa=function(){this.a.dispatchEvent("b")},$n.prototype.createWebChannel=$n.prototype.a,Zn.prototype.send=Zn.prototype.Pa,Zn.prototype.open=Zn.prototype.Oa,Zn.prototype.close=Zn.prototype.close,ae.NO_ERROR=0,ae.TIMEOUT=8,ae.HTTP_ERROR=6,ce.COMPLETE="complete",le.EventType=de,de.OPEN="a",de.CLOSE="b",de.ERROR="c",de.MESSAGE="d",St.prototype.listen=St.prototype.va,bn.prototype.listenOnce=bn.prototype.wa,bn.prototype.getLastError=bn.prototype.Qa,bn.prototype.getLastErrorCode=bn.prototype.ua,bn.prototype.getStatus=bn.prototype.X,bn.prototype.getResponseJson=bn.prototype.Na,bn.prototype.getResponseText=bn.prototype.$,bn.prototype.send=bn.prototype.ba;var ir=function(){return new $n},or=ae,sr=ce,ur=le,ar=bn}).call(this,n(70))},978:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return h})),n.d(e,"d",(function(){return f}));var r=function(t,b){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])})(t,b)};function o(t,b){function e(){this.constructor=t}r(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}function c(t,e,n,r){return new(n||(n=Promise))((function(o,c){function h(t){try{l(r.next(t))}catch(t){c(t)}}function f(t){try{l(r.throw(t))}catch(t){c(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(h,f)}l((r=r.apply(t,e||[])).next())}))}function h(t,body){var e,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(h){return function(c){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(t,o)}catch(t){c=[6,t],n=0}finally{e=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,h])}}}function f(){for(var s=0,i=0,t=arguments.length;i<t;i++)s+=arguments[i].length;var e=Array(s),n=0;for(i=0;i<t;i++)for(var a=arguments[i],r=0,o=a.length;r<o;r++,n++)e[n]=a[r];return e}},994:function(t,e,n){"use strict";n.r(e);n(976)}}]);